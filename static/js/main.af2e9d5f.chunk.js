(this.webpackJsonpvitessce=this.webpackJsonpvitessce||[]).push([[0],{1015:function(e,t){},1017:function(e,t){},1035:function(e,t){},1046:function(e,t){},1281:function(e,t){},1311:function(e,t,n){},1314:function(e,t,n){"use strict";n.r(t);n(883);var a=n(47),r=n.n(a),o=n(8),i=n(0),l=n.n(i),s=n(16),c=n(11),u="https://s3.amazonaws.com/vitessce-data/0.0.31/master_release";function p(e){return function(t){return{name:t,type:t.toUpperCase(),fileType:"".concat(t,".json"),url:"".concat(u,"/").concat(e,"/").concat(e,".").concat(t,".json")}}}var d=["cells","cell-sets","raster","molecules","neighborhoods"],m="Spatial organization of the somatosensory cortex revealed by cyclic smFISH",f={description:m,layers:[].concat(Object(c.a)(d.map(p("linnarsson"))),[Object(s.a)({},p("linnarsson")("clusters"),{type:"EXPRESSION-MATRIX"})])},h={description:m,layers:d.filter((function(e){return"clusters"!==e})).map(p("linnarsson"))},g="Giotto, a pipeline for integrative analysis and visualization of single-cell spatial transcriptomic data",b={description:g,layers:["cells","cell-sets"].map(p("dries"))},y="Multiplexed imaging of high-density libraries of RNAs with MERFISH and expansion microscopy",v={description:y,layers:[].concat(Object(c.a)(["cells","molecules"].map(p("wang"))),[Object(s.a)({},p("wang")("genes"),{name:"expression-matrix",type:"EXPRESSION-MATRIX"})])},O={description:"High Bit Depth (uint16) Multiplex Immunofluorescence Imaging",layers:["raster"].map(p("spraggins"))},x={"just-scatter":{version:"0.1.0",public:!1,layers:[{name:"cells",type:"CELLS",fileType:"cells.json",url:"".concat(u,"/linnarsson/linnarsson.cells.json"),requestInit:{method:"GET",headers:{"x-foo":"FAKE"},mode:"cors",credentials:"omit",cache:"no-store",redirect:"error",referrer:"FAKE",integrity:"FAKE"}}],name:"Linnarsson, just scatterplot",staticLayout:[{component:"scatterplot",props:{mapping:"t-SNE",view:{zoom:.75,target:[0,0,0]}},x:0,y:0,w:12,h:2}]},"just-scatter-expression":{version:"0.1.0",public:!1,layers:[{name:"cells",type:"CELLS",url:"https://s3.amazonaws.com/vitessce-data/0.0.20/master_release/linnarsson/linnarsson.cells.json"},{name:"genes",type:"GENES",url:"https://s3.amazonaws.com/vitessce-data/0.0.20/master_release/linnarsson/linnarsson.genes.json"}],name:"Linnarsson, just scatterplot and expression",staticLayout:[{component:"scatterplot",props:{mapping:"t-SNE",view:{zoom:.75,target:[0,0,0]}},x:0,y:0,w:8,h:2},{component:"genes",x:8,y:2,w:4,h:2}]},"linnarsson-2018":{name:"Linnarsson",version:"1.0.0",description:m,public:!0,datasets:[{uid:"linnarsson-2018",name:"Linnarsson 2018",description:"Linnarsson: ".concat(m),files:f.layers.map((function(e){return{type:e.type.toLowerCase(),fileType:e.fileType,url:e.url}}))}],initStrategy:"auto",coordinationSpace:{embeddingZoom:{PCA:0,TSNE:.75},embeddingType:{PCA:"PCA",TSNE:"t-SNE"},spatialZoom:{A:-5.5},spatialTargetX:{A:16e3},spatialTargetY:{A:2e4}},layout:[{component:"description",x:0,y:0,w:2,h:1},{component:"layerController",x:0,y:1,w:2,h:4},{component:"status",x:0,y:5,w:2,h:1},{component:"spatial",coordinationScopes:{spatialZoom:"A",spatialTargetX:"A",spatialTargetY:"A"},x:2,y:0,w:4,h:4},{component:"genes",x:9,y:0,w:3,h:2},{component:"cellSets",x:9,y:3,w:3,h:2},{component:"heatmap",props:{transpose:!0},x:2,y:4,w:5,h:2},{component:"cellSetExpression",x:7,y:4,w:3,h:2},{component:"expressionHistogram",x:10,y:4,w:2,h:2},{component:"scatterplot",coordinationScopes:{embeddingType:"PCA",embeddingZoom:"PCA"},x:6,y:0,w:3,h:2},{component:"scatterplot",coordinationScopes:{embeddingType:"TSNE",embeddingZoom:"TSNE"},x:6,y:2,w:3,h:2}]},"linnarsson-2018-two-spatial":Object(s.a)({},f,{version:"0.1.0",name:"Linnarsson (two spatial)",staticLayout:[{component:"spatial",props:{view:{zoom:-8,target:[18e3,18e3,0]}},x:0,y:0,w:5,h:2},{component:"scatterplot",props:{mapping:"t-SNE"},x:0,y:2,w:5,h:2},{component:"spatial",props:{view:{zoom:-6,target:[18e3,18e3,0]}},x:5,y:0,w:5,h:2},{component:"scatterplot",props:{mapping:"PCA"},x:5,y:2,w:5,h:2},{component:"genes",x:10,y:2,w:2,h:2},{component:"heatmap",x:0,y:4,w:12}]}),"linnarsson-2018-just-spatial":Object(s.a)({},h,{version:"0.1.0",name:"Linnarsson (just spatial)",staticLayout:[{component:"spatial",props:{view:{zoom:-6.5,target:[18e3,18e3,0]}},x:0,y:0,w:10,h:2},{component:"genes",x:10,y:1,w:2,h:1}]}),"linnarsson-2018-static":Object(s.a)({},f,{version:"0.1.0",name:"Linnarsson (static layout)",staticLayout:[{component:"description",props:{description:"Linnarsson (static layout): ".concat(m)},x:0,y:0,w:3,h:1},{component:"scatterplot",props:{mapping:"t-SNE"},x:0,y:2,w:3,h:2},{component:"spatial",props:{view:{zoom:-6.5,target:[18e3,18e3,0]}},x:3,y:0,w:6,h:4},{component:"genes",x:9,y:2,w:3,h:2},{component:"heatmap",x:0,y:4,w:12,h:1}]}),"linnarsson-2018-dozen":Object(s.a)({},f,{version:"0.1.0",name:"Linnarsson (static layout, redundant components for performance testing)",staticLayout:[{component:"spatial",props:{view:{zoom:-6.5,target:[18e3,18e3,0]}},x:0,y:0,w:4,h:1},{component:"spatial",props:{view:{zoom:-6.5,target:[18e3,18e3,0]}},x:0,y:1,w:4,h:1},{component:"spatial",props:{view:{zoom:-6.5,target:[18e3,18e3,0]}},x:4,y:0,w:4,h:1},{component:"spatial",props:{view:{zoom:-6.5,target:[18e3,18e3,0]}},x:4,y:1,w:4,h:1},{component:"scatterplot",props:{mapping:"t-SNE"},x:0,y:2,w:4,h:1},{component:"scatterplot",props:{mapping:"t-SNE"},x:0,y:3,w:4,h:1},{component:"scatterplot",props:{mapping:"t-SNE"},x:0,y:4,w:4,h:1},{component:"scatterplot",props:{mapping:"t-SNE"},x:0,y:5,w:4,h:1},{component:"scatterplot",props:{mapping:"PCA"},x:4,y:2,w:4,h:1},{component:"scatterplot",props:{mapping:"PCA"},x:4,y:3,w:4,h:1},{component:"scatterplot",props:{mapping:"PCA"},x:4,y:4,w:4,h:1},{component:"scatterplot",props:{mapping:"PCA"},x:4,y:5,w:4,h:1},{component:"genes",x:8,y:2,w:4,h:2},{component:"heatmap",x:8,y:4,w:4,h:2}]}),"dries-2019":{name:"Dries",version:"1.0.0",description:g,public:!0,datasets:[{uid:"dries-2019",name:"Dries 2019",files:b.layers.map((function(e){return{type:e.type.toLowerCase(),fileType:e.fileType,url:e.url}}))}],initStrategy:"auto",coordinationSpace:{embeddingType:{TSNE:"t-SNE",UMAP:"UMAP"},embeddingCellSetPolygonsVisible:{A:!1},embeddingCellSetLabelsVisible:{A:!0},embeddingCellSetLabelSize:{A:16},embeddingCellRadius:{A:1},embeddingZoom:{TSNE:3,UMAP:3},spatialZoom:{A:-4.4},spatialTargetX:{A:3800},spatialTargetY:{A:-900}},layout:[{component:"description",x:9,y:0,w:3,h:2},{component:"status",x:9,y:2,w:3,h:2},{component:"cellSets",x:9,y:4,w:3,h:4},{component:"cellSetSizes",x:5,y:4,w:4,h:4},{component:"scatterplot",coordinationScopes:{embeddingType:"TSNE",embeddingZoom:"TSNE",embeddingCellSetLabelsVisible:"A",embeddingCellSetLabelSize:"A",embeddingCellSetPolygonsVisible:"A",embeddingCellRadius:"A"},x:0,y:2,w:5,h:4},{component:"spatial",props:{cellRadius:50},coordinationScopes:{spatialZoom:"A",spatialTargetX:"A",spatialTargetY:"A"},x:5,y:0,w:4,h:4},{component:"scatterplot",coordinationScopes:{embeddingType:"UMAP",embeddingZoom:"UMAP",embeddingCellSetLabelsVisible:"A",embeddingCellSetLabelSize:"A",embeddingCellSetPolygonsVisible:"A",embeddingCellRadius:"A"},x:0,y:0,w:5,h:4}]},"wang-2019":{name:"Wang",version:"1.0.0",description:y,public:!0,datasets:[{uid:"wang-2019",name:"Wang 2019",files:v.layers.map((function(e){return{type:e.type.toLowerCase(),fileType:e.fileType,url:e.url}}))}],initStrategy:"auto",coordinationSpace:{spatialZoom:{A:-1},spatialLayers:{A:[{type:"molecules",radius:2,opacity:1,visible:!0},{type:"cells",opacity:1,radius:50,visible:!0,stroked:!1}]}},layout:[{component:"spatial",coordinationScopes:{spatialZoom:"A",spatialLayers:"A"},props:{},x:0,y:0,w:10,h:2},{component:"genes",x:10,y:0,w:2,h:4},{component:"expressionHistogram",x:0,y:2,w:10,h:2}]},vanderbilt:Object(s.a)({},O,{version:"0.1.0",name:"Spraggins",public:!0,staticLayout:[{component:"spatial",props:{view:{zoom:-6.5,target:[2e4,2e4,0]}},x:0,y:0,w:9,h:2},{component:"layerController",x:9,y:0,w:3,h:2}]}),"just-higlass":{public:!1,initStrategy:"auto",version:"1.0.0",datasets:[{uid:"higlass-dataset",name:"HiGlass Dataset",files:[]}],name:"HiGlass demo",coordinationSpace:{genomicZoomX:{A:0},genomicZoomY:{A:0},genomicTargetX:{A:1549999999.5},genomicTargetY:{A:1549999999.5}},layout:[{component:"higlass",coordinationScopes:{genomicZoomX:"A",genomicZoomY:"A",genomicTargetX:"A",genomicTargetY:"A"},props:{hgViewConfig:{uid:"aa",autocompleteSource:"/api/v1/suggest/?d=OHJakQICQD6gTD7skx4EWA&",genomePositionSearchBox:{autocompleteServer:"//higlass.io/api/v1",autocompleteId:"OHJakQICQD6gTD7skx4EWA",chromInfoServer:"//higlass.io/api/v1",chromInfoId:"hg19",visible:!0},chromInfoPath:"//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv",tracks:{top:[{type:"horizontal-gene-annotations",height:60,tilesetUid:"OHJakQICQD6gTD7skx4EWA",server:"//higlass.io/api/v1",uid:"OHJakQICQD6gTD7skx4EWA",options:{name:"Gene Annotations (hg19)",fontSize:10,labelPosition:"hidden",labelLeftMargin:0,labelRightMargin:0,labelTopMargin:0,labelBottomMargin:0,minHeight:24,geneAnnotationHeight:16,geneLabelPosition:"outside",geneStrandSpacing:4,showMousePosition:!0,mousePositionColor:"#ff00ff",plusStrandColor:"#fdff54",minusStrandColor:"#68bf30",labelColor:"black",trackBorderWidth:0,trackBorderColor:"black"}},{chromInfoPath:"//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv",type:"horizontal-chromosome-labels",height:30,uid:"X4e_1DKiQHmyghDa6lLMVA",options:{color:"#808080",stroke:"black",fontSize:12,fontIsLeftAligned:!1,showMousePosition:!0,mousePositionColor:"#ff00ff"}}],left:[{type:"vertical-gene-annotations",width:60,tilesetUid:"OHJakQICQD6gTD7skx4EWA",server:"//higlass.io/api/v1",options:{labelPosition:"bottomRight",name:"Gene Annotations (hg19)",fontSize:10,labelLeftMargin:0,labelRightMargin:0,labelTopMargin:0,labelBottomMargin:0,minWidth:24,geneAnnotationHeight:16,geneLabelPosition:"outside",geneStrandSpacing:4,showMousePosition:!0,mousePositionColor:"#ff00ff",plusStrandColor:"#fdff54",minusStrandColor:"#68bf30",labelColor:"black",trackBorderWidth:0,trackBorderColor:"black"},uid:"dqBTMH78Rn6DeSyDBoAEXw"},{chromInfoPath:"//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv",type:"vertical-chromosome-labels",width:30,uid:"RHdQK4IRQ7yJeDmKWb7Pcg",options:{color:"#777777",stroke:"black",fontSize:12,fontIsLeftAligned:!1,minWidth:35,showMousePosition:!0,mousePositionColor:"#ff00ff"}}],center:[{uid:"c1",type:"combined",height:600,contents:[{server:"//higlass.io/api/v1",tilesetUid:"CQMd6V_cRw6iCI_-Unl3PQ",type:"heatmap",options:{maxZoom:null,labelPosition:"bottomRight",name:"Rao et al. (2014) GM12878 MboI (allreps) 1kb",backgroundColor:"black",labelLeftMargin:0,labelRightMargin:0,labelTopMargin:0,labelBottomMargin:0,labelShowResolution:!0,labelShowAssembly:!0,labelColor:"#ffffff",labelTextOpacity:.5,labelBackgroundColor:"black",labelBackgroundOpacity:.01,colorRange:["#000000","#222e54","#448db2","#68bf30","#fdff54","#FFFFFF"],colorbarBackgroundColor:"black",colorbarBackgroundOpacity:.01,colorbarPosition:"topRight",trackBorderWidth:0,trackBorderColor:"black",heatmapValueScaling:"log",showMousePosition:!0,mousePositionColor:"#ff00ff",showTooltip:!1,extent:"full",zeroValueColor:null,scaleStartPercent:"0.00000",scaleEndPercent:"1.00000"},height:500,uid:"GjuZed1ySGW1IzZZqFB9BA",transforms:[{name:"ICE",value:"weight"}]}],options:{}}],right:[],bottom:[],whole:[],gallery:[]},layout:{w:12,h:12,x:0,y:0,moved:!1,static:!1}}},x:0,y:0,w:8,h:2},{component:"higlass",coordinationScopes:{genomicZoomX:"A",genomicZoomY:"A",genomicTargetX:"A",genomicTargetY:"A"},props:{hgViewConfig:{uid:"aa",autocompleteSource:"/api/v1/suggest/?d=OHJakQICQD6gTD7skx4EWA&",genomePositionSearchBox:{autocompleteServer:"//higlass.io/api/v1",autocompleteId:"OHJakQICQD6gTD7skx4EWA",chromInfoServer:"//higlass.io/api/v1",chromInfoId:"hg19",visible:!0},chromInfoPath:"//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv",tracks:{top:[{type:"horizontal-gene-annotations",height:60,tilesetUid:"OHJakQICQD6gTD7skx4EWA",server:"//higlass.io/api/v1",uid:"OHJakQICQD6gTD7skx4EWA",options:{name:"Gene Annotations (hg19)",fontSize:10,labelPosition:"hidden",labelLeftMargin:0,labelRightMargin:0,labelTopMargin:0,labelBottomMargin:0,minHeight:24,geneAnnotationHeight:16,geneLabelPosition:"outside",geneStrandSpacing:4,showMousePosition:!0,mousePositionColor:"#ff00ff",plusStrandColor:"#fdff54",minusStrandColor:"#68bf30",labelColor:"black",trackBorderWidth:0,trackBorderColor:"black"}},{chromInfoPath:"//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv",type:"horizontal-chromosome-labels",height:30,uid:"X4e_1DKiQHmyghDa6lLMVA",options:{color:"#808080",stroke:"black",fontSize:12,fontIsLeftAligned:!1,showMousePosition:!0,mousePositionColor:"#ff00ff"}}],left:[{type:"vertical-gene-annotations",width:60,tilesetUid:"OHJakQICQD6gTD7skx4EWA",server:"//higlass.io/api/v1",options:{labelPosition:"bottomRight",name:"Gene Annotations (hg19)",fontSize:10,labelLeftMargin:0,labelRightMargin:0,labelTopMargin:0,labelBottomMargin:0,minWidth:24,geneAnnotationHeight:16,geneLabelPosition:"outside",geneStrandSpacing:4,showMousePosition:!0,mousePositionColor:"#ff00ff",plusStrandColor:"#fdff54",minusStrandColor:"#68bf30",labelColor:"black",trackBorderWidth:0,trackBorderColor:"black"},uid:"dqBTMH78Rn6DeSyDBoAEXw"},{chromInfoPath:"//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv",type:"vertical-chromosome-labels",width:30,uid:"RHdQK4IRQ7yJeDmKWb7Pcg",options:{color:"#777777",stroke:"black",fontSize:12,fontIsLeftAligned:!1,minWidth:35,showMousePosition:!0,mousePositionColor:"#ff00ff"}}],center:[{uid:"c1",type:"combined",height:600,contents:[{server:"//higlass.io/api/v1",tilesetUid:"CQMd6V_cRw6iCI_-Unl3PQ",type:"heatmap",options:{maxZoom:null,labelPosition:"bottomRight",name:"Rao et al. (2014) GM12878 MboI (allreps) 1kb",backgroundColor:"black",labelLeftMargin:0,labelRightMargin:0,labelTopMargin:0,labelBottomMargin:0,labelShowResolution:!0,labelShowAssembly:!0,labelColor:"#ffffff",labelTextOpacity:.5,labelBackgroundColor:"black",labelBackgroundOpacity:.01,colorRange:["#000000","#222e54","#448db2","#68bf30","#fdff54","#FFFFFF"],colorbarBackgroundColor:"black",colorbarBackgroundOpacity:.01,colorbarPosition:"topRight",trackBorderWidth:0,trackBorderColor:"black",heatmapValueScaling:"log",showMousePosition:!0,mousePositionColor:"#ff00ff",showTooltip:!1,extent:"full",zeroValueColor:null,scaleStartPercent:"0.00000",scaleEndPercent:"1.00000"},height:500,uid:"GjuZed1ySGW1IzZZqFB9BA",transforms:[{name:"ICE",value:"weight"}]}],options:{}}],right:[],bottom:[],whole:[],gallery:[]},layout:{w:12,h:12,x:0,y:0,moved:!1,static:!1}}},x:8,y:0,w:4,h:2}]},"sc-atac-seq-10x-genomics-pbmc":{version:"1.0.0",name:"HiGlass serverless demo with 10x Genomics scATAC-seq 5k PBMC dataset",datasets:[{uid:"10x-genomics-pbmc",name:"10x Genomics PBMC",files:[{type:"genomic-profiles",fileType:"genomic-profiles.zarr",url:"http://higlass-serverless.s3.amazonaws.com/multivec/pbmc_10x_peaks_by_cluster.zarr"}]}],layout:[{component:"genomicProfiles",props:{profileTrackUidKey:"file"},x:0,y:0,w:8,h:2},{component:"description",props:{description:"10x Genomics scATAC-seq of 5k PBMCs. Note: the Zarr HiGlass Plugin Datafetcher is not yet optimized. Please be patient while the HiGlass tracks load."},x:8,y:0,w:4,h:2}],initStrategy:"auto"},"portal-ui-featured":{coordinationSpace:{dataset:{A:"A"},spatialZoom:{A:.6219962674826599},spatialRotation:{A:0},spatialTargetX:{A:550.9755273834661},spatialTargetY:{A:418.2987491735642},spatialTargetZ:{A:6252776074688882e-28},heatmapZoomX:{A:0},heatmapZoomY:{A:0},heatmapTargetX:{A:0},heatmapTargetY:{A:0},cellFilter:{A:null},cellHighlight:{A:"761"},cellSetSelection:{A:[["K-Means [Mean] Expression","Cluster 1"],["K-Means [Mean] Expression","Cluster 2"],["K-Means [Mean] Expression","Cluster 3"],["K-Means [Mean] Expression","Cluster 4"],["K-Means [Mean] Expression","Cluster 5"],["K-Means [Mean] Expression","Cluster 6"]]},cellSetHighlight:{A:null},cellSetColor:{A:[{path:["K-Means [Mean] Expression"],color:[68,119,170,255]},{path:["K-Means [Mean] Expression","Cluster 1"],color:[68,119,170,255]},{path:["K-Means [Mean] Expression","Cluster 2"],color:[136,204,238,255]},{path:["K-Means [Mean] Expression","Cluster 3"],color:[68,170,153,255]},{path:["K-Means [Mean] Expression","Cluster 4"],color:[17,119,51,255]},{path:["K-Means [Mean] Expression","Cluster 5"],color:[153,153,51,255]},{path:["K-Means [Mean] Expression","Cluster 6"],color:[221,204,119,255]},{path:["K-Means [Covariance] Expression"],color:[68,119,170,255]},{path:["K-Means [Covariance] Expression","Cluster 1"],color:[68,119,170,255]},{path:["K-Means [Covariance] Expression","Cluster 2"],color:[136,204,238,255]},{path:["K-Means [Covariance] Expression","Cluster 3"],color:[68,170,153,255]},{path:["K-Means [Covariance] Expression","Cluster 4"],color:[17,119,51,255]},{path:["K-Means [Covariance] Expression","Cluster 5"],color:[153,153,51,255]},{path:["K-Means [Covariance] Expression","Cluster 6"],color:[221,204,119,255]},{path:["K-Means [Total] Expression"],color:[68,119,170,255]},{path:["K-Means [Total] Expression","Cluster 1"],color:[68,119,170,255]},{path:["K-Means [Total] Expression","Cluster 2"],color:[136,204,238,255]},{path:["K-Means [Total] Expression","Cluster 3"],color:[68,170,153,255]},{path:["K-Means [Total] Expression","Cluster 4"],color:[17,119,51,255]},{path:["K-Means [Total] Expression","Cluster 5"],color:[153,153,51,255]},{path:["K-Means [Total] Expression","Cluster 6"],color:[221,204,119,255]},{path:["K-Means [Mean-All-SubRegions] Expression"],color:[68,119,170,255]},{path:["K-Means [Mean-All-SubRegions] Expression","Cluster 1"],color:[68,119,170,255]},{path:["K-Means [Mean-All-SubRegions] Expression","Cluster 2"],color:[136,204,238,255]},{path:["K-Means [Mean-All-SubRegions] Expression","Cluster 3"],color:[68,170,153,255]},{path:["K-Means [Mean-All-SubRegions] Expression","Cluster 4"],color:[17,119,51,255]},{path:["K-Means [Mean-All-SubRegions] Expression","Cluster 5"],color:[153,153,51,255]},{path:["K-Means [Mean-All-SubRegions] Expression","Cluster 6"],color:[221,204,119,255]},{path:["K-Means [Shape-Vectors]"],color:[68,119,170,255]},{path:["K-Means [Shape-Vectors]","Cluster 1"],color:[68,119,170,255]},{path:["K-Means [Shape-Vectors]","Cluster 2"],color:[136,204,238,255]},{path:["K-Means [Shape-Vectors]","Cluster 3"],color:[68,170,153,255]}]},geneFilter:{A:null},geneHighlight:{A:null},geneSelection:{A:null},geneExpressionColormap:{A:"plasma"},geneExpressionColormapRange:{A:[.065,.435]},cellColorEncoding:{A:"cellSetSelection"},spatialRasterLayers:{A:[{type:"t",index:0,colormap:null,opacity:1,domainType:"Min/Max",transparentColor:null,channels:[{selection:{z:5,t:0,c:10},color:[0,0,255],visible:!0,slider:[1,14906]},{selection:{z:5,t:0,c:15},color:[0,255,0],visible:!0,slider:[2313,31611]},{selection:{z:5,t:0,c:45},color:[255,0,255],visible:!0,slider:[2570,21074]},{selection:{z:5,t:0,c:20},color:[255,255,0],visible:!0,slider:[2827,11565]},{selection:{z:5,t:0,c:31},slider:[5658,17479],visible:!0,color:[255,128,0]},{selection:{z:5,t:0,c:39},slider:[1767,11735],visible:!0,color:[255,255,255]}]}]},spatialCellsLayer:{A:{opacity:0,radius:50,visible:!0,stroked:!0}},spatialMoleculesLayer:{A:null},spatialNeighborhoodsLayer:{A:null},additionalCellSets:{A:null},moleculeHighlight:{A:null}},datasets:[{files:[{fileType:"cells.json",type:"cells",url:"https://assets.hubmapconsortium.org/ca3016d836d8ee50bef1b93f339c9679/output_json/R002_X002_Y007.cells.json?token="},{fileType:"cell-sets.json",type:"cell-sets",url:"https://assets.hubmapconsortium.org/ca3016d836d8ee50bef1b93f339c9679/output_json/R002_X002_Y007.cell-sets.json?token="},{fileType:"clusters.json",type:"expression-matrix",url:"https://assets.hubmapconsortium.org/ca3016d836d8ee50bef1b93f339c9679/output_json/R002_X002_Y007.clusters.json?token="},{fileType:"raster.json",options:{images:[{metadata:{omeTiffOffsetsUrl:"https://assets.hubmapconsortium.org/ca3016d836d8ee50bef1b93f339c9679/output_offsets/R002_X002_Y007.offsets.json?token="},name:"R002_X002_Y007",type:"ome-tiff",url:"https://assets.hubmapconsortium.org/ca3016d836d8ee50bef1b93f339c9679/output/extract/expressions/ome-tiff/R002_X002_Y007.ome.tiff?token="}],schemaVersion:"0.0.2"},type:"raster"}],name:"SPRM",uid:"A"}],description:"",initStrategy:"auto",layout:[{component:"spatial",coordinationScopes:{dataset:"A",spatialZoom:"A",spatialRotation:"A",spatialTargetX:"A",spatialTargetY:"A",spatialTargetZ:"A",cellFilter:"A",cellHighlight:"A",cellSetSelection:"A",cellSetHighlight:"A",cellSetColor:"A",geneHighlight:"A",geneSelection:"A",geneExpressionColormap:"A",geneExpressionColormapRange:"A",cellColorEncoding:"A",spatialRasterLayers:"A",spatialCellsLayer:"A",spatialMoleculesLayer:"A",spatialNeighborhoodsLayer:"A",additionalCellSets:"A",moleculeHighlight:"A"},h:8,w:7,x:3,y:0},{component:"description",coordinationScopes:{dataset:"A",spatialRasterLayers:"A"},h:2,w:2,x:10,y:10},{component:"layerController",coordinationScopes:{dataset:"A",spatialRasterLayers:"A",spatialCellsLayer:"A",spatialMoleculesLayer:"A",spatialNeighborhoodsLayer:"A"},h:8,w:3,x:0,y:0},{component:"cellSets",coordinationScopes:{dataset:"A",cellSetSelection:"A",cellSetHighlight:"A",cellSetColor:"A",cellColorEncoding:"A",additionalCellSets:"A"},h:5,w:2,x:10,y:5},{component:"genes",coordinationScopes:{dataset:"A",geneFilter:"A",geneHighlight:"A",geneSelection:"A",cellColorEncoding:"A"},h:5,props:{variablesLabelOverride:"antigen"},w:2,x:10,y:0},{component:"heatmap",coordinationScopes:{dataset:"A",heatmapZoomX:"A",heatmapZoomY:"A",heatmapTargetX:"A",heatmapTargetY:"A",cellFilter:"A",cellHighlight:"A",cellSetSelection:"A",cellSetHighlight:"A",cellSetColor:"A",geneFilter:"A",geneHighlight:"A",geneSelection:"A",geneExpressionColormap:"A",geneExpressionColormapRange:"A",cellColorEncoding:"A",additionalCellSets:"A"},h:4,props:{transpose:!0,variablesLabelOverride:"antigen"},w:10,x:0,y:8}],name:"R002_X002_Y007",version:"1.0.1"},bems973:{version:"1.0.0",name:"BEMS973",description:"Description of BEMS973",datasets:[{uid:"A",name:"",files:[{type:"raster",fileType:"raster.json",options:{schemaVersion:"0.0.2",usePhysicalSizeScaling:!1,images:[{name:"OMETIFF",type:"ome-tiff",url:"http://10.96.11.244/datasets/4b187121143038ff/display/A/0/image01.ome.tiff",metadata:{omeTiffOffsetsUrl:"http://10.96.11.244/datasets/4b187121143038ff/display/A/0/image01.offsets.json",isBitmask:!1}}],renderLayers:["OMETIFF"]}},{type:"cells",fileType:"anndata-cells.zarr",url:"http://10.96.11.244/datasets/4b187121143038ff/display/A/1/anndata.zarr",options:{xy:"obsm/XY_centroid",mappings:{UMAP:{key:"obsm/X_umap",dims:[0,1]}}}},{type:"cell-sets",fileType:"anndata-cell-sets.zarr",url:"http://10.96.11.244/datasets/4b187121143038ff/display/A/1/anndata.zarr",options:[{groupName:"Leiden",setName:"obs/leiden"},{groupName:"Phenotype",setName:"obs/phenotype"}]},{type:"expression-matrix",fileType:"anndata-expression-matrix.zarr",url:"http://10.96.11.244/datasets/4b187121143038ff/display/A/1/anndata.zarr",options:{matrix:"X"}}]}],coordinationSpace:{dataset:{A:"A"},embeddingType:{A:"UMAP"}},layout:[{component:"spatial",coordinationScopes:{dataset:"A"},x:0,y:0,w:6,h:12},{component:"cellSets",coordinationScopes:{dataset:"A"},x:6,y:3,w:6,h:3},{component:"scatterplot",coordinationScopes:{dataset:"A",embeddingType:"A"},x:6,y:6,w:6,h:6},{component:"status",coordinationScopes:{dataset:"A"},x:0,y:0,w:1,h:1},{component:"layerController",coordinationScopes:{dataset:"A"},x:6,y:0,w:6,h:3}],initStrategy:"auto"}};var j="card card-body my-2 ".concat("tooltip-ancestor"),E="".concat(j," bg-primary"),C="".concat(j," bg-secondary"),S="".concat(j," bg-black"),w="".concat(E," scroll");function L(e){var t=e.title,n=e.preformatted,a=e.unformatted,r=e.theme;return l.a.createElement("div",{className:"vitessce-container vitessce-theme-".concat(r)},l.a.createElement("div",{className:"warning-layout container-fluid"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:E},l.a.createElement("h1",null,t),l.a.createElement("pre",null,n),l.a.createElement("div",null,a))))))}var T=n(1401),A=n(1438),k=n(1430),_=n(46),I=n.n(_),P=n(1399),N=n(848),R=n(489),M=Object(P.a)((function(){return{paper:{maxHeight:200,overflow:"auto",zIndex:1500},span:{width:"70px",textAlign:"center",paddingLeft:"2px",paddingRight:"2px"},popper:{zIndex:4}}})),D={dark:Object(N.a)({palette:{type:"dark",primary:R.a,secondary:R.a,primaryBackground:"#222222",primaryBackgroundHighlight:"#000000",primaryBackgroundInput:"#D3D3D3",primaryBackgroundDim:"#333333",primaryBackgroundLight:"#757575",primaryForeground:"#D3D3D3",primaryForegroundDim:"#000000",primaryForegroundActive:"#9bb7d6",secondaryBackground:"#000000",secondaryBackgroundDim:"#444444",secondaryForeground:"#D3D3D3"},props:{MuiButtonBase:{disableRipple:!0}}}),light:Object(N.a)({palette:{type:"light",primary:R.a,secondary:R.a,primaryBackground:"#F1F1F1",primaryBackgroundHighlight:"#FFFFFF",primaryBackgroundInput:"#FFFFFF",primaryBackgroundDim:"#8A8A8A",primaryBackgroundLight:"#e0e0e0",primaryForeground:"#333333",primaryForegroundDim:"#808080",primaryForegroundActive:"#0074D9",secondaryBackground:"#F1F1F1",secondaryBackgroundDim:"#C0C0C0",secondaryForeground:"#222222"},props:{MuiButtonBase:{disableRipple:!0}}})},z=n(9),G=n(12),H=n(17),F=n(18),X=n(595),B=n(14);function Z(e){return Object(c.a)(e).reduce((function(e,t){var n=t[0],a=t[1];return Object.assign(e,Object(B.a)({},n,a))}),{})}function U(e,t,n){return 1===n?e:t}function V(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Y(e){var t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a=[0];function r(){var e=[];a.forEach((function(t){e.unshift(n[t])}));for(var t=!0,r=0;r<a.length;r++){if(!(++a[r]>=n.length)){t=!1;break}a[r]=0}return t&&a.push(0),e.join("")}do{t=r()}while(e.includes(t));return t}function W(e,t){var n=e.data;return Array.isArray(n)?n[t||n.length-1]:n}function q(e){var t=W(e),n=t.shape,a=t.dtype;return 3===n[t.labels.indexOf("c")]&&"Uint8"===a}function $(e,t){for(var n=[],a=0;a<e.length;a++)n.push(e[a+1]-e[a]);return Object.entries(t).map((function(t){var a,r=Object(o.a)(t,2),i=r[0],l=r[1];return{i:i,y:l.y,h:l.h||1,x:e[l.x],w:(a=n.slice(l.x,l.x+(l.w||1)),a.reduce((function(e,t){return e+t}),0))}}))}function K(e){var t,n={},a={},r={},i={},l={};if(("components"in e?e.components:e).forEach((function(e,t){var n="".concat("i").concat(t);i[n]={component:e.component,props:e.props||{},coordinationScopes:e.coordinationScopes||{}},l[n]={id:n,x:e.x,y:e.y,w:e.w,h:e.h}})),"components"in e)Object.entries(e.columns).forEach((function(e){var t=Object(o.a)(e,2),i=t[0],s=t[1];n[i]=s[s.length-1],a[i]=$(s,l),r[i]=i}));else{n.ID=12,a.ID=$((t=13,Object(c.a)(Array(t).keys())),l),r.ID=1e3}return{cols:n,layouts:a,breakpoints:r,components:i}}var J=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"componentDidUpdate",value:function(e){this.props.height!==e.height&&this.onWindowResize()}}]),n}(Object(X.WidthProvider)(X.Responsive));function Q(e){var t,n=e.layout,a=e.getComponent,r=e.padding,i=e.margin,s=e.draggableHandle,u=e.reactGridLayoutProps,p=e.rowHeight,d=e.theme,m=e.height,f=e.onRemoveComponent,h=e.onLayoutChange,g=K(n),b=g.cols,y=g.layouts,v=g.breakpoints,O=g.components,x=(t=y,Math.max.apply(Math,Object(c.a)(Object.values(t).map((function(e){return Math.max.apply(Math,Object(c.a)(e.map((function(e){return e.y+e.h}))))}))))),j=l.a.createElement("style",null,"\n        ".concat(s," {\n          cursor: grab;\n        }\n        ").concat(s,":active {\n          cursor: grabbing;\n        }\n     ")),E=Object.entries(O).map((function(e,t){var n=Object(o.a)(e,2),r=n[0],i=n[1],s=a(i.component);return l.a.createElement("div",{key:r},l.a.createElement(s,Object.assign({},i.props,{uuid:t,coordinationScopes:i.coordinationScopes,theme:d,removeGridComponent:function(){f(t)}})))}));return y&&O&&v&&b&&l.a.createElement(l.a.Fragment,null,j,l.a.createElement(J,Object.assign({className:"layout",cols:b,layouts:y,breakpoints:v,height:m,rowHeight:p||(window.innerHeight-2*r-(x-1)*i)/x,containerPadding:[r,r],margin:[i,i],draggableHandle:s,onLayoutChange:function(e){if(e.length===Object.entries(O).length){var t=[];e.forEach((function(e){var n=e.i,a=O[n];if(a){var r=parseInt(n.substring(n.indexOf("i")+1),10),o={x:e.x,y:e.y,w:e.w,h:e.h},i={x:a.x,y:a.y,w:a.w,h:a.h};I()(o,i)||t.push([r,o])}})),t.length>0&&h(t)}}},u),E))}Q.defaultProps={padding:10,margin:10};var ee=n(194),te=n.n(ee),ne=n(177),ae=n.n(ne),re=function(){function e(t){var n=t.type,a=t.url,r=t.requestInit,o=t.options;Object(z.a)(this,e),this.type=n,this.url=a,this.requestInit=r,this.options=o,this.subscriptions={}}return Object(G.a)(e,[{key:"load",value:function(){throw new Error("The load() method has not been implemented.")}},{key:"subscribe",value:function(e){var t=ae()();return this.subscriptions[t]=e,t}},{key:"unsubscribe",value:function(e){delete this.subscriptions[e]}},{key:"publish",value:function(e){Object.values(this.subscriptions).forEach((function(t){t(e)}))}}]),e}(),oe=function(){function e(t){Object(z.a)(this,e),this.message=t}return Object(G.a)(e,[{key:"warnInConsole",value:function(){throw new Error("The warnInConsole() method has not been implemented.")}}]),e}(),ie=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(e,a,r,o){var i;return Object(z.a)(this,n),(i=t.call(this,"Error HTTP status fetching ".concat(e,"."))).name="LoaderFetchError",i.datasetType=e,i.datasetFileType=a,i.datasetUrl=r,i.responseHeaders=o,i}return Object(G.a)(n,[{key:"warnInConsole",value:function(){var e=this.datasetType,t=this.datasetUrl,n=this.responseHeaders;console.warn("".concat(e," from ").concat(t,": fetch failed"),n)}}]),n}(oe),le=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(e,a,r,o){var i;return Object(z.a)(this,n),(i=t.call(this,"Error while validating ".concat(e,"."))).name="LoaderValidationError",i.datasetType=e,i.datasetFileType=a,i.datasetUrl=r,i.reason=o,i}return Object(G.a)(n,[{key:"warnInConsole",value:function(){var e=this.datasetType,t=this.datasetUrl,n=this.reason;console.warn("".concat(e," from ").concat(t,": validation failed"),JSON.stringify(n,null,2))}}]),n}(oe),se=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(e,a,r){var o;return Object(z.a)(this,n),(o=t.call(this,"Error finding loader for ".concat(e,"."))).name="LoaderNotFoundError",o.datasetType=e,o.datasetFileType=a,o.datasetUrl=r,o}return Object(G.a)(n,[{key:"warnInConsole",value:function(){var e=this.datasetType,t=this.datasetFileType,n=this.datasetUrl;t&&n?console.warn("".concat(e," from ").concat(n,": unable to find loader for fileType ").concat(t)):console.warn("".concat(e,": unable to find loader"))}}]),n}(oe),ce=function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(z.a)(this,e),this.data=t,this.url=n,this.coordinationValues=a},ue=n(781),pe=n(782),de=n(783),me=n(234),fe=n(192),he={cells:ue,molecules:pe,neighborhoods:de,raster:me,"cell-sets":fe},ge=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(e){var a;Object(z.a)(this,n),a=t.call(this,e);var r=e.type;return a.schema=he[r],a}return Object(G.a)(n,[{key:"load",value:function(){var e=this,t=this.url,n=this.requestInit,a=this.type,r=this.fileType;return this.data||(this.data=fetch(t,n).then((function(e){return e.ok?e.json():Promise.reject(new ie(a,r,t,e.headers))})).catch((function(e){return Promise.resolve(e)})).then((function(n){if(n instanceof oe)return Promise.reject(n);var i=e.validate(n),l=Object(o.a)(i,2),s=l[0],c=l[1];return s?Promise.resolve(new ce(n,t)):Promise.reject(new le(a,r,t,c))}))),this.data}},{key:"validate",value:function(e){var t=this.schema,n=this.type;if(!t)throw Error("No schema for ".concat(n));var a,r=(new te.a).compile(t),o=r(e);return o||(a=r.errors),[o,a]}}]),n}(re),be=n(109),ye=n(2),ve=n.n(ye),Oe=n(13),xe=n(38),je=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(e){var a;Object(z.a)(this,n),a=t.call(this,e);var r=Object(xe.a)(a),o=r.url,i=r.requestInit;return a.store=new be.a(o,{supportedMethods:["GET"],fetchOptions:i}),a}return Object(G.a)(n,[{key:"getJson",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.store.getItem(t);case 3:return n=e.sent,a=new TextDecoder("utf-8").decode(n),e.abrupt("return",JSON.parse(a));case 8:if(e.prev=8,e.t0=e.catch(0),!(e.t0 instanceof be.b)){e.next=12;break}return e.abrupt("return",{});case 12:throw e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(re),Ee=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"loadAttrs",value:function(){return this.attrs||(this.attrs=this.getJson(".zattrs")),this.attrs}},{key:"loadArr",value:function(){var e=this.store;return this.arr||(this.arr=Object(be.c)({store:e,path:"/",mode:"r"}).then((function(e){return new Promise((function(t){e.getRaw([null,null]).then(t)}))}))),this.arr}},{key:"load",value:function(){return Promise.all([this.loadAttrs(),this.loadArr()]).then((function(e){return Promise.resolve(new ce(e,null))}))}}]),n}(je),Ce=n(53),Se=n(65),we=n(784),Le=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(e){var a;return Object(z.a)(this,n),(a=t.call(this,e)).schema=we,a}return Object(G.a)(n,[{key:"load",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t,a,r,o,i,l,s,c;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Se.a)(Object(Ce.a)(n.prototype),"load",this).call(this).catch((function(e){return Promise.resolve(e)}));case 2:if(!((t=e.sent)instanceof oe)){e.next=5;break}return e.abrupt("return",Promise.reject(t));case 5:return a=t.data,r=t.url,o=Object.keys(a),i=o.length>0?Object.keys(a[o[0]].cells):[],l={rows:i,cols:o},s=i.flatMap((function(e){return o.map((function(t){return a[t].cells[e]/a[t].max*255}))})),c={data:Uint8Array.from(s)},e.abrupt("return",Promise.resolve(new ce([l,c],r)));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ge),Te=n(1402),Ae=n(113),ke=n.n(Ae),_e=n(785),Ie=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(e){var a;return Object(z.a)(this,n),(a=t.call(this,e)).schema=_e,a}return Object(G.a)(n,[{key:"load",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t,a,r,i,l,s,c,u,p,d,m,f;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Se.a)(Object(Ce.a)(n.prototype),"load",this).call(this).catch((function(e){return Promise.resolve(e)}));case 2:if(!((t=e.sent)instanceof oe)){e.next=5;break}return e.abrupt("return",Promise.reject(t));case 5:return a=t.data,r=t.url,i=a.rows,l=a.cols,s=a.matrix,u=[(c={rows:l,cols:i}).rows.length,c.cols.length],p=s.map((function(e){var t=Object(Te.a)(e),n=Object(o.a)(t,2),a=n[0],r=n[1];return e.map((function(e){return Math.floor((e-a)/(r-a)*255)}))})),d=ke()(u[0]).map((function(e){return ke()(u[1]).map((function(t){return p[t][e]}))})),m=d.flat(),f={data:Uint8Array.from(m)},e.abrupt("return",Promise.resolve(new ce([c,f],r)));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ge),Pe=n(69),Ne=n(805),Re=n.n(Ne),Me=n(105),De=n(1432),ze=n(45),Ge=n(806),He={cell:{latestVersion:"0.1.3",schema:fe}},Fe={cell:{schema:Ge}};function Xe(e,t,n,a){return{coordinateSystem:ze.a.CARTESIAN,data:e,pickable:!0,autoHighlight:!0,stroked:!0,filled:!0,getElevation:0,onHover:function(e){if(a&&a(),e.object){var r=Object(o.a)(e.object,2),i=r[0],l=r[1].factors;t&&t((s=void 0===l?{}:l,Object.entries(s).map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return"".concat(n,": ").concat(a)})).join("; "))),n&&n(i)}else n&&n("");var s}}}var Be=[128,128,128],Ze=[[68,119,170],[136,204,238],[68,170,153],[17,119,51],[153,153,51],[221,204,119],[204,102,119],[136,34,85],[170,68,153]],Ue=[[0,0,255],[0,255,0],[255,0,255],[255,255,0],[0,255,255],[255,255,255],[255,128,0],[255,0,0]],Ve=["viridis","greys","magma","jet","hot","bone","copper","summer","density","inferno"],Ye={webgl2:!0};function We(e,t){var n=1;if(e)for(;e.find((function(e){return e.name==="".concat(t).concat(n)}));)n++;return"".concat(t).concat(n)}function qe(e,t,n,a,r,o,i){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"Selection ",s="My Selections",u=null===t||void 0===t?void 0:t.tree.find((function(e){return e.name===s})),p={version:He.cell.latestVersion,datatype:"cell",tree:Object(c.a)(t?t.tree:[])},d=We(null===u||void 0===u?void 0:u.children,l),m=0;u?(m=u.children.length,u.children.push({name:d,set:e.map((function(e){return[e,null]}))})):p.tree.push({name:s,children:[{name:d,set:e.map((function(e){return[e,null]}))}]}),r(p);var f=["My Selections",d];o([].concat(Object(c.a)(n||[]),[{path:f,color:Ze[m%Ze.length]}])),a([f]),i("cellSetSelection")}function $e(e,t){return{version:He.cell.latestVersion,datatype:"cell",tree:[].concat(Object(c.a)(e?e.tree:[]),Object(c.a)(t?t.tree:[]))}}function Ke(e){return{__esModule:!0,default:e}}var Je=["z","t"],Qe={visible:!0,colormap:null,opacity:1,domainType:"Min/Max",transparentColor:[0,0,0],renderingMode:Pe.e.ADDITIVE,use3d:!1},et={opacity:1,radius:20,visible:!0},tt={opacity:1,radius:50,visible:!0,stroked:!1},nt={visible:!1},at=n(32),rt=n(679),ot=n(680),it=n(326),lt=n(25);function st(e,t,n){for(var a=Object(c.a)(e),r=0;r<n;r+=1)a.push(t);return a}var ct=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"getShaders",value:function(){return{fs:"\n#define SHADER_NAME bitmask-layer-fragment-shader\nprecision highp float;\n\n// Data (mask) texture\nuniform sampler2D channel0;\nuniform sampler2D channel1;\nuniform sampler2D channel2;\nuniform sampler2D channel3;\nuniform sampler2D channel4;\nuniform sampler2D channel5;\n\n// Color texture\nuniform sampler2D colorTex;\nuniform float colorTexHeight;\nuniform float colorTexWidth;\nuniform float hovered;\n// range\nuniform bool channelIsOn[6];\n\n// opacity\nuniform float opacity;\n\nvarying vec2 vTexCoord;\n\nvec4 sampleAndGetColor(sampler2D dataTex, vec2 coord, bool isOn){\n  float sampledData = texture(dataTex, coord).r;\n  vec4 hoveredColor = float(sampledData == hovered && sampledData > 0. && hovered > 0.) * vec4(0., 0., 1., 1.);\n  // Colors are laid out corresponding to ids in row-major order in the texture.  So if width of the texture is 10, and you want ID 25,\n  // you need coordinate (1, 4) (i.e 2 rows down, and 5 columns over indexed from 0 for a total of 25 units covered in row major order).\n  vec2 colorTexCoord = vec2(mod(sampledData, colorTexWidth) / colorTexWidth, floor(sampledData / colorTexWidth) / (colorTexHeight - 1.));\n  vec4 sampledColor = vec4(texture(colorTex, colorTexCoord).rgb, 1.);\n  // Only return a color if the data is non-zero.\n  return max(0., min(sampledData, 1.)) * float(isOn) * (sampledColor + hoveredColor);\n}\n\nvoid main() {\n\n  gl_FragColor = sampleAndGetColor(channel0, vTexCoord, channelIsOn[0]);\n\n  // If the sampled color and the currently stored color (gl_FragColor) are identical, don't blend and use the sampled color,\n  // otherwise just use the currently stored color.  Repeat this for all channels.\n  vec4 sampledColor = sampleAndGetColor(channel1, vTexCoord, channelIsOn[1]);\n  gl_FragColor = (sampledColor == gl_FragColor || sampledColor == vec4(0.)) ? gl_FragColor : sampledColor;\n  sampledColor = sampleAndGetColor(channel2, vTexCoord, channelIsOn[2]);\n  gl_FragColor = (sampledColor == gl_FragColor || sampledColor == vec4(0.)) ? gl_FragColor : sampledColor;\n  sampledColor = sampleAndGetColor(channel3, vTexCoord, channelIsOn[3]);\n  gl_FragColor = (sampledColor == gl_FragColor || sampledColor == vec4(0.)) ? gl_FragColor : sampledColor;\n  sampledColor = sampleAndGetColor(channel4, vTexCoord, channelIsOn[4]);\n  gl_FragColor = (sampledColor == gl_FragColor || sampledColor == vec4(0.)) ? gl_FragColor : sampledColor;\n  sampledColor = sampleAndGetColor(channel5, vTexCoord, channelIsOn[5]);\n  gl_FragColor = (sampledColor == gl_FragColor || sampledColor == vec4(0.)) ? gl_FragColor : sampledColor;\n  // Apply the opacity if there is pixel data, and if the pixel data is empty i.e no segmentation, use 0 opacity.\n  gl_FragColor = vec4(gl_FragColor.rgb, (gl_FragColor.rgb == vec3(0., 0., 0.)) ? 0.0 : opacity);\n\n  geometry.uv = vTexCoord;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",vs:"\n#define SHADER_NAME bitmask-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute vec3 instancePickingColors;\n\nvarying vec2 vTexCoord;\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vTexCoord = texCoords;\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",modules:[rt.a,ot.a]}}},{key:"updateState",value:function(e){var t,a,r=e.props,o=e.oldProps,i=e.changeFlags;Object(Se.a)(Object(Ce.a)(n.prototype),"updateState",this).call(this,{props:r,oldProps:o,changeFlags:i}),(null===(t=r.cellColor)||void 0===t?void 0:t.data)!==(null===(a=o.cellColor)||void 0===a?void 0:a.data)&&this.setColorTexture()}},{key:"setColorTexture",value:function(){var e,t=this.props.cellColor,n=t.height,a=t.width,r=t.data,o=new it.a(this.context.gl,{width:a,height:n,data:r,mipmaps:!1,parameters:(e={},Object(B.a)(e,at.default.TEXTURE_MIN_FILTER,at.default.NEAREST),Object(B.a)(e,at.default.TEXTURE_MAG_FILTER,at.default.NEAREST),Object(B.a)(e,at.default.TEXTURE_WRAP_S,at.default.CLAMP_TO_EDGE),Object(B.a)(e,at.default.TEXTURE_WRAP_T,at.default.CLAMP_TO_EDGE),e),format:at.default.RGB,dataFormat:at.default.RGB,type:at.default.UNSIGNED_BYTE});this.setState({colorTex:o})}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,a=n.channelIsOn,r=n.hoveredCell,o=this.state,i=o.textures,l=o.model,c=o.colorTex;i&&l&&c&&l.setUniforms(Object.assign({},t,Object(s.a)({hovered:r||0,colorTex:c,colorTexHeight:c.height,colorTexWidth:c.width,channelIsOn:st(a,!1,6-a.length)},i))).draw()}},{key:"dataToTexture",value:function(e,t,n){var a,r=Object(lt.j)(this.context.gl);return new it.a(this.context.gl,{width:t,height:n,data:new Float32Array(e),mipmaps:!1,parameters:(a={},Object(B.a)(a,at.default.TEXTURE_MIN_FILTER,at.default.NEAREST),Object(B.a)(a,at.default.TEXTURE_MAG_FILTER,at.default.NEAREST),Object(B.a)(a,at.default.TEXTURE_WRAP_S,at.default.CLAMP_TO_EDGE),Object(B.a)(a,at.default.TEXTURE_WRAP_T,at.default.CLAMP_TO_EDGE),a),format:r?at.default.R32F:at.default.LUMINANCE,dataFormat:r?at.default.RED:at.default.LUMINANCE,type:at.default.FLOAT})}}]),n}(Pe.h);function ut(e){return pt.apply(this,arguments)}function pt(){return(pt=Object(Oe.a)(ve.a.mark((function e(t){var n,a,r,o,i,l,s;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.loader,a=t.selection,r=Array.isArray(n)?n[n.length-1]:n,e.next=4,r.getRaster({selection:a});case 4:return o=e.sent,i=Object(Pe.j)(o.data),l=i.domain,s=i.autoSliders,e.abrupt("return",{domain:l,slider:s});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dt(e){return mt.apply(this,arguments)}function mt(){return(mt=Object(Oe.a)(ve.a.mark((function e(t){var n,a,r,o,i,l,c,u,p,d,m,f;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.loader,a=t.selection,r=n[n.length-1],o=r.shape,i=r.labels,l=o[i.indexOf("z")]>>n.length-1,e.next=6,r.getRaster({selection:Object(s.a)({},a,{z:0})});case 6:return c=e.sent,e.next=9,r.getRaster({selection:Object(s.a)({},a,{z:Math.floor(l/2)})});case 9:return u=e.sent,e.next=12,r.getRaster({selection:Object(s.a)({},a,{z:l-1})});case 12:return p=e.sent,d=Object(Pe.j)(c.data),m=Object(Pe.j)(u.data),f=Object(Pe.j)(p.data),e.abrupt("return",{domain:[Math.min(d.domain[0],m.domain[0],f.domain[0]),Math.max(d.domain[1],m.domain[1],f.domain[1])],slider:[Math.min(d.autoSliders[0],m.autoSliders[0],f.autoSliders[0]),Math.max(d.autoSliders[1],m.autoSliders[1],f.autoSliders[1])]});case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}ct.layerName="BitmaskLayer",ct.defaultProps={hoveredCell:{type:"number",value:null,compare:!0},cellColor:{type:"object",value:null,compare:!0}};var ft=function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a,r,o;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.loader,a=t.selection,r=t.use3d,o=r?dt:ut,e.abrupt("return",o({loader:n,selection:a}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ht=function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a,r,o,i,l;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.loader,a=t.selections,r=t.use3d,e.next=3,Promise.all(a.map((function(e){return ft({loader:n,selection:e,use3d:r})})));case 3:return o=e.sent,i=o.map((function(e){return e.domain})),l=o.map((function(e){return e.slider})),e.abrupt("return",{domains:i,sliders:l});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function gt(e){var t=Array.isArray(e)?e[0]:e,n=t.shape,a=t.labels,r=function(e){var t,n,a=null!==(t=null===e||void 0===e||null===(n=e.meta)||void 0===n?void 0:n.physicalSizes)&&void 0!==t?t:{},r=a.x,o=a.y,i=a.z;if((null===r||void 0===r?void 0:r.size)&&(null===o||void 0===o?void 0:o.size)&&(null===i||void 0===i?void 0:i.size)){var l=Math.min(i.size,r.size,o.size),s=[r.size/l,o.size/l,i.size/l];return(new Me.Matrix4).scale(s)}return(new Me.Matrix4).identity()}(t);return[[0,r[0]*n[a.indexOf("x")]],[0,r[5]*n[a.indexOf("y")]],[0,r[10]*n[a.indexOf("z")]]]}function bt(e){for(var t=[],n=function(e){var t=e.labels.filter((function(e){return Je.includes(e)})),n={};return t.forEach((function(t){n[t]=Math.floor((e.shape[e.labels.indexOf(t)]||0)/2)})),n}(e),a=e.labels.filter((function(t){return!Je.includes(t)&&e.shape[e.labels.indexOf(t)]}))[0],r=0;r<Math.min(4,e.shape[e.labels.indexOf(a)]);r+=1)t.push(Object(s.a)(Object(B.a)({},a,r),n));return t}function yt(e){var t=e[e.length-1];return 3===t||4===t}function vt(e,t){return Ot.apply(this,arguments)}function Ot(){return(Ot=Object(Oe.a)(ve.a.mark((function e(t,n){var a,r,o,i,l,c,u;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],r=W(t),o=bt(r),o=yt(r.shape)?[Object(s.a)({},o[0],{c:0})]:o,e.next=6,ht({loader:t.data,selections:o,use3d:n});case 6:return i=e.sent,l=q(t)?[[0,255],[0,255],[0,255]]:i.domains,c=q(t)?[[255,0,0],[0,255,0],[0,0,255]]:null,u=q(t)?[[0,255],[0,255],[0,255]]:i.sliders,o.forEach((function(e,t){var n=l[t],r=u[t],i={selection:e,color:c?c[t]:1!==o.length?Ue[t]:[255,255,255],visible:!0,slider:r||n};a.push(i)})),e.abrupt("return",a);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xt(e,t){var n=t.map((function(e){return W(e)}));if(e.map((function(e){var t,n,a,r,o,i;return(null===e||void 0===e||null===(t=e.metadata)||void 0===t||null===(n=t.transform)||void 0===n?void 0:n.matrix)||(null===e||void 0===e||null===(a=e.metadata)||void 0===a||null===(r=a.transform)||void 0===r?void 0:r.scale)||(null===e||void 0===e||null===(o=e.metadata)||void 0===o||null===(i=o.transform)||void 0===i?void 0:i.translate)})).some(Boolean)||n.every((function(e){var t,n,a,r;return!(null===(t=e.meta)||void 0===t||null===(n=t.physicalSizes)||void 0===n?void 0:n.x)||!(null===(a=e.meta)||void 0===a||null===(r=a.physicalSizes)||void 0===r?void 0:r.y)})))return e;var a=n.reduce((function(e,t){var n,a,r,o,i,l,s,c,u,p=null===(n=t.meta)||void 0===n||null===(a=n.physicalSizes)||void 0===a||null===(r=a.z)||void 0===r?void 0:r.size,d=[Object(De.c)("".concat(null===(o=t.meta)||void 0===o?void 0:o.physicalSizes.x.size," ").concat(null===(i=t.meta)||void 0===i?void 0:i.physicalSizes.x.unit).replace("\xb5","u")),Object(De.c)("".concat(null===(l=t.meta)||void 0===l?void 0:l.physicalSizes.y.size," ").concat(null===(s=t.meta)||void 0===s?void 0:s.physicalSizes.y.unit).replace("\xb5","u"))];p&&d.push(Object(De.c)("".concat(null===(c=t.meta)||void 0===c?void 0:c.physicalSizes.z.size," ").concat(null===(u=t.meta)||void 0===u?void 0:u.physicalSizes.z.unit).replace("\xb5","u")));return e[0]=void 0===e[0]||-1===Object(De.a)(d[0],e[0])?d[0]:e[0],e[1]=void 0===e[1]||-1===Object(De.a)(d[1],e[1])?d[1]:e[1],e[2]=void 0===e[2]||-1===Object(De.a)(d[2],e[2])?d[2]:e[2],e}),[]);return e.map((function(e,t){var r,o,i,l,u,p,d,m,f,h=n[t],g=null===(r=h.meta)||void 0===r||null===(o=r.physicalSizes)||void 0===o||null===(i=o.z)||void 0===i?void 0:i.size,b=[Object(De.c)("".concat(null===(l=h.meta)||void 0===l?void 0:l.physicalSizes.x.size," ").concat(null===(u=h.meta)||void 0===u?void 0:u.physicalSizes.x.unit).replace("\xb5","u")),Object(De.c)("".concat(null===(p=h.meta)||void 0===p?void 0:p.physicalSizes.y.size," ").concat(null===(d=h.meta)||void 0===d?void 0:d.physicalSizes.y.unit).replace("\xb5","u"))];g&&b.push(Object(De.c)("".concat(null===(m=h.meta)||void 0===m?void 0:m.physicalSizes.z.size," ").concat(null===(f=h.meta)||void 0===f?void 0:f.physicalSizes.z.unit).replace("\xb5","u")));var y=b.map((function(e,t){return Object(De.b)(e,a[t])}));if(y[2]||(y[2]=1),I()(y,[1,1,1]))return e;var v=(new Me.Matrix4).scale(Object(c.a)(y)),O=Object(s.a)({},e);return O.metadata=Object(s.a)({},O.metadata,{transform:{matrix:v.toArray()}}),O}))}function jt(e,t,n){return Et.apply(this,arguments)}function Et(){return(Et=Object(Oe.a)(ve.a.mark((function e(t,n,a){var r,o,i,l,c,u,p,d,m,f,h,g,b,y;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],o=[],i=[],e.next=5,Promise.all(t.map((function(e){return e.loaderCreator()})));case 5:for(l=e.sent,c=0;c<t.length;c++)u=t[c],p=l[c],r[c]=p,o[c]=u;if(a&&(o=xt(o,r)),n)for(h=n.map((function(e){return t.findIndex((function(t){return t.name===e}))})),g=function(e){var t=h[e],n=vt(r[t]).then((function(n){var a,r,i,l,c;return Promise.resolve(Object(s.a)({type:(null===(a=o[t])||void 0===a||null===(r=a.metadata)||void 0===r?void 0:r.isBitmask)?"bitmask":"raster",index:t},Qe,{channels:n.map((function(e,n){return Object(s.a)({},e,{},o[t].channels?o[t].channels[n]:[])})),domainType:"Min/Max",modelMatrix:null===(i=o[t])||void 0===i||null===(l=i.metadata)||void 0===l||null===(c=l.transform)||void 0===c?void 0:c.matrix,transparentColor:e>0?[0,0,0]:null}))}));i.push(n)},b=0;b<h.length;b++)g(b);else d=Math.floor(t.length/2),m=r[d],f=vt(m).then((function(e){var t,n,a,r,i;return Promise.resolve(Object(s.a)({type:(null===(t=o[d])||void 0===t||null===(n=t.metadata)||void 0===n?void 0:n.isBitmask)?"bitmask":"raster",index:d},Qe,{channels:e.map((function(e,t){return Object(s.a)({},e,{},o[d].channels?o[d].channels[t]:[])})),modelMatrix:null===(a=o[d])||void 0===a||null===(r=a.metadata)||void 0===r||null===(i=r.transform)||void 0===i?void 0:i.matrix,transparentColor:d>0?[0,0,0]:null}))})),i.push(f);return e.next=11,Promise.all(i);case 11:return y=e.sent,e.abrupt("return",[y,r,o]);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ct(e){var t=e.tile,n=t.bbox,a=n.left,r=n.top,i=n.right,l=n.bottom,s=t.x,c=t.y,u=t.z,p=e.data,d=e.id,m=e.loader;if([a,l,i,r].some((function(e){return e<0}))||!p)return null;var f=m[0],h=m[0].shape.slice(-2),g=Object(o.a)(h,2),b=g[0],y=g[1],v=[a,p.height<f.tileSize?b:l,p.width<f.tileSize?y:i,r];return new ct(e,{channelData:p,cellColor:{data:e.cellColorData,height:e.cellColorHeight,width:e.cellColorWidth},bounds:v,id:"sub-layer-".concat(v,"-").concat(d),tileId:{x:s,y:c,z:u}})}function St(e){return wt.apply(this,arguments)}function wt(){return(wt=Object(Oe.a)(ve.a.mark((function e(t){var n,a,r,i,l,c,u,p,d,m,f,h,g,b,y,v,O,x,j,E,C,S,w,L,T,A,k,_,I;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.type,a=t.url,r=t.metadata,i=t.requestInit,e.t0=n,e.next="zarr"===e.t0?4:"ome-tiff"===e.t0?30:53;break;case 4:if(c=(l=r||{}).dimensions,u=l.isPyramid,p=l.transform,d=c.map((function(e){return e.field})),!u){e.next=25;break}return f="".concat(a).concat("/"===a.slice(-1)?"":"/",".zmetadata"),e.next=10,fetch(f);case 10:return h=e.sent,e.next=13,h.json();case 13:return g=e.sent,b=g.metadata,y=Object.keys(b).filter((function(e){return e.includes(".zarray")})).map((function(e){return e.slice(0,-7)})),e.next=18,Promise.all(y.map((function(e){return Object(be.c)({store:a,path:e})})));case 18:v=e.sent,O=v[0].chunks.slice(-2),x=Object(o.a)(O,2),j=x[0],E=x[1],C=Math.min(j,E),S=Math.pow(2,Math.floor(Math.log2(C))),m=v.map((function(e){return new Pe.i(e,d,S)})),e.next=29;break;case 25:return e.next=27,Object(be.c)({store:a});case 27:w=e.sent,m=new Pe.i(w,d);case 29:return e.abrupt("return",{data:m,metadata:{dimensions:c,transform:p},channels:(c.find((function(e){return"channel"===e.field}))||c[0]).values});case 30:if(!r||!("omeTiffOffsetsUrl"in r)){e.next=47;break}return T=r.omeTiffOffsetsUrl,e.next=34,fetch(T,i||{});case 34:if(!(A=e.sent).ok){e.next=44;break}return e.next=38,A.json();case 38:return k=e.sent,e.next=41,Object(Pe.l)(a,{offsets:k,headers:null===i||void 0===i?void 0:i.headers});case 41:L=e.sent,e.next=45;break;case 44:throw new Error("Offsets not found but provided.");case 45:e.next=50;break;case 47:return e.next=49,Object(Pe.l)(a,{headers:null===i||void 0===i?void 0:i.headers});case 49:L=e.sent;case 50:return _=L.metadata.Pixels.Channels,I=Array.isArray(_)?_.map((function(e,t){return e.Name||"Channel ".concat(t)})):[_.Name||"Channel ".concat(0)],e.abrupt("return",Object(s.a)({},L,{channels:I}));case 53:throw Error("Image type (".concat(n,") is not supported"));case 54:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Lt=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(e){var a;Object(z.a)(this,n),a=t.call(this,e);var r=e.url,o=e.options;return!r&&o&&(a.url=URL.createObjectURL(new Blob([JSON.stringify(o)])),a.options=void 0),a.schema=me,a}return Object(G.a)(n,[{key:"load",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t,a,r,i,l,c,u,p;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Se.a)(Object(Ce.a)(n.prototype),"load",this).call(this).catch((function(e){return Promise.resolve(e)}));case 2:if(!((t=e.sent)instanceof oe)){e.next=5;break}return e.abrupt("return",Promise.reject(t));case 5:return a=t.data,r=a.images,i=a.renderLayers,l=a.usePhysicalSizeScaling,c=void 0!==l&&l,u=r.filter((function(e){return!e.url.includes("zarr")})).map((function(e){return[e.url,e.name]})),p=r.map((function(e){return Object(s.a)({},e,{loaderCreator:function(){var t=Object(Oe.a)(ve.a.mark((function t(){return ve.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",St(e));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()})})),this.autoImageCache||(this.autoImageCache=jt(p,i,c)),e.abrupt("return",this.autoImageCache.then((function(e){var t=Object(o.a)(e,3),n=t[0],a=t[1],r=t[2];return new ce({loaders:a,meta:r},u,{spatialRasterLayers:n})})));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ge);function Tt(e){var t=/^#?([A-F\d]{2})([A-F\d]{2})([A-F\d]{2})$/i.exec(e);return[parseInt(t[1].toLowerCase(),16),parseInt(t[2].toLowerCase(),16),parseInt(t[3].toLowerCase(),16)]}var At=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"load",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t,n,a,r,i,l,c,u,p,d,m,f,h,g,b,y,v;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getJson(".zattrs").catch((function(e){return Promise.resolve(e)}));case 2:if(!((a=e.sent)instanceof oe)){e.next=5;break}return e.abrupt("return",Promise.reject(a));case 5:return e.next=7,Object(Pe.m)(this.url,{fetchOptions:this.requestInit,type:"multiscales"});case 7:if(r=e.sent,i=r.metadata,l=i.omero){e.next=13;break}return console.error("Path for image not valid"),e.abrupt("return",Promise.reject(a));case 13:return c=l.rdefs,u=l.channels,p=null!==(t=c.defaultT)&&void 0!==t?t:0,d=null!==(n=c.defaultZ)&&void 0!==n?n:0,m=[{name:l.name,channels:u.map((function(e,t){return{selection:{z:d,t:p,c:t},slider:[e.window.start,e.window.end],color:Tt(e.color)}})),loaderCreator:function(){var e=Object(Oe.a)(ve.a.mark((function e(){return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(s.a)({},r,{channels:u.map((function(e){return e.label}))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}],e.next=19,jt(m,void 0);case 19:return f=e.sent,h=Object(o.a)(f,3),g=h[0],b=h[1],y=h[2],v={spatialRasterLayers:g},e.abrupt("return",Promise.resolve(new ce({loaders:b,meta:y},[],v)));case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(je),kt=n(373),_t=n.n(kt),It=n(1408),Pt=n(807),Nt=n(467),Rt=n.n(Nt);function Mt(e,t,n){e.key===t&&(e.preventDefault(),n())}function Dt(e){return Rt()({r:e[0],g:e[1],b:e[2]}).toHexString()}function zt(e){var t=Rt()(e).toRgb();return[t.r,t.g,t.b]}function Gt(e){if(0===e)return"Color by hierarchy";if(e<=2){return"Color by ".concat("sub".repeat(e-1),"cluster")}return"Color by cluster level ".concat(e)}function Ht(e,t){return e.length<=t.length&&I()(e,t.slice(0,e.length))}function Ft(e,t,n){return Ht(e,t)?[].concat(Object(c.a)(n),Object(c.a)(t.slice(n.length))):t}function Xt(e){return e.join("___")}var Bt=n(52),Zt=n(353),Ut=n.n(Zt),Vt=n(808),Yt=n.n(Vt);function Wt(e){return e?e.children?e.children.flatMap((function(e){return Wt(e)})):e.set||[]:[]}function qt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e.children)return t;var n=t+1,a=e.children.map((function(e){return qt(e,n)}));return Math.max.apply(Math,Object(c.a)(a).concat([n]))}function $t(e,t){var n=e.tree.map((function(e){return function e(t,n,a){var r=n[a];if(t.name===r){if(a===n.length-1)return t;if(t.children){var o=t.children.map((function(t){return e(t,n,a+1)})).filter(Boolean);if(1===o.length)return o[0]}}return null}(e,t,0)})).filter(Boolean);return 1===n.length?n[0]:null}function Kt(e,t,n,a,r){var o;return o=r?Object(c.a)(r):[e.name],t(e,o)?(a.push(o),n(e,o)):e.children?Object(s.a)({},e,{children:e.children.map((function(e){return Kt(e,t,n,a,o.concat([e.name]))}))}):e}function Jt(e,t){return Object(s.a)({},e,{children:[].concat(Object(c.a)(e.children),[t])})}function Qt(e,t){var n=t.map((function(t){return $t(e,t)})).map((function(e){return Wt(e).map((function(e){return Object(o.a)(e,1)[0]}))}));return n.reduce((function(e,t){return e.concat(t.filter((function(t){return!e.includes(t)})))}),n[0]||[])}function en(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e.children?0===t?[[].concat(Object(c.a)(n),[e.name])]:e.children.flatMap((function(r){return en(r,t-1,[].concat(Object(c.a)(n),[e.name]),a)})).filter(Boolean):a?[[].concat(Object(c.a)(n),[e.name])]:null}function tn(e,t){return{version:He[t].latestVersion,datatype:t,tree:e.tree}}function nn(e,t,n,a){var r=$t(e,t),o=function e(t,n,a,r,o){var i;i=o?Object(c.a)(o):[t.name];var l=t;return n(t,i)&&(r.push(i),l=a(t,i)),t.children?Object(s.a)({},l,{children:l.children.map((function(t){return e(t,n,a,r,i.concat([t.name]))}))}):l}(r,(function(){return!0}),(function(e,t){var n,r,o=null!==(n=null===a||void 0===a||null===(r=a.find((function(e){return I()(e.path,t)})))||void 0===r?void 0:r.color)&&void 0!==n?n:Be;return Object(s.a)({},e,{color:o.slice(0,3)})}),[]);return{treeToExport:tn(Object(s.a)({},e,{tree:[o]}),n),nodeName:r.name}}function an(e){return{version:He[e].latestVersion,datatype:e,tree:[]}}function rn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[128,128,128];return[(e[0]-n[0])*t+n[0],(e[1]-n[1])*t+n[1],(e[2]-n[2])*t+n[2]]}function on(e,t,n){var a=[];return t.forEach((function(t){var r=$t(e,t);if(r){var o,i=Wt(r),l=(null===(o=n.find((function(e){return I()(e.path,t)})))||void 0===o?void 0:o.color)||Be;a.push({key:ae()(),name:r.name,size:i.length,color:l})}})),a}function ln(e,t,n){return I()([].concat(Object(c.a)(t),[e.name]),n)?null:e.children?Object(s.a)({},e,{children:e.children.map((function(a){return ln(a,[].concat(Object(c.a)(t),[e.name]),n)})).filter(Boolean)}):e}function sn(e,t){var n=[],a=[],r=!1;function o(e,t){n.push([].concat(Object(c.a)(t),[e.name])),e.children&&e.children.forEach((function(n){return o(n,[].concat(Object(c.a)(t),[e.name]))}))}return e.tree.forEach((function(e){return o(e,[])})),t.tree.forEach((function(e){return t=e,n=[],a.push([].concat(Object(c.a)(n),[t.name])),void(t.children&&t.children.forEach((function(e){return o(e,[].concat(Object(c.a)(n),[t.name]))})));var t,n})),a.forEach((function(e){n.find((function(t){return I()(t,e)}))&&(r=!0)})),r}function cn(e,t){var n=Object(c.a)(t||[]),a=e.tree.map((function(e){return Array.from({length:qt(e)+1}).fill(0)}));return e.tree.forEach((function(e,t){return function e(t,r,o,i){var l=a[i][o],s=[].concat(Object(c.a)(r),[t.name]);n.find((function(e){return I()(e.path,s)}))||n.push({path:s,color:Ze[l%Ze.length]}),a[i][o]+=1,t.children&&t.children.forEach((function(t){return e(t,s,o+1,i)}))}(e,[],0,t)})),n}function un(e){var t=e.cells,n=e.mapping,a=e.cellSets,r=e.cellSetSelection,i=e.cellSetColor;return r&&r.length>0&&a&&t?function(e,t,n,a,r){var i=[];return a.forEach((function(a){var l=$t(e,a);if(l){var s,c=Wt(l),u=(null===r||void 0===r||null===(s=r.find((function(e){return I()(e.path,a)})))||void 0===s?void 0:s.color)||Be,p=c.map((function(e){var a,r,i=Object(o.a)(e,1)[0];return[null===(a=t[i])||void 0===a?void 0:a.mappings[n][0],-(null===(r=t[i])||void 0===r?void 0:r.mappings[n][1])]})).filter((function(e){return e.every((function(e){return"number"===typeof e}))}));if(p.length>2){var d=Object(Bt.featureCollection)(p.map(Bt.point)),m=Yt()(p,1/0);if(m){var f=Ut()(d).geometry.coordinates;i.push({path:a,name:a[a.length-1],hull:m,color:u,centroid:f})}}}})),i}(a,t,n,r,i):[]}function pn(e,t){var n=(new te.a).compile(He[t].schema);if(!n(e)){var a=JSON.stringify(n.errors,null,2);throw new Error("Tree validation failed: ".concat(a))}if(e.datatype!==t)throw new Error("The data type does not match the expected data type of '".concat(t,"'."));return"0.1.2"===e.version?Object(s.a)({},e,{version:He[t].latestVersion,tree:e.tree.map((function(e){return Kt(e,(function(e){return!e.children&&Array.isArray(e.set)}),(function(e){return Object(s.a)({},e,{set:e.set.map((function(e){return[e,null]}))})}),[])}))}):e}function dn(e,t){var n=JSON.parse(e);return n=pn(n,t)}function mn(e,t){var n=Object(It.a)(",").parse(e,(function(e){return{groupName:e.groupName,setName:e.setName,setColor:e.setColor?zt(e.setColor):Be,obsId:e.obsId,predictionScore:_t()(e.predictionScore)||"NA"===e.predictionScore?null:+e.predictionScore}})),a=(new te.a).compile(Fe[t].schema);if(a(n)){var r={version:He[t].latestVersion,datatype:t,tree:[]};return Array.from(new Set(n.map((function(e){return e.groupName})))).forEach((function(e){var t={name:e,children:[]},a=n.filter((function(t){return t.groupName===e}));Array.from(new Set(a.map((function(e){return e.setName})))).forEach((function(e){var n=a.filter((function(t){return t.setName===e})),r=n[0].setColor,o={name:e,color:r,set:n.map((function(e){return[e.obsId,e.predictionScore]}))};t.children.push(o)})),r.tree.push(t)})),r}var o=JSON.stringify(a.errors,null,2);throw new Error("Import validation failed: ".concat(o))}function fn(e){var t=JSON.stringify(e);return"data:".concat("application/json",";charset=utf-8,").concat(encodeURIComponent(t))}function hn(e,t){var n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download",t),document.body.appendChild(n),n.click(),n.remove()}var gn=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(e){var a;return Object(z.a)(this,n),(a=t.call(this,e)).schema=fe,a}return Object(G.a)(n,[{key:"load",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t,a,r,o,i,l,s,c,u;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Se.a)(Object(Ce.a)(n.prototype),"load",this).call(this).catch((function(e){return Promise.resolve(e)}));case 2:if(!((t=e.sent)instanceof oe)){e.next=5;break}return e.abrupt("return",Promise.reject(t));case 5:return a=t.data,r=t.url,o=pn(a,"cell"),i={cellSetSelection:[],cellSetColor:[]},o&&o.tree.length>=1&&(l=o.tree,s=l[0].name,c=l[0].children.map((function(e){return[s,e.name]})),u=cn(o,[]),i.cellSetSelection=c,i.cellSetColor=u),e.abrupt("return",Promise.resolve(new ce(o,r,i)));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ge),bn=function(e){if(4!==e.length)throw new Error("readFloat32 only takes in length 4 byte buffers");return new Int32Array(e.buffer)[0]};function yn(e){var t=new TextDecoder,n=0,a=n+e.length,r=bn(e.slice(n,4));if(e.length<4)throw new Error("corrupt buffer, missing or truncated header");n+=4;for(var o=new Array(r),i=0;i<r;i+=1){if(n+4>a)throw new Error("corrupt buffer, data seem truncated");var l=bn(e.slice(n,n+4));if((n+=4)+l>a)throw new Error("corrupt buffer, data seem truncated");o[i]=t.decode(e.slice(n,n+l)),n+=l}return o}var vn,On=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"loadCellSetIds",value:function(e){var t=this,n=this.store;return this.cellSets||(this.cellSets=Promise.all(e.map(function(){var e=Object(Oe.a)(ve.a.mark((function e(a){var r,o,i,l,s,c,u,p;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getJson("".concat(a,"/.zattrs"));case 2:if(r=e.sent,!(o=r.categories)){e.next=13;break}return e.next=7,t.getJson("/obs/".concat(o,"/.zarray"));case 7:if(l=e.sent,"|O"!==l.dtype){e.next=13;break}return e.next=12,t.getFlatArrDecompressed("/obs/".concat(o));case 12:i=e.sent;case 13:return e.next=15,Object(be.c)({store:n,path:a,mode:"r"});case 15:return s=e.sent,e.next=18,s.get();case 18:return c=e.sent,u=c.data,p=Array.from(u).map((function(e){return i?i[e]:String(e)})),e.abrupt("return",p);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))),this.cellSets}},{key:"loadNumeric",value:function(e){var t=this.store;return Object(be.c)({store:t,path:e,mode:"r"}).then((function(e){return e.get()}))}},{key:"getFlatArrDecompressed",value:function(e){var t=this.store;return Object(be.c)({store:t,path:e,mode:"r"}).then(function(){var e=Object(Oe.a)(ve.a.mark((function e(n){var a,r,i,l,s,c,u;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(e){var t=yn(e);a=a?a.concat(t):t},i=function(e){if(a){var t=new Uint8Array(e.buffer.byteLength+a.buffer.byteLength);t.set(new Uint8Array(a.buffer),0),t.set(e,a.buffer.byteLength),a=t}else a=e},l=Math.ceil(n.meta.shape[0]/n.meta.chunks[0]),s=ke()(l).map(function(){var e=Object(Oe.a)(ve.a.mark((function e(a){return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.getItem("".concat(n.keyPrefix).concat(String(a))).then((function(e){return n.compressor.then((function(t){return t.decode(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=6,Promise.all(s);case 6:return e.sent.forEach((function(e){Array.isArray(n.meta.filters)&&"vlen-utf8"===n.meta.filters[0].id?r(e):i(e)})),c=Object(o.a)(n.meta.shape,1),u=c[0],e.abrupt("return",a.slice(0,u));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"loadCellNames",value:function(){var e=this;return this.cellNames||(this.cellNames=this.getJson("obs/.zattrs").then((function(t){var n=t._index;return e.getFlatArrDecompressed("/obs/".concat(n))}))),this.cellNames}}]),n}(je),xn=function(e){var t=Object(Te.a)(e),n=Object(o.a)(t,2),a=n[0],r=255/(n[1]-a);return{data:new Uint8Array(e.map((function(e){return Math.floor((e-a)*r)})))}},jn=function(e){for(var t=e.length,n=e[0].length,a=e[0].BYTES_PER_ELEMENT,r=new DataView(new ArrayBuffer(t*n*a)),o=e[0].constructor,i=o.name.replace("Array",""),l=0;l<t;l+=1)for(var s=0;s<n;s+=1)r["set".concat(i)](a*(s*t+l),e[l][s],!0);return new o(r.buffer)},En={CellSetsZarrLoader:function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"load",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t,n,a,r,i,l,s,u;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.cellSetsTree||(t=this.options,n=t.map((function(e){return e.setName})),this.cellSetsTree=Promise.all([this.loadCellNames(),this.loadCellSetIds(n)]).then((function(e){var n=Object(o.a)(e,2),a=n[0],r=n[1],i=an("cell");return r.forEach((function(e,n){var r={name:t[n].groupName,children:[]},o=Array.apply(void 0,Object(c.a)(new Set(e))).sort(),l={};o.forEach((function(e){return l[e]={name:e,set:[]}})),e.forEach((function(e,t){return l[e].set.push([a[t],null])})),Object.values(l).forEach((function(e){return r=Jt(r,e)})),i.tree.push(r)})),i}))),e.next=3,this.cellSetsTree;case 3:return a=e.sent,r={},i=a.tree,l=i[0].name,s=i[0].children.map((function(e){return[l,e.name]})),u=cn(a,[]),r.cellSetSelection=s,r.cellSetColor=u,e.abrupt("return",Promise.resolve(new ce(a,null,r)));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(On),CellsZarrLoader:function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"loadXy",value:function(){var e=(this.options||{}).xy;return this.xy?this.xy:!this.xy&&e?(this.xy=this.loadNumeric(e),this.xy):(this.xy=Promise.resolve(null),this.xy)}},{key:"loadPoly",value:function(){var e=(this.options||{}).poly;return this.poly?this.poly:!this.poly&&e?(this.poly=this.loadNumeric(e),this.poly):(this.poly=Promise.resolve(null),this.poly)}},{key:"loadMappings",value:function(){var e=this,t=(this.options||{}).mappings;return this.mappings?this.mappings:!this.mappings&&t?(this.mappings=Promise.all(Object.keys(t).map(function(){var n=Object(Oe.a)(ve.a.mark((function n(a){var r;return ve.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t[a].key,n.t0=a,n.next=4,e.loadNumeric(r);case 4:return n.t1=n.sent,n.abrupt("return",{coordinationName:n.t0,arr:n.t1});case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())),this.mappings):(this.mappings=Promise.resolve(null),this.mappings)}},{key:"loadFactors",value:function(){var e=(this.options||{}).factors;return e?this.loadCellSetIds(e):Promise.resolve(null)}},{key:"load",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t=this;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.cells||(this.cells=Promise.all([this.loadMappings(),this.loadXy(),this.loadPoly(),this.loadCellNames(),this.loadFactors()]).then((function(e){var n=Object(o.a)(e,5),a=n[0],r=n[1],i=n[2],l=n[3],s=n[4],c={};return l.forEach((function(e,n){if(c[e]={},a&&a.forEach((function(a){var r=a.coordinationName,o=a.arr;c[e].mappings||(c[e].mappings={});var i=t.options.mappings[r].dims;c[e].mappings[r]=i.map((function(e){return o.data[n][e]}))})),r&&(c[e].xy=r.data[n]),i&&(c[e].poly=i.data[n]),s){var o={};s.forEach((function(e,a){return o[t.options.factors[a].split("/").slice(-1)]=e[n]})),c[e].factors=o}})),c}))),e.t0=Promise,e.t1=ce,e.next=5,this.cells;case 5:return e.t2=e.sent,e.t3=new e.t1(e.t2,null),e.abrupt("return",e.t0.resolve.call(e.t0,e.t3));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(On),MatrixZarrLoader:function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"loadGeneNames",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t,n,a,r;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.geneNames){e.next=2;break}return e.abrupt("return",this.geneNames);case 2:if(!(t=this.options.geneFilter)){e.next=7;break}return e.next=6,this.getFlatArrDecompressed(t);case 6:n=e.sent;case 7:return e.next=9,this.getJson("var/.zattrs");case 9:if(a=e.sent,r=a._index,!this.geneNames){e.next=13;break}return e.abrupt("return",this.geneNames);case 13:return this.geneNames=this.getFlatArrDecompressed("var/".concat(r)).then((function(e){return e.filter((function(e,t){return!n||n[t]}))})),e.abrupt("return",this.geneNames);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getFilteredGenes",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a,r;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getFlatArrDecompressed(t);case 2:return n=e.sent,e.next=5,this.loadGeneNames();case 5:return a=e.sent,r=a.filter((function(e,t){return n[t]})),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getGeneIndices",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadGeneNames();case 2:return n=e.sent,e.abrupt("return",t.map((function(e){return n.indexOf(e)})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getNumCells",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadCellNames();case 2:return t=e.sent,e.abrupt("return",t.length);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getNumGenes",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadGeneNames();case 2:return t=e.sent,e.abrupt("return",t.length);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_openSparseArrays",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t,n;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.options.matrix,n=this.store,!this.sparseArrays){e.next=3;break}return e.abrupt("return",this.sparseArrays);case 3:return this.sparseArrays=Promise.all(["indptr","indices","data"].map((function(e){return Object(be.c)({store:n,path:"".concat(t,"/").concat(e),mode:"r"})}))),e.abrupt("return",this.sparseArrays);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_loadCSCGeneSelection",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a,r,i,l,s,c,u,p;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getGeneIndices(t);case 2:return n=e.sent,e.next=5,this._openSparseArrays();case 5:return a=e.sent,r=Object(o.a)(a,3),i=r[0],l=r[1],s=r[2],e.next=12,this._getNumCells();case 12:return c=e.sent,e.next=15,i.getRaw(null);case 15:return u=e.sent,p=u.data,e.abrupt("return",Promise.all(n.map(function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a,r,o,i,u,d,m,f;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=p[t],a=p[t+1],r=n===a,o=new Float32Array(c).fill(0),!r){e.next=6;break}return e.abrupt("return",o);case 6:return e.next=8,l.get([Object(be.d)(n,a)]);case 8:return i=e.sent,u=i.data,e.next=12,s.get([Object(be.d)(n,a)]);case 12:for(d=e.sent,m=d.data,f=0;f<u.length;f+=1)o[u[f]]=m[f];return e.abrupt("return",o);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_loadCSRGeneSelection",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a,r,o;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getGeneIndices(t);case 2:return n=e.sent,e.next=5,this._getNumGenes();case 5:return a=e.sent,e.next=8,this._getNumCells();case 8:return r=e.sent,e.next=11,this._loadCSRSparseCellXGene();case 11:return o=e.sent,e.abrupt("return",n.map((function(e){for(var t=new Float32Array(r).fill(0),n=0;n<r;n+=1)t[n]=o[n*a+e];return t})));case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_loadCSRSparseCellXGene",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t=this;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._sparseMatrix){e.next=2;break}return e.abrupt("return",this._sparseMatrix);case 2:return this._sparseMatrix=this._openSparseArrays().then(function(){var e=Object(Oe.a)(ve.a.mark((function e(n){var a,r,i,l,s,c,u,p,d,m;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.options.matrix,e.next=3,t.getJson("".concat(a,"/.zattrs"));case 3:return r=e.sent,i=r.shape,e.next=7,Promise.all(n.map(function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getRaw(null);case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:return l=e.sent,s=Object(o.a)(l,3),c=s[0],u=s[1],p=s[2],d=new Float32Array(i[0]*i[1]).fill(0),m=0,c.forEach((function(e,t){for(var n=c[t],a=c[t+1],r=n;r<a;r+=1){var o=p[r],l=u[r];d[m*i[1]+l]=o}m+=1})),e.abrupt("return",d);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",this._sparseMatrix);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_loadCSCSparseCellXGene",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t=this;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._sparseMatrix){e.next=2;break}return e.abrupt("return",this._sparseMatrix);case 2:return this._sparseMatrix=this._openSparseArrays().then(function(){var e=Object(Oe.a)(ve.a.mark((function e(n){var a,r,i,l,s,c,u,p,d,m;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.options.matrix,e.next=3,t.getJson("".concat(a,"/.zattrs"));case 3:return r=e.sent,i=r.shape,e.next=7,Promise.all(n.map(function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getRaw(null);case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:return l=e.sent,s=Object(o.a)(l,3),c=s[0],u=s[1],p=s[2],d=new Float32Array(i[0]*i[1]).fill(0),m=0,c.forEach((function(e,t){for(var n=c[t],a=c[t+1],r=n;r<a;r+=1){var o=p[r],l=u[r];d[l*i[1]+m]=o}m+=1})),e.abrupt("return",d);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",this._sparseMatrix);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadCellXGene",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t,n,a,r,o,i,l=this;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.store,!this.cellXGene){e.next=3;break}return e.abrupt("return",this.cellXGene);case 3:if(n=this.options,a=n.matrix,r=n.matrixGeneFilter,this._matrixZattrs){e.next=8;break}return e.next=7,this.getJson("".concat(a,"/.zattrs"));case 7:this._matrixZattrs=e.sent;case 8:if(o=this._matrixZattrs["encoding-type"],r){e.next=13;break}"csr_matrix"===o?this.cellXGene=this._loadCSRSparseCellXGene().then((function(e){return xn(e)})):"csc_matrix"===o?this.cellXGene=this._loadCSCSparseCellXGene().then((function(e){return xn(e)})):(this.arr||(this.arr=Object(be.c)({store:t,path:a,mode:"r"})),this.cellXGene=this.arr.then((function(e){return e.getRaw(null).then((function(e){var t=e.data;return xn(t)}))}))),e.next=21;break;case 13:if("csr_matrix"!==o){e.next=17;break}this.cellXGene=this._loadCSRSparseCellXGene().then(function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a,o,i,s,c,u,p,d;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l._getFilteredGenes(r);case 2:return n=e.sent,a=n.length,e.next=6,l.loadGeneNames();case 6:return o=e.sent,i=o.length,e.next=10,l._getNumCells();case 10:for(s=e.sent,c=new Float32Array(s*a).fill(0),u=0;u<a;u+=1)for(p=o.indexOf(n[u]),d=0;d<s;d+=1)c[d*a+u]=t[d*i+p];return e.abrupt("return",xn(c));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=21;break;case 17:return e.next=19,this._getFilteredGenes(r);case 19:i=e.sent,this.cellXGene=this.loadGeneSelection({selection:i,shouldNormalize:!1}).then((function(e){var t=e.data;return xn(jn(t))}));case 21:return e.abrupt("return",this.cellXGene);case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadGeneSelection",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a,r,o,i,l,s,c,u=this;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.selection,a=t.shouldNormalize,r=void 0===a||a,o=this.options.matrix,i=this.store,this._matrixZattrs){e.next=6;break}return e.next=5,this.getJson("".concat(o,"/.zattrs"));case 5:this._matrixZattrs=e.sent;case 6:if("csc_matrix"!==(l=this._matrixZattrs["encoding-type"])){e.next=13;break}return e.next=10,this._loadCSCGeneSelection(n);case 10:s=e.sent,e.next=26;break;case 13:if("csr_matrix"!==l){e.next=19;break}return e.next=16,this._loadCSRGeneSelection(n);case 16:s=e.sent,e.next=26;break;case 19:return this.arr||(this.arr=Object(be.c)({store:i,path:o,mode:"r"})),e.next=22,this._getGeneIndices(n);case 22:return c=e.sent,e.next=25,Promise.all(c.map((function(e){return u.arr.then((function(t){return t.get([null,e])})).then((function(e){return e.data}))})));case 25:s=e.sent;case 26:return e.abrupt("return",{data:s.map((function(e){return r?xn(e).data:e})),url:null});case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadAttrs",value:function(){return Promise.all([this.loadCellNames(),this.loadGeneNames()]).then((function(e){var t=Object(o.a)(e,2);return{data:{rows:t[0],cols:t[1]},url:null}}))}},{key:"load",value:function(){var e=this;return Promise.all([this.loadAttrs(),this.loadCellXGene()]).then(function(){var t=Object(Oe.a)(ve.a.mark((function t(n){var a,r,i,l,s;return ve.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=Object(o.a)(n,2),r=a[0].data,i=a[1],!(l=e.options.matrixGeneFilter)){t.next=7;break}return t.next=5,e.getFlatArrDecompressed(l);case 5:s=t.sent,r.cols=r.cols.filter((function(e,t){return s[t]}));case 7:return t.abrupt("return",Promise.resolve(new ce([r,i],null)));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}]),n}(On)},Cn=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(e){var a;Object(z.a)(this,n),a=t.call(this,e);var r=Object(xe.a)(a),o=r.url;r.requestInit;return a.store=new be.a(o),a}return Object(G.a)(n,[{key:"loadAttrs",value:function(){var e=this.store;return this.attrs||(this.attrs=e.getItem(".zattrs").then((function(e){var t=new TextDecoder("utf-8");return JSON.parse(t.decode(e))}))),this.attrs}},{key:"load",value:function(){var e=this.url;return this.loadAttrs().then((function(t){return Promise.resolve(new ce(t,e))}))}}]),n}(re),Sn=(vn={"expression-matrix.zarr":Ee,"clusters.json":Ie,"genes.json":Le,"cells.json":ge,"molecules.json":ge,"neighborhoods.json":ge,"raster.json":Lt,"raster.ome-zarr":At,"cell-sets.json":gn},Object(B.a)(vn,"".concat("anndata","-cell-sets.zarr"),En.CellSetsZarrLoader),Object(B.a)(vn,"".concat("anndata","-cells.zarr"),En.CellsZarrLoader),Object(B.a)(vn,"".concat("anndata","-expression-matrix.zarr"),En.MatrixZarrLoader),Object(B.a)(vn,"genomic-profiles.zarr",Cn),vn);var wn=n(273),Ln=n(602),Tn=n.n(Ln),An=Object(wn.a)((function(e){return{viewConfig:null,loaders:null,setViewConfig:function(t){return e({viewConfig:t})},setLoaders:function(t){return e({loaders:t})},setCoordinationValue:function(t){var n=t.parameter,a=t.scope,r=t.value;return e((function(e){return{viewConfig:Object(s.a)({},e.viewConfig,{coordinationSpace:Object(s.a)({},e.viewConfig.coordinationSpace,Object(B.a)({},n,Object(s.a)({},e.viewConfig.coordinationSpace[n],Object(B.a)({},a,r))))})}}))},removeComponent:function(t){return e((function(e){var n=e.viewConfig.layout.slice();return n.splice(t,1),{viewConfig:Object(s.a)({},e.viewConfig,{layout:n})}}))},changeLayout:function(t){return e((function(e){var n=e.viewConfig.layout.slice();return t.forEach((function(e){var t=Object(o.a)(e,2),a=t[0],r=t[1];n[a]=Object(s.a)({},n[a],{},r)})),{viewConfig:Object(s.a)({},e.viewConfig,{layout:n})}}))}}})),kn=Object(wn.a)((function(e){return{auxiliaryStore:null,setCoordinationValue:function(t){var n=t.parameter,a=t.scope,r=t.value;return e((function(e){return{auxiliaryStore:Object(s.a)({},e.auxiliaryStore,Object(B.a)({},n,Object(B.a)({},a,r)))}}))}}})),_n=Object(wn.a)((function(e){return{componentHover:null,setComponentHover:function(t){return e({componentHover:t})}}})),In=Object(wn.a)((function(e){return{warning:null,setWarning:function(t){return e({warning:t})}}})),Pn=Object(wn.a)((function(e){return{viewInfo:{},setComponentViewInfo:function(t,n){return e((function(e){return{viewInfo:Object(s.a)({},e.viewInfo,Object(B.a)({},t,n))}}))}}})),Nn=Object(wn.a)((function(e){return{resizeCount:{},incrementResizeCount:function(){return e((function(e){return{resizeCount:e.resizeCount+1}}))}}}));function Rn(e,t){var n=An((function(e){return e.setCoordinationValue}));return[An((function(n){var a=n.viewConfig.coordinationSpace;return Z(e.map((function(e){return a&&a[e]?[e,a[e][t[e]]]:[e,void 0]})))}),Tn.a),Object(i.useMemo)((function(){return Z(e.map((function(e){return["set".concat(V(e)),function(a){return n({parameter:e,scope:t[e],value:a})}]})))}),[e,t])]}var Mn={spatialRasterLayers:["rasterLayersCallbacks","areLoadingRasterChannnels"]};function Dn(e,t){var n=kn((function(e){return e.setCoordinationValue})),a=function(e){var t={};return Object.keys(e).forEach((function(n){(Mn[n]||[]).forEach((function(a){t[a||n]=e[n]}))})),t}(t),r=function(e){return e.map((function(e){return Mn[e]})).filter(Boolean).flat()}(e);return[kn((function(e){var t=e.auxiliaryStore;return Z(r.map((function(e){return t&&t[e]?[e,t[e][a[e]]]:[e,void 0]})))}),Tn.a),Object(i.useMemo)((function(){return Z(r.map((function(e){return["set".concat(V(e)),function(t){return n({parameter:e,scope:a[e],value:t})}]})))}),[e,t])]}function zn(){return An((function(e){return e.loaders}))}function Gn(){return _n((function(e){return e.componentHover}))}function Hn(){return _n((function(e){return e.setComponentHover}))}function Fn(){return In((function(e){return e.warning}))}function Xn(){return In((function(e){return e.setWarning}))}function Bn(e){return Pn(Object(i.useCallback)((function(t){return t.viewInfo[e]}),[e]))}function Zn(e){var t=Object(i.useRef)(Pn.getState().setComponentViewInfo);return function(n){return t.current(e,n)}}function Un(){return Nn((function(e){return e.resizeCount}))}function Vn(){return Nn((function(e){return e.incrementResizeCount}))}function Yn(e){var t=e.rowHeight,n=e.config,a=e.getComponent,r=e.theme,s=e.height,c=function(e,t,n,a,r){var l=Object(i.useState)(n),s=Object(o.a)(l,2),c=s[0],u=s[1],p=Object(i.useState)(t),d=Object(o.a)(p,2),m=d[0],f=d[1],h=Object(i.useRef)();return Object(i.useEffect)((function(){var t=function(e){for(var t,n=0,a=0,r=e.length;a<r;a++)(t=e[a].y+e[a].h)>n&&(n=t);return n}(e.layout),n=function(e,t,n,a){return(e-2*a-(t-1)*n)/t}(c,t,a,r);f(n)}),[c,e,a,r]),Object(i.useEffect)((function(){null!==n&&void 0!==n&&u(n)}),[n]),Object(i.useEffect)((function(){if(null!==n&&void 0!==n)return function(){};function e(){if(h.current){var e=h.current.getBoundingClientRect();u(e.height)}}return window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e)}}),[h,n]),[m,h]}(n,t,s,5,10),u=Object(o.a)(c,2),p=u[0],d=u[1],m=Vn();Object(i.useEffect)((function(){m()}),[p,m]);var f=Object(i.useRef)(An.getState().setViewConfig).current,h=An((function(e){return e.setLoaders})),g=An((function(e){return e.removeComponent})),b=An((function(e){return e.changeLayout})),y=An((function(e){var t;return null===(t=e.viewConfig)||void 0===t?void 0:t.layout}));return Object(i.useEffect)((function(){if(n){f(n);var e=function(e,t){var n={};return e.forEach((function(e){var a={name:e.name,description:e.description||t,loaders:{}};e.files.forEach((function(e){var t=Sn[e.fileType]||ge;a.loaders[e.type]=new t(e)})),n[e.uid]=a})),n}(n.datasets,n.description);h(e)}else h({})}),[n,f,h]),l.a.createElement("div",{ref:d,className:"vitessce-container vitessce-theme-".concat(r)},y&&l.a.createElement(Q,{layout:y,height:s,rowHeight:p,theme:r,getComponent:a,draggableHandle:".title",margin:5,padding:10,onRemoveComponent:g,onLayoutChange:b,reactGridLayoutProps:{onResize:m,onResizeStop:m}}))}var Wn,qn=n(809),$n=n(810),Kn=n(811),Jn=n(812),Qn=n(592),ea=n.n(Qn),ta={DATASET:"dataset",EMBEDDING_TYPE:"embeddingType",EMBEDDING_ZOOM:"embeddingZoom",EMBEDDING_ROTATION:"embeddingRotation",EMBEDDING_TARGET_X:"embeddingTargetX",EMBEDDING_TARGET_Y:"embeddingTargetY",EMBEDDING_TARGET_Z:"embeddingTargetZ",EMBEDDING_CELL_SET_POLYGONS_VISIBLE:"embeddingCellSetPolygonsVisible",EMBEDDING_CELL_SET_LABELS_VISIBLE:"embeddingCellSetLabelsVisible",EMBEDDING_CELL_SET_LABEL_SIZE:"embeddingCellSetLabelSize",EMBEDDING_CELL_RADIUS:"embeddingCellRadius",SPATIAL_ZOOM:"spatialZoom",SPATIAL_ROTATION:"spatialRotation",SPATIAL_TARGET_X:"spatialTargetX",SPATIAL_TARGET_Y:"spatialTargetY",SPATIAL_TARGET_Z:"spatialTargetZ",SPATIAL_ROTATION_X:"spatialRotationX",SPATIAL_ROTATION_Y:"spatialRotationY",SPATIAL_ROTATION_Z:"spatialRotationZ",SPATIAL_ROTATION_ORBIT:"spatialRotationOrbit",SPATIAL_ORBIT_AXIS:"spatialOrbitAxis",SPATIAL_AXIS_FIXED:"spatialAxisFixed",HEATMAP_ZOOM_X:"heatmapZoomX",HEATMAP_ZOOM_Y:"heatmapZoomY",HEATMAP_TARGET_X:"heatmapTargetX",HEATMAP_TARGET_Y:"heatmapTargetY",CELL_FILTER:"cellFilter",CELL_HIGHLIGHT:"cellHighlight",CELL_SET_SELECTION:"cellSetSelection",CELL_SET_HIGHLIGHT:"cellSetHighlight",CELL_SET_COLOR:"cellSetColor",GENE_FILTER:"geneFilter",GENE_HIGHLIGHT:"geneHighlight",GENE_SELECTION:"geneSelection",GENE_EXPRESSION_COLORMAP:"geneExpressionColormap",GENE_EXPRESSION_TRANSFORM:"geneExpressionTransform",GENE_EXPRESSION_COLORMAP_RANGE:"geneExpressionColormapRange",CELL_COLOR_ENCODING:"cellColorEncoding",SPATIAL_RASTER_LAYERS:"spatialRasterLayers",SPATIAL_CELLS_LAYER:"spatialCellsLayer",SPATIAL_MOLECULES_LAYER:"spatialMoleculesLayer",SPATIAL_NEIGHBORHOODS_LAYER:"spatialNeighborhoodsLayer",GENOMIC_ZOOM_X:"genomicZoomX",GENOMIC_ZOOM_Y:"genomicZoomY",GENOMIC_TARGET_X:"genomicTargetX",GENOMIC_TARGET_Y:"genomicTargetY",ADDITIONAL_CELL_SETS:"additionalCellSets",MOLECULE_HIGHLIGHT:"moleculeHighlight"},na=(Wn={},Object(B.a)(Wn,ta.EMBEDDING_ZOOM,null),Object(B.a)(Wn,ta.EMBEDDING_ROTATION,0),Object(B.a)(Wn,ta.EMBEDDING_TARGET_X,null),Object(B.a)(Wn,ta.EMBEDDING_TARGET_Y,null),Object(B.a)(Wn,ta.EMBEDDING_TARGET_Z,0),Object(B.a)(Wn,ta.EMBEDDING_CELL_SET_POLYGONS_VISIBLE,!1),Object(B.a)(Wn,ta.EMBEDDING_CELL_SET_LABELS_VISIBLE,!1),Object(B.a)(Wn,ta.EMBEDDING_CELL_SET_LABEL_SIZE,14),Object(B.a)(Wn,ta.EMBEDDING_CELL_RADIUS,1),Object(B.a)(Wn,ta.SPATIAL_ZOOM,null),Object(B.a)(Wn,ta.SPATIAL_ROTATION,0),Object(B.a)(Wn,ta.SPATIAL_TARGET_X,null),Object(B.a)(Wn,ta.SPATIAL_TARGET_Y,null),Object(B.a)(Wn,ta.SPATIAL_TARGET_Z,null),Object(B.a)(Wn,ta.SPATIAL_ROTATION_X,null),Object(B.a)(Wn,ta.SPATIAL_ROTATION_Y,null),Object(B.a)(Wn,ta.SPATIAL_ROTATION_Z,null),Object(B.a)(Wn,ta.SPATIAL_AXIS_FIXED,!1),Object(B.a)(Wn,ta.SPATIAL_ROTATION_ORBIT,0),Object(B.a)(Wn,ta.SPATIAL_ORBIT_AXIS,"Y"),Object(B.a)(Wn,ta.SPATIAL_RASTER_LAYERS,null),Object(B.a)(Wn,ta.SPATIAL_CELLS_LAYER,null),Object(B.a)(Wn,ta.SPATIAL_MOLECULES_LAYER,null),Object(B.a)(Wn,ta.SPATIAL_NEIGHBORHOODS_LAYER,null),Object(B.a)(Wn,ta.HEATMAP_ZOOM_X,0),Object(B.a)(Wn,ta.HEATMAP_ZOOM_Y,0),Object(B.a)(Wn,ta.HEATMAP_TARGET_X,0),Object(B.a)(Wn,ta.HEATMAP_TARGET_Y,0),Object(B.a)(Wn,ta.GENE_EXPRESSION_COLORMAP,"plasma"),Object(B.a)(Wn,ta.GENE_EXPRESSION_COLORMAP_RANGE,[0,1]),Object(B.a)(Wn,ta.GENE_EXPRESSION_TRANSFORM,null),Object(B.a)(Wn,ta.GENE_FILTER,null),Object(B.a)(Wn,ta.GENE_HIGHLIGHT,null),Object(B.a)(Wn,ta.GENE_SELECTION,null),Object(B.a)(Wn,ta.CELL_FILTER,null),Object(B.a)(Wn,ta.CELL_HIGHLIGHT,null),Object(B.a)(Wn,ta.CELL_SET_SELECTION,null),Object(B.a)(Wn,ta.CELL_SET_HIGHLIGHT,null),Object(B.a)(Wn,ta.CELL_SET_COLOR,null),Object(B.a)(Wn,ta.CELL_COLOR_ENCODING,"cellSetSelection"),Object(B.a)(Wn,ta.GENOMIC_ZOOM_X,0),Object(B.a)(Wn,ta.GENOMIC_ZOOM_Y,0),Object(B.a)(Wn,ta.GENOMIC_TARGET_X,1549999999.5),Object(B.a)(Wn,ta.GENOMIC_TARGET_Y,1549999999.5),Object(B.a)(Wn,ta.ADDITIONAL_CELL_SETS,null),Object(B.a)(Wn,ta.MOLECULE_HIGHLIGHT,null),Wn),aa=[ta.HEATMAP_ZOOM_X,ta.HEATMAP_ZOOM_Y,ta.HEATMAP_TARGET_X,ta.HEATMAP_TARGET_Y,ta.EMBEDDING_ZOOM,ta.EMBEDDING_TARGET_X,ta.EMBEDDING_TARGET_Y,ta.EMBEDDING_TARGET_Z,ta.EMBEDDING_CELL_SET_POLYGONS_VISIBLE,ta.EMBEDDING_CELL_SET_LABELS_VISIBLE,ta.EMBEDDING_CELL_SET_LABEL_SIZE,ta.EMBEDDING_CELL_RADIUS],ra={scatterplot:[ta.DATASET,ta.EMBEDDING_TYPE,ta.EMBEDDING_ZOOM,ta.EMBEDDING_ROTATION,ta.EMBEDDING_TARGET_X,ta.EMBEDDING_TARGET_Y,ta.EMBEDDING_TARGET_Z,ta.EMBEDDING_CELL_SET_POLYGONS_VISIBLE,ta.EMBEDDING_CELL_SET_LABELS_VISIBLE,ta.EMBEDDING_CELL_SET_LABEL_SIZE,ta.EMBEDDING_CELL_RADIUS,ta.CELL_FILTER,ta.CELL_HIGHLIGHT,ta.CELL_SET_SELECTION,ta.CELL_SET_HIGHLIGHT,ta.CELL_SET_COLOR,ta.GENE_HIGHLIGHT,ta.GENE_SELECTION,ta.GENE_EXPRESSION_COLORMAP,ta.GENE_EXPRESSION_COLORMAP_RANGE,ta.CELL_COLOR_ENCODING,ta.ADDITIONAL_CELL_SETS],spatial:[ta.DATASET,ta.SPATIAL_ZOOM,ta.SPATIAL_ROTATION,ta.SPATIAL_RASTER_LAYERS,ta.SPATIAL_CELLS_LAYER,ta.SPATIAL_MOLECULES_LAYER,ta.SPATIAL_NEIGHBORHOODS_LAYER,ta.SPATIAL_TARGET_X,ta.SPATIAL_TARGET_Y,ta.SPATIAL_TARGET_Z,ta.SPATIAL_ROTATION_X,ta.SPATIAL_ROTATION_Y,ta.SPATIAL_ROTATION_Z,ta.SPATIAL_ROTATION_ORBIT,ta.SPATIAL_ORBIT_AXIS,ta.SPATIAL_AXIS_FIXED,ta.CELL_FILTER,ta.CELL_HIGHLIGHT,ta.CELL_SET_SELECTION,ta.CELL_SET_HIGHLIGHT,ta.CELL_SET_COLOR,ta.GENE_HIGHLIGHT,ta.GENE_SELECTION,ta.GENE_EXPRESSION_COLORMAP,ta.GENE_EXPRESSION_COLORMAP_RANGE,ta.CELL_COLOR_ENCODING,ta.ADDITIONAL_CELL_SETS,ta.MOLECULE_HIGHLIGHT],heatmap:[ta.DATASET,ta.HEATMAP_ZOOM_X,ta.HEATMAP_ZOOM_Y,ta.HEATMAP_TARGET_X,ta.HEATMAP_TARGET_Y,ta.CELL_FILTER,ta.CELL_HIGHLIGHT,ta.CELL_SET_SELECTION,ta.CELL_SET_HIGHLIGHT,ta.CELL_SET_COLOR,ta.GENE_FILTER,ta.GENE_HIGHLIGHT,ta.GENE_SELECTION,ta.GENE_EXPRESSION_COLORMAP,ta.GENE_EXPRESSION_COLORMAP_RANGE,ta.CELL_COLOR_ENCODING,ta.ADDITIONAL_CELL_SETS],cellSets:[ta.DATASET,ta.CELL_SET_SELECTION,ta.CELL_SET_HIGHLIGHT,ta.CELL_SET_COLOR,ta.CELL_COLOR_ENCODING,ta.ADDITIONAL_CELL_SETS],cellSetSizes:[ta.DATASET,ta.CELL_SET_SELECTION,ta.CELL_SET_HIGHLIGHT,ta.CELL_SET_COLOR,ta.ADDITIONAL_CELL_SETS],cellSetExpression:[ta.DATASET,ta.GENE_SELECTION,ta.GENE_EXPRESSION_TRANSFORM,ta.CELL_SET_SELECTION,ta.CELL_SET_HIGHLIGHT,ta.CELL_SET_COLOR,ta.ADDITIONAL_CELL_SETS],status:[ta.DATASET,ta.CELL_HIGHLIGHT,ta.GENE_HIGHLIGHT,ta.CELL_SET_HIGHLIGHT,ta.MOLECULE_HIGHLIGHT],genes:[ta.DATASET,ta.GENE_FILTER,ta.GENE_HIGHLIGHT,ta.GENE_SELECTION,ta.CELL_COLOR_ENCODING],expressionHistogram:[ta.DATASET,ta.GENE_SELECTION],layerController:[ta.DATASET,ta.SPATIAL_RASTER_LAYERS,ta.SPATIAL_CELLS_LAYER,ta.SPATIAL_MOLECULES_LAYER,ta.SPATIAL_NEIGHBORHOODS_LAYER,ta.SPATIAL_ZOOM,ta.SPATIAL_TARGET_X,ta.SPATIAL_TARGET_Y,ta.SPATIAL_TARGET_Z,ta.SPATIAL_ROTATION_X,ta.SPATIAL_ROTATION_Y,ta.SPATIAL_ROTATION_Z,ta.SPATIAL_ROTATION_ORBIT,ta.SPATIAL_ORBIT_AXIS],higlass:[ta.DATASET,ta.GENOMIC_ZOOM_X,ta.GENOMIC_ZOOM_Y,ta.GENOMIC_TARGET_X,ta.GENOMIC_TARGET_Y,ta.GENE_FILTER,ta.GENE_HIGHLIGHT,ta.GENE_SELECTION],genomicProfiles:[ta.DATASET,ta.GENOMIC_ZOOM_X,ta.GENOMIC_ZOOM_Y,ta.GENOMIC_TARGET_X,ta.GENOMIC_TARGET_Y,ta.GENE_FILTER,ta.GENE_HIGHLIGHT,ta.GENE_SELECTION,ta.CELL_SET_SELECTION,ta.CELL_SET_HIGHLIGHT,ta.CELL_SET_COLOR,ta.ADDITIONAL_CELL_SETS],description:[ta.DATASET,ta.SPATIAL_RASTER_LAYERS]};function oa(e,t,n){var a,r=Object.keys(n["".concat(e,"Zoom")]),i=Object.keys(n["".concat(e,"TargetX")]),l=Object.keys(n["".concat(e,"TargetY")]),s=Y(r),c=Y(i),u=Y(l),p=t.zoom,d=Object(o.a)(t.target,2),m=d[0],f=d[1];return n["".concat(e,"Zoom")][s]=p,n["".concat(e,"TargetX")][c]=m,n["".concat(e,"TargetY")][u]=f,a={},Object(B.a)(a,"".concat(e,"Zoom"),s),Object(B.a)(a,"".concat(e,"TargetX"),c),Object(B.a)(a,"".concat(e,"TargetY"),u),a}var ia={"0.1.0":[(new te.a).compile(qn),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={embeddingType:{},embeddingZoom:{},embeddingTargetX:{},embeddingTargetY:{},spatialZoom:{},spatialTargetX:{},spatialTargetY:{}},a=[];e.staticLayout.forEach((function(e){var t,r=Object(s.a)({},e,{coordinationScopes:{}});if("scatterplot"===e.component&&(e.props.mapping&&(n.embeddingType[e.props.mapping]=e.props.mapping,r=Object(s.a)({},r,{coordinationScopes:Object(s.a)({},r.coordinationScopes,{embeddingType:e.props.mapping})})),e.props.view)){var o=oa("embedding",e.props.view,n);r=Object(s.a)({},r,{coordinationScopes:Object(s.a)({},r.coordinationScopes,{},o)})}if("spatial"===e.component&&(null===e||void 0===e||null===(t=e.props)||void 0===t?void 0:t.view)){var i=oa("spatial",e.props.view,n);r=Object(s.a)({},r,{coordinationScopes:Object(s.a)({},r.coordinationScopes,{},i)})}a.push(r)}));var r=t||ae()();return{version:"1.0.1",name:e.name,description:e.description,public:e.public,datasets:[{uid:r,name:r,files:e.layers.map((function(e){return{type:e.type.toLowerCase(),fileType:e.fileType,url:e.url}}))}],initStrategy:"auto",coordinationSpace:n,layout:a}}],"1.0.0":[(new te.a).addSchema(fe).addSchema(me).compile($n),function(e){var t=Object(s.a)({},e.coordinationSpace);function n(e){var n="raster"===e;t["spatial".concat(V(e),"Layer").concat(n?"s":"")]={},Object.entries(t.spatialLayers).forEach((function(a){var r=Object(o.a)(a,2),i=r[0],l=r[1];if(Array.isArray(l)&&l.find((function(t){return t.type===e}))){var c=l.filter((function(t){return t.type===e})).map((function(e){var t=Object(s.a)({},e);return delete t.type,t}));t["spatial".concat(V(e),"Layer").concat(n?"s":"")][i]=n?c:c[0]}else t["spatial".concat(V(e),"Layer").concat(n?"s":"")][i]=null}))}t.spatialLayers&&(n("raster"),n("cells"),n("molecules"),n("neighborhoods"),delete t.spatialLayers);var a=e.layout.map((function(e){var t=Object(s.a)({},e);function n(e){var n="raster"===e;ra[t.component].includes("spatial".concat(V(e),"Layer").concat(n?"s":""))&&(t.coordinationScopes["spatial".concat(V(e),"Layer").concat(n?"s":"")]=t.coordinationScopes.spatialLayers)}return t.coordinationScopes&&t.coordinationScopes.spatialLayers&&(n("raster"),n("cells"),n("molecules"),n("neighborhoods"),delete t.coordinationScopes.spatialLayers),t}));return Object(s.a)({},e,{coordinationSpace:t,layout:a,version:"1.0.1"})}],"1.0.1":[(new te.a).addSchema(fe).addSchema(me).compile(Kn),function(e){var t,n=e.layout.map((function(e){var t=Object(s.a)({},e);return"layerController"===t.component&&(t.props=Object(s.a)({},t.props,{globalDisable3d:!0})),t})),a=ea()(e);return Object.keys((null===a||void 0===a||null===(t=a.coordinationSpace)||void 0===t?void 0:t.spatialRasterLayers)||{}).forEach((function(e){a.coordinationSpace.spatialRasterLayers[e]&&a.coordinationSpace.spatialRasterLayers[e].forEach((function(t,n){a.coordinationSpace.spatialRasterLayers[e][n].type=["bitmask","raster"].includes(t.type)?t.type:"raster"}))})),Object(s.a)({},a,{layout:n,version:"1.0.2"})}],"1.0.2":[(new te.a).addSchema(fe).addSchema(me).compile(Jn),null]};function la(e){var t=e.onWarn,n=e.onConfigChange,a=e.onLoaderChange,r=e.validateOnConfigChange,o=Fn(),l=zn();return Object(i.useEffect)((function(){return An.subscribe((function(e){r&&e&&function(e){try{var t=ia["1.0.2"][0];if(!t(e)){var n=JSON.stringify(t.errors,null,2);throw new Error("Config validation failed: ".concat(n))}}catch(a){console.error(a)}}(e),n&&e&&n(e)}),(function(e){return e.viewConfig}))}),[n,r]),Object(i.useEffect)((function(){t&&o&&t(o)}),[o,t]),Object(i.useEffect)((function(){a&&l&&a(l)}),[l,a]),null}var sa=n(205),ca=n.n(sa);function ua(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}function pa(){var e=Object(i.useRef)(),t=Object(i.useState)(),n=Object(o.a)(t,2),a=n[0],r=n[1],l=Object(i.useState)(),s=Object(o.a)(l,2),c=s[0],u=s[1],p=Un(),d=Vn();return Object(i.useEffect)((function(){function e(){d()}var t=ca()(e,100,{trailing:!0});return window.addEventListener("resize",t),e(),function(){window.removeEventListener("resize",t)}}),[d]),Object(i.useEffect)((function(){if(e.current){var t=e.current.getBoundingClientRect();r(t.height),u(t.width)}}),[p]),[c,a,e]}function da(){var e=Object(i.useRef)(),t=Object(i.useState)(),n=Object(o.a)(t,2),a=n[0],r=n[1],l=Object(i.useState)(),s=Object(o.a)(l,2),c=s[0],u=s[1],p=Un(),d=Vn();return Object(i.useEffect)((function(){function e(){d()}var t=ca()(e,100,{trailing:!0});return window.addEventListener("resize",t),e(),function(){window.removeEventListener("resize",t)}}),[d]),Object(i.useEffect)((function(){if(e.current){var t=e.current.deck.canvas.getBoundingClientRect();r(t.height),u(t.width)}}),[p]),[c,a,e]}function ma(e){var t=e,n=Object(i.useState)(t),a=Object(o.a)(n,2),r=a[0],l=a[1],s=Object(i.useCallback)((function(e){l((function(t){var n=t.filter((function(t){return t!==e}));return console.log("cleared ".concat(e,"; waiting on ").concat(n.length,": ").concat(JSON.stringify(n))),n}))}),[l]),c=Object(i.useCallback)((function(){l(t),console.log("waiting on ".concat(t.length,": ").concat(JSON.stringify(t)))}),[l,t]);return[0===r.length,s,c]}function fa(){var e=Object(i.useState)([]),t=Object(o.a)(e,2),n=t[0],a=t[1];return[n,Object(i.useCallback)((function(e,t){e&&a((function(n){return[].concat(Object(c.a)(n),[{url:e,name:t}])}))}),[a]),Object(i.useCallback)((function(){a([])}),[a])]}var ha=n(175),ga=n.n(ha);function ba(e,t){t(e.message),console.warn(e.message),e instanceof oe&&e.warnInConsole()}function ya(e,t,n){e&&t&&Object.entries(e).forEach((function(e){var a=Object(o.a)(e,2),r=a[0],i=a[1],l="set".concat(V(r)),s=t[l],c=n&&n[r];ga()(c,na[r])&&s&&s(i)}))}function va(e,t,n,a,r,l,c){var u=Object(i.useState)({}),p=Object(o.a)(u,2),d=p[0],m=p[1],f=Object(i.useState)(0),h=Object(o.a)(f,2),g=h[0],b=h[1],y=Xn();return Object(i.useEffect)((function(){e[t]&&(e[t].loaders.cells?e[t].loaders.cells.load().catch((function(e){return ba(e,y)})).then((function(e){if(e){var t=e.data,r=e.url,o=e.coordinationValues;m(t),b(Object.keys(t).length),a(r,"Cells"),ya(Object(s.a)({spatialCellsLayer:tt},o),l,c),n("cells")}})):(m({}),b(0),r?ba(new se(t,"cells",null,null),y):n("cells")))}),[e,t]),[d,g]}function Oa(e,t,n,a,r,l,s){var c=Object(i.useState)(),u=Object(o.a)(c,2),p=u[0],d=u[1],m=Xn();return Object(i.useEffect)((function(){e[t]&&(e[t].loaders["cell-sets"]?e[t].loaders["cell-sets"].load().catch((function(e){return ba(e,m)})).then((function(e){if(e){var t=e.data,r=e.url,o=e.coordinationValues;d(t),a(r,"Cell Sets"),ya(o,l,s),n("cell-sets")}})):(d(null),r?ba(new se(t,"cell-sets",null,null),m):n("cell-sets")))}),[e,t]),[p]}function xa(e,t,n,a,r,l,s){var c=Object(i.useState)(),u=Object(o.a)(c,2),p=u[0],d=u[1],m=Xn();return Object(i.useEffect)((function(){e[t]&&(e[t].loaders["expression-matrix"]?e[t].loaders["expression-matrix"].load().catch((function(e){return ba(e,m)})).then((function(e){if(e){var t=e.data,r=e.url,i=e.coordinationValues,c=Object(o.a)(t,2),u=c[0],p=c[1];d({cols:u.cols,rows:u.rows,matrix:p.data}),a(r,"Expression Matrix"),ya(i,l,s),n("expression-matrix")}})):(d(null),r?ba(new se(t,"expression-matrix",null,null),m):n("expression-matrix")))}),[e,t]),[p]}function ja(e,t,n,a,r){var l=Object(i.useState)(),s=Object(o.a)(l,2),c=s[0],u=s[1],p=Xn();return Object(i.useEffect)((function(){if(e[t])if(r){var i=e[t].loaders["expression-matrix"];if(i)"function"===typeof i.loadGeneSelection?e[t].loaders["expression-matrix"].loadGeneSelection({selection:r}).catch((function(e){return ba(e,p)})).then((function(e){if(e){var t=e.data;u(t)}})):i.load().catch((function(e){return ba(e,p)})).then((function(e){if(e){var t=e.data,n=Object(o.a)(t,2),a=n[0],i=n[1].data,l=r.map((function(e){for(var t=a.cols.indexOf(e),n=a.cols.length,r=a.rows.length,o=new Uint8Array(r),l=0;l<r;l+=1)o[l]=i[l*n+t];return o}));u(l)}}));else u(null),a?ba(new se(t,"expression-matrix",null,null),p):n("expression-matrix")}else n("expression-matrix")}),[e,t,r]),[c]}function Ea(e,t,n,a,r){var l=Object(i.useState)(),s=Object(o.a)(l,2),c=s[0],u=s[1],p=Xn();return Object(i.useEffect)((function(){if(e[t]){var o=e[t].loaders["expression-matrix"];if(o)"function"===typeof o.loadAttrs?o.loadAttrs().catch((function(e){return ba(e,p)})).then((function(e){if(e){var t=e.data,r=e.url;u(t),a(r,"Expression Matrix"),n("expression-matrix")}})):o.load().catch((function(e){return ba(e,p)})).then((function(e){if(e){var t=e.data,r=e.url;u(t[0]),a(r,"Expression Matrix"),n("expression-matrix")}}));else u(null),r?ba(new se(t,"expression-matrix",null,null),p):n("expression-matrix")}}),[e,t]),[c]}function Ca(e,t,n,a,r,l,c){var u=Object(i.useState)(),p=Object(o.a)(u,2),d=p[0],m=p[1],f=Object(i.useState)(0),h=Object(o.a)(f,2),g=h[0],b=h[1],y=Object(i.useState)(0),v=Object(o.a)(y,2),O=v[0],x=v[1],j=Xn();return Object(i.useEffect)((function(){e[t]&&(e[t].loaders.molecules?e[t].loaders.molecules.load().catch((function(e){return ba(e,j)})).then((function(e){if(e){var t=e.data,r=e.url,o=e.coordinationValues;m(t),b(Object.keys(t).length),x(Object.values(t).map((function(e){return e.length})).reduce((function(e,t){return e+t}),0)),a(r,"Molecules"),ya(Object(s.a)({spatialMoleculesLayer:et},o),l,c),n("molecules")}})):(m({}),b(0),x(0),r?ba(new se(t,"molecules",null,null),j):n("molecules")))}),[e,t]),[d,g,O]}function Sa(e,t,n,a,r,l,s){var c=Object(i.useState)(),u=Object(o.a)(c,2),p=u[0],d=u[1],m=Object(i.useState)([]),f=Object(o.a)(m,2),h=f[0],g=f[1],b=Object(i.useState)([]),y=Object(o.a)(b,2),v=y[0],O=y[1],x=Xn();return Object(i.useEffect)((function(){e[t]&&(e[t].loaders.raster?e[t].loaders.raster.load().catch((function(e){return ba(e,x)})).then((function(e){if(e){var t=e.data,r=e.url,i=e.coordinationValues;d(t),r.forEach((function(e){var t=Object(o.a)(e,2),n=t[0],r=t[1];a(n,r)}));var c=t.loaders,u=t.meta;g(c),O(u),ya(i,l,s),n("raster")}})):(g([]),O([]),r?ba(new se(t,"raster",null,null),x):n("raster")))}),[e,t]),[p,h,v]}var wa=n(815),La=n.n(wa),Ta=n(1450),Aa=n(1324),ka=n(1414),_a=n(604),Ia=n.n(_a),Pa=n(603),Na=n.n(Pa),Ra=n(814),Ma=n.n(Ra),Da=n(816),za=n.n(Da),Ga=n(1409);function Ha(){return l.a.createElement("div",{className:"loading-indicator-backdrop"},l.a.createElement("div",{className:"loading-indicator-container"},l.a.createElement(Ga.a,null)))}var Fa=n(1412),Xa=n(1411),Ba=n(1452),Za=n(1413);function Ua(e){var t=M(),n=e.anchorEl,a=e.open,r=e.placement,o=void 0===r?"bottom-start":r,i=e.children;return l.a.createElement(Xa.a,{className:t.popper,open:a,anchorEl:n.current,placement:o},i)}function Va(e){var t=e.children,n=M();return l.a.createElement(Fa.a,{className:n.paper,elevation:4},t)}function Ya(e){var t=e.children,n=M();return l.a.createElement("span",{className:n.span},t)}function Wa(e){var t=e.buttonIcon,n=e.open,a=e.toggle,r=e.children,o=e.placement,s=e.buttonClassName,c=Object(i.useRef)(null),u=M();return l.a.createElement(l.a.Fragment,null,l.a.createElement(Aa.a,{onClick:a,size:"small",ref:c,className:s},t),l.a.createElement(Ua,{className:u.popper,open:n,anchorEl:c,placement:o},l.a.createElement(Va,null,l.a.createElement(Za.a,{onClickAway:a},l.a.createElement(Ba.a,null,r)))))}var qa=Object(P.a)((function(e){return{iconButton:{border:"none",marginLeft:0,background:"none",color:e.palette.primaryForeground,paddingLeft:"0.25em",paddingRight:"0.25em",borderRadius:"2px","&:hover":{backgroundColor:e.palette.primaryBackgroundLight},"&:first-child":{marginLeft:"0.75em"},"&:last-child":{marginRight:"0.25em"},"& svg":{width:"0.7em",height:"0.7em",verticalAlign:"middle"}},downloadLink:{color:e.palette.primaryForeground}}}));function $a(e){var t=e.open;return l.a.createElement(l.a.Fragment,null,l.a.createElement(Ma.a,null),t?l.a.createElement(Na.a,null):l.a.createElement(Ia.a,null))}function Ka(e){var t=e.options,n=Object(i.useReducer)((function(e){return!e}),!1),a=Object(o.a)(n,2),r=a[0],s=a[1],c=qa();return l.a.createElement(Wa,{open:r,toggle:s,buttonIcon:l.a.createElement($a,{open:r}),buttonClassName:c.iconButton,placement:"bottom-end"},t)}function Ja(e){var t=e.open;return l.a.createElement(l.a.Fragment,null,l.a.createElement(La.a,null),t?l.a.createElement(Na.a,null):l.a.createElement(Ia.a,null))}function Qa(e){var t=e.urls,n=Object(i.useReducer)((function(e){return!e}),!1),a=Object(o.a)(n,2),r=a[0],s=a[1],c=qa();return l.a.createElement(Wa,{open:r,toggle:s,buttonIcon:l.a.createElement(Ja,{open:r}),buttonClassName:c.iconButton,placement:"bottom-end"},t.map((function(e){var t=e.url,n=e.name;return l.a.createElement(Ta.a,{dense:!0,key:t},l.a.createElement(ka.a,{underline:"none",href:t,target:"_blank",rel:"noopener",className:c.downloadLink},"Download ",n))})))}function er(e){var t=e.removeGridComponent,n=qa();return l.a.createElement(Aa.a,{onClick:t,size:"small",className:n.iconButton,title:"close"},l.a.createElement(za.a,null))}function tr(e){var t=e.title,n=e.info,a=e.children,r=e.isScroll,o=e.isSpatial,i=e.removeGridComponent,s=e.urls,c=e.isReady,u=e.options,p=r?w:o?S:C;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"title d-flex justify-content-between align-items-baseline"},l.a.createElement("div",{className:"justify-content-between d-flex align-items-end"},l.a.createElement("span",null,t)),l.a.createElement("span",{className:"details pl-2 align-items-end"},l.a.createElement("span",{className:"d-flex justify-content-between"},n,u&&l.a.createElement(Ka,{options:u}),s&&s.length>0&&l.a.createElement(Qa,{urls:s}),l.a.createElement(er,{removeGridComponent:i})))),l.a.createElement("div",{className:p},!c&&l.a.createElement(Ha,null),a))}function nr(e){var t=e.description,n=e.metadata;return l.a.createElement("div",{className:"description"},l.a.createElement("p",null,t),n&&Array.from(n.entries()).map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1],r=a.name,i=a.metadata;return i&&Object.entries(i).length>0?l.a.createElement("details",{key:n},l.a.createElement("summary",null,r),l.a.createElement("div",{className:"metadata-container"},l.a.createElement("table",null,l.a.createElement("tbody",null,Object.entries(i).map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return l.a.createElement("tr",{key:n},l.a.createElement("th",{title:n},n),l.a.createElement("td",{title:a},a))})))))):null})))}var ar=["raster"];function rr(e){var t=e.info,n=e.warn,a=[];return t&&a.push(l.a.createElement("p",{className:"details",key:"info"},t)),n&&a.push(l.a.createElement("p",{className:"alert alert-warning my-0 details",key:"warn"},n)),a}var or=n(611),ir=n(819),lr=n.n(ir),sr=n(820),cr=n.n(sr);function ur(e){var t=e.hasColorEncoding,n=e.columns,a=e.data,r=e.onChange,s=e.idKey,c=void 0===s?"id":s,u=e.valueKey,p=void 0===u?"value":u,d=e.allowMultiple,m=void 0!==d&&d,f=e.allowUncheck,h=void 0!==f&&f,g=e.showTableHead,b=void 0===g||g,y=e.showTableInputs,v=void 0!==y&&y,O=e.testHeight,x=void 0===O?void 0:O,j=e.testWidth,E=void 0===j?void 0:j,C=Object(i.useState)(null),S=Object(o.a)(C,2),w=S[0],L=S[1],T=Object(i.useCallback)((function(e,t){(t||h)&&L(m?t?lr()(w||[],[e]):cr()(w||[],[e]):t?[e]:[])}),[m,h,w]),A=Object(i.useCallback)((function(e){var t=e.target,n=t.checked,a=t.value;T(a,n)}),[T]),k=Object(i.useCallback)((function(e){return e.map((function(e){var t;return t={},Object(B.a)(t,c,e),Object(B.a)(t,"data",a.find((function(t){return t[c]===e}))),t}))}),[a,c]),_=Object(i.useCallback)((function(e){return Array.isArray(w)&&w.includes(e)}),[w]);Object(i.useEffect)((function(){var e=a.map((function(e){return e[p]?e[c]:null})).filter(Boolean);I()(e,w)||(e.length>0?L(e):L(null))}),[a,c,p]),Object(i.useEffect)((function(){if(r&&w){var e=k(w);m?r(e):1===w.length?r(e[0]):0===w.length&&r(null)}}),[w]);var P=ae()(),N=v?"":"hidden-input-column",R=function(e){var r=e.index,o=e.style;return l.a.createElement("div",{key:a[r][c],className:"table-item table-row ".concat(_(a[r][c])?"row-checked ":""),style:o,role:"button",onClick:function(){return T(a[r][c],!_(a[r][c])||!t)}},l.a.createElement("div",{className:"input-container ".concat(N," table-cell")},l.a.createElement("label",{htmlFor:"".concat(P,"_").concat(a[r][c])},l.a.createElement("input",{id:"".concat(P,"_").concat(a[r][c]),type:"checkbox",className:m?"checkbox":"radio",name:P,value:a[r][c],onChange:A,checked:_(a[r][c])}))),n.map((function(e){return l.a.createElement("div",{className:"table-cell",key:e},a[r][e])})))},M=function(e){var t=e.style;return l.a.createElement("div",{className:"".concat(N," table-row"),style:t},n.map((function(e){return l.a.createElement("div",{key:e},e)})))};return l.a.createElement("div",{className:"selectable-table"},l.a.createElement(or.a,null,(function(e){var t=e.width,n=e.height;return l.a.createElement(or.b,{height:x||n,gridStyle:{outline:"none"},rowCount:a.length,rowHeight:24,headerHeight:b?24:void 0,rowRenderer:R,width:E||t,headerRowRenderer:b?M:void 0,rowGetter:function(e){var t=e.index;return a[t]}})})))}function pr(e){var t=e.hasColorEncoding,n=e.geneList,a=void 0===n?[]:n,r=e.geneSelection,s=void 0===r?[]:r,c=e.geneFilter,u=void 0===c?null:c,p=e.setGeneSelection,d=Object(i.useState)(""),m=Object(o.a)(d,2),f=m[0],h=m[1],g=Object(i.useState)(a),b=Object(o.a)(g,2),y=b[0],v=b[1];Object(i.useEffect)((function(){var e=a.filter((function(e){return e.toLowerCase().includes(f.toLowerCase())}));v(e)}),[f,a]);var O=y.filter((function(e){return!u||u.includes(e)})).sort((function(e,t){return e.localeCompare(t)})).map((function(e){return{name:e,value:!!s&&s.includes(e)}}));return l.a.createElement(l.a.Fragment,null,l.a.createElement("input",{className:"search-bar",type:"text",placeholder:"Search",value:f,onChange:function(e){h(e.target.value)}}),l.a.createElement(ur,{columns:["name"],data:O,hasColorEncoding:t,idKey:"name",valueKey:"value",onChange:function(e){p&&e&&e.name&&p([e.name])},allowUncheck:!1,showTableHead:!1}))}var dr=["expression-matrix"];var mr=n(210),fr=n(484),hr=n(78),gr=n.n(hr),br=l.a.forwardRef((function(e,t){var n,a=e.prefixCls,r=e.className,o=e.showIcon,i=e.blockNode,s=e.children,c=e.checkable;return l.a.createElement(fr.b,Object.assign({itemHeight:32,ref:t},e,{className:gr()(r,(n={},Object(B.a)(n,"".concat(a,"-icon-hide"),!o),Object(B.a)(n,"".concat(a,"-block-node"),i),n)),checkable:c?l.a.createElement("span",{className:"".concat(a,"-checkbox-inner")}):c}),s)}));br.defaultProps={virtual:!1,checkable:!1,showIcon:!1,blockNode:!0,prefixCls:"rc-tree"};var yr=br,vr=n(209),Or=n(27),xr=n(64),jr=n(821),Er=n(847);function Cr(e){var t=e.title,n=e.content,a=e.overlayClassName,r=Object(i.useRef)(),o=Object(i.useCallback)((function(){return r.current?r.current.closest(".vitessce-container"):null}),[r]),s=t||n;return l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{ref:r}),l.a.createElement(Er.a,Object.assign({getTooltipContainer:o,overlayClassName:a,overlay:s},e)))}function Sr(e){return l.a.createElement(Cr,e)}function wr(e){var t=e.title,n=e.subtitle,a=e.onClick,r=e.handler,s=e.handlerKey,c=e.confirm,u=e.visible,p=Object(i.useState)(!1),d=Object(o.a)(p,2),m=d[0],f=d[1];function h(){!c||m?(a(),r()):f(!0)}Object(i.useEffect)((function(){f(!1)}),[u]);var g="".concat(m?"Confirm ":"").concat(t);return l.a.createElement("button",{title:g,type:"button",onClick:h,onKeyPress:function(e){return Mt(e,s,h)}},g,n&&l.a.createElement(l.a.Fragment,null,l.a.createElement("br",null),l.a.createElement("span",{className:"small"},n)))}function Lr(e){var t=e.menuConfig,n=e.onClick,a=e.color,r=void 0===a?null:a,o=e.palette,i=void 0===o?null:o,s=e.setColor,c=void 0===s?null:s,u=e.visible;var p=i?i.map(Dt):Ze.concat([[255,255,255],[128,128,128],[0,0,0]]).map(Dt);return l.a.createElement("div",null,r&&c&&p&&l.a.createElement(jr.TwitterPicker,{className:"popover-menu-color",disableAlpha:!0,width:108,triangle:"hide",colors:p,color:Dt(r),onChangeComplete:function(e){var t=e.rgb;t&&c&&c([t.r,t.g,t.b])}}),l.a.createElement("ul",{className:"popover-menu-list"},t.map((function(e){return l.a.createElement("li",{key:e.title+e.subtitle},l.a.createElement(wr,Object.assign({},e,{onClick:n,visible:u})))}))))}function Tr(e){var t=e.menuConfig,n=e.placement,a=e.children,r=e.color,s=void 0===r?null:r,c=e.setColor,u=void 0===c?null:c,p=e.palette,d=void 0===p?null:p,m=Object(i.useState)(!1),f=Object(o.a)(m,2),h=f[0],g=f[1];return l.a.createElement(Sr,{content:l.a.createElement(Lr,{menuConfig:t,onClick:function(){return g(!1)},color:s,setColor:u,palette:d,visible:h}),placement:n,visible:h,onVisibleChange:g},a)}function Ar(){return(Ar=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function kr(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}Cr.defaultProps={overlayClassName:"help-tooltip",placement:"top",trigger:"hover",mouseEnterDelay:.2,mouseLeaveDelay:0},Sr.defaultProps={overlayClassName:"popover",placement:"top",trigger:"click",mouseEnterDelay:0,mouseLeaveDelay:0};var _r=i.createElement("path",{d:"M12 18c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3zm0-9c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3zm0-9c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3z"});function Ir(e){var t=e.svgRef,n=e.title,a=e.titleId,r=kr(e,["svgRef","title","titleId"]);return i.createElement("svg",Ar({width:24,height:24,viewBox:"0 0 24 24",ref:t,"aria-labelledby":a},r),n?i.createElement("title",{id:a},n):null,_r)}var Pr=i.forwardRef((function(e,t){return i.createElement(Ir,Ar({svgRef:t},e))}));n.p;function Nr(e){var t=e.path,n=e.level,a=e.height,r=e.onCheckNode,o=e.onNodeRemove,i=e.onNodeSetIsEditing,l=e.onExportLevelZeroNodeJSON,s=e.onExportLevelZeroNodeTabular,u=e.onExportSetJSON,p=e.checkable,d=e.editable,m=e.exportable,f=e.checked;return[].concat(Object(c.a)(d?[{title:"Rename",handler:function(){i(t,!0)},handlerKey:"r"},{title:"Delete",confirm:!0,handler:function(){o(t)},handlerKey:"d"}]:[]),Object(c.a)(0===n&&m?[{title:"Export hierarchy",subtitle:"(to JSON file)",handler:function(){l(t)},handlerKey:"j"}].concat(Object(c.a)(a<=1?[{title:"Export hierarchy",subtitle:"(to CSV file)",handler:function(){s(t)},handlerKey:"t"}]:[])):[]),Object(c.a)(n>0?[].concat(Object(c.a)(p?[{title:f?"Uncheck":"Check",handler:function(){r(t,!f)},handlerKey:"s"}]:[]),Object(c.a)(m?[{title:"Export set",subtitle:"(to JSON file)",handler:function(){u(t)},handlerKey:"e"}]:[])):[]))}function Rr(e){var t,n=e.title,a=e.path,r=e.nodeKey,o=e.level,i=e.height,s=e.color,c=e.checkbox,u=e.isChecking,p=e.isLeaf,d=e.onNodeSetColor,m=e.onNodeView,f=e.expanded,h=e.onCheckLevel,g=e.checkedLevelPath,b=e.checkedLevelIndex,y=e.disableTooltip,v=e.size,O=e.datatype,x=e.editable,j=0===o&&!f,E=b&&I()(a,g)&&b<i?b+1:1,C=new Intl.NumberFormat("en-US").format(v);t=j?Gt(E):p||!f?"Color individual set (".concat(C," ").concat(O).concat(1===v?"":"s",")"):"Color by expanded descendants";var S=0!==o||f?function(){return m(a)}:function(){return h(r,E)},w=y?{visible:!1}:{},L=Nr(e);return l.a.createElement("span",null,l.a.createElement(Cr,Object.assign({title:t},w),l.a.createElement("button",{type:"button",onClick:S,onKeyPress:function(e){return Mt(e,"v",(function(){return m(a)}))},className:"title-button"},n)),L.length>0?l.a.createElement(Tr,{menuConfig:Nr(e),color:o>0&&x?s||Be:null,setColor:function(e){return d(a,e)}},l.a.createElement(Pr,{className:"node-menu-icon"})):null,o>0&&u?c:null,o>0&&l.a.createElement("span",{className:"node-size-label"},C))}function Mr(e){var t=e.title,n=e.path,a=e.onNodeSetName,r=e.onNodeCheckNewName,s=Object(i.useState)(t),c=Object(o.a)(s,2),u=c[0],p=c[1],d=r(n,u);function m(){d||a(n,u,!0)}return l.a.createElement("span",{className:"title-button-with-input"},l.a.createElement("input",{autoFocus:!0,className:"title-input",type:"text",value:u,onChange:function(e){p(e.target.value)},onKeyPress:function(e){return Mt(e,"Enter",m)},onFocus:function(e){return e.target.select()}}),!d&&l.a.createElement("button",{type:"button",className:"title-save-button",onClick:m},"Save"))}function Dr(e){var t=e.isEditing,n=e.isCurrentSet;return t||n?l.a.createElement(Mr,e):l.a.createElement(Rr,e)}function zr(e){var t=e.nodeKey,n=e.path,a=e.height,r=e.onCheckLevel,o=e.checkedLevelPath,i=e.checkedLevelIndex,s=e.hasColorEncoding;function c(e){if(e.target.checked){var n=parseInt(e.target.value,10);r(t,n)}}return l.a.createElement("div",{className:"level-buttons-container"},ke()(1,a+1).map((function(e){var t=I()(n,o)&&e===i;return l.a.createElement("div",{className:"level-buttons",key:e},l.a.createElement(Cr,{title:Gt(e)},l.a.createElement("input",{className:Object(Or.a)("level-radio-button",{checked:t&&!s}),type:"checkbox",value:e,checked:t&&s,onChange:c})))})))}function Gr(e){var t=e.isLeaf,n=e.isOpen,a=e.color,r=a?Dt(a):void 0;return t?l.a.createElement("i",{className:"anticon anticon-circle rc-tree-switcher-icon"},l.a.createElement("svg",{viewBox:"0 0 1024 1024",focusable:"false","data-icon":"caret-down",width:"1em",height:"1em","aria-hidden":"true"},l.a.createElement("rect",{fill:r,x:300,y:300,width:424,height:424}))):l.a.createElement("i",{className:"anticon anticon-caret-down rc-tree-switcher-icon"},l.a.createElement("svg",{viewBox:"0 0 1024 1024",focusable:"false","data-icon":"caret-down",width:"1em",height:"1em","aria-hidden":"true"},l.a.createElement("path",{fill:n?"#444":r,d:"M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z"})))}var Hr=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){var e;Object(z.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).renderSelector=function(){var t=e.props,n=t.title,a=t.isCurrentSet,r=t.isSelected,o=t.isEditing,i=t.onDragStart,s=e.context.rcTree,c=s.prefixCls,u=s.draggable,p="".concat(c,"-node-content-wrapper"),d=!a&&!o&&u;return l.a.createElement("span",{ref:e.setSelectHandle,title:n,className:gr()(p,"".concat(p,"-").concat(e.getNodeState()||"normal"),r&&"".concat(c,"-node-selected"),d&&"draggable"),draggable:d,"aria-grabbed":d,onDragStart:d?function(t){i(),e.onDragStart(t)}:void 0},l.a.createElement(Dr,Object.assign({},e.props,{prefixClass:c,checkbox:e.renderCheckbox()})),e.renderLevels())},e.renderLevels=function(){var t=e.props,n=t.level,a=t.expanded;return 0!==n||a?null:l.a.createElement(zr,e.props)},e.renderSwitcher=function(){var t=e.props,n=t.expanded,a=t.isLeaf,r=t.color,o=e.context.rcTree,i=o.prefixCls,s=o.onNodeExpand,c=function(t){a||s(t,Object(xe.a)(e))},u=gr()("".concat(i,"-switcher"),Object(B.a)({},"".concat(i,"-switcher_").concat(n?"open":"close"),!a));return l.a.createElement("span",{className:u,onClick:c,onKeyPress:function(e){return Mt(e,"d",c)},role:"button",tabIndex:"0"},l.a.createElement(Gr,{isLeaf:a,isOpen:n,color:r}))},e}return Object(G.a)(n,[{key:"render",value:function(){var e,t=this,n=this.props,a=n.style,r=n.loading,o=n.level,i=n.dragOver,s=n.dragOverGapTop,c=n.dragOverGapBottom,u=n.isLeaf,p=n.expanded,d=n.selected,m=n.checked,f=n.halfChecked,h=n.onDragEnd,g=n.expandable,b=Object(vr.a)(n,["style","loading","level","dragOver","dragOverGapTop","dragOverGapBottom","isLeaf","expanded","selected","checked","halfChecked","onDragEnd","expandable"]),y=this.context.rcTree,v=y.prefixCls,O=y.filterTreeNode,x=y.draggable,j=this.isDisabled(),E=Object(xr.i)(b);return l.a.createElement("li",Object.assign({className:gr()("rc-tree-treenode","level-".concat(o,"-treenode"),(e={},Object(B.a)(e,"".concat(v,"-treenode-disabled"),j),Object(B.a)(e,"".concat(v,"-treenode-switcher-").concat(p?"open":"close"),!u),Object(B.a)(e,"".concat(v,"-treenode-checkbox-checked"),m),Object(B.a)(e,"".concat(v,"-treenode-checkbox-indeterminate"),f),Object(B.a)(e,"".concat(v,"-treenode-selected"),d),Object(B.a)(e,"".concat(v,"-treenode-loading"),r),Object(B.a)(e,"drag-over",!j&&i),Object(B.a)(e,"drag-over-gap-top",!j&&s),Object(B.a)(e,"drag-over-gap-bottom",!j&&c),Object(B.a)(e,"filter-node",O&&O(this)),e)),style:a,role:"treeitem",onDragEnter:x?this.onDragEnter:void 0,onDragOver:x?this.onDragOver:void 0,onDragLeave:x?this.onDragLeave:void 0,onDrop:x?this.onDrop.bind(this):void 0,onDragEnd:x?function(e){h(),t.onDragEnd(e)}:void 0},E),g?this.renderSwitcher():null,this.renderSelector(),this.renderChildren())}}]),n}(fr.a);function Fr(){return(Fr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Xr(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Br(e){var t=e.svgRef,n=e.title,a=e.titleId,r=Xr(e,["svgRef","title","titleId"]);return i.createElement("svg",Fr({viewBox:"0 0 16.433999 10.234",height:12,width:18,ref:t,"aria-labelledby":a},r),n?i.createElement("title",{id:a},n):null,i.createElement("g",{transform:"translate(0.117,-2.883)"},i.createElement("path",{d:"m 11.467471,11.811278 c 0.198237,-0.322177 0.508,-1.011333 0.653661,-1.454255 0.659343,-2.0049141 0.44323,-4.2620847 -0.577734,-6.0340822 l -0.168844,-0.2930481 0.105744,0.017887 c 0.759902,0.1285441 1.368762,0.3699553 1.856675,0.7361658 1.988296,1.4923476 2.192477,4.3353549 0.434717,6.0529895 -0.641216,0.626581 -1.299647,0.94683 -2.294136,1.115833 l -0.108488,0.01844 z M 4.3162122,11.919169 C 1.9278944,11.487872 0.46692382,9.0323123 1.234873,6.7401372 1.5621727,5.763213 2.2610593,4.9489746 3.1840041,4.4693005 3.5978035,4.2542401 3.9427842,4.145371 4.5197023,4.0477802 L 4.6254464,4.0298927 4.4571836,4.3223069 C 3.4332707,6.1017061 3.2180432,8.3476022 3.878868,10.357023 c 0.1458466,0.443487 0.4554716,1.132155 0.6542959,1.455285 0.054471,0.08853 0.087814,0.159599 0.074096,0.157937 -0.013718,-0.0017 -0.1446898,-0.02465 -0.2910477,-0.05108 z M 5.0000001,3 C 2.2,3 0,5.2 0,8 c 0,2.8 2.2,5 5.0000001,5 0.6,0 1.1,-0.1 1.6,-0.3 C 5.3000001,11.6 4.5,9.7999998 4.5,8 4.5,6.2 5.3000001,4.5 6.6000001,3.3 c -0.5,-0.2 -1,-0.3 -1.6,-0.3 z M 4.65,4.02 C 3.92,5.17 3.51,6.54 3.51,8 c 0,1.4599998 0.42,2.83 1.14,3.98 C 2.61,11.8 1.01,10.08 1.01,8 1.01,5.92 2.61,4.2 4.65,4.02 Z M 8,4 C 6.8,4.9 6,6.4 6,8 6,9.6 6.8,11.1 8,12 9.2,11.1 10,9.7 10,8 10,6.3 9.2,4.9 8,4 Z m 3,-1 c 2.8,0 5,2.2 5,5 0,2.8 -2.2,5 -5,5 C 10.4,13 9.9,12.9 9.4,12.7 10.7,11.6 11.5,9.8 11.5,8 11.5,6.2 10.7,4.5 9.4,3.3 9.9,3.1 10.4,3 11,3 Z m 0.35,1.02 c 0.73,1.15 1.14,2.52 1.14,3.98 0,1.46 -0.42,2.83 -1.14,3.98 2.04,-0.18 3.64,-1.9 3.64,-3.98 0,-2.08 -1.6,-3.8 -3.64,-3.98 z",style:{strokeWidth:.234,strokeMiterlimit:4,strokeDasharray:"none",strokeOpacity:1}})))}var Zr=i.forwardRef((function(e,t){return i.createElement(Br,Fr({svgRef:t},e))}));n.p;function Ur(){return(Ur=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Vr(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Yr(e){var t=e.svgRef,n=e.title,a=e.titleId,r=Vr(e,["svgRef","title","titleId"]);return i.createElement("svg",Ur({width:18,height:12,viewBox:"0 0 16 10",ref:t,"aria-labelledby":a},r),n?i.createElement("title",{id:a},n):null,i.createElement("g",{transform:"translate(0,-3)"},i.createElement("path",{d:"M 5.0000001,3 C 2.2,3 0,5.2 0,8 c 0,2.8 2.2,5 5.0000001,5 0.6,0 1.1,-0.1 1.6,-0.3 C 5.3000001,11.6 4.5,9.7999998 4.5,8 4.5,6.2 5.3000001,4.5 6.6000001,3.3 c -0.5,-0.2 -1,-0.3 -1.6,-0.3 z M 4.65,4.02 C 3.92,5.17 3.51,6.54 3.51,8 c 0,1.4599998 0.42,2.83 1.14,3.98 C 2.61,11.8 1.01,10.08 1.01,8 1.01,5.92 2.61,4.2 4.65,4.02 Z M 8,4 C 6.8,4.9 6,6.4 6,8 6,9.6 6.8,11.1 8,12 9.2,11.1 10,9.7 10,8 10,6.3 9.2,4.9 8,4 Z m 3,-1 c 2.8,0 5,2.2 5,5 0,2.8 -2.2,5 -5,5 C 10.4,13 9.9,12.9 9.4,12.7 10.7,11.6 11.5,9.8 11.5,8 11.5,6.2 10.7,4.5 9.4,3.3 9.9,3.1 10.4,3 11,3 Z m 0.35,1.02 c 0.73,1.15 1.14,2.52 1.14,3.98 0,1.46 -0.42,2.83 -1.14,3.98 2.04,-0.18 3.64,-1.9 3.64,-3.98 0,-2.08 -1.6,-3.8 -3.64,-3.98 z",style:{strokeWidth:.234,strokeMiterlimit:4,strokeDasharray:"none",strokeOpacity:1}})))}var Wr=i.forwardRef((function(e,t){return i.createElement(Yr,Ur({svgRef:t},e))}));n.p;function qr(){return(qr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function $r(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Kr=i.createElement("rect",{x:"5%",width:"90%",height:"100%",fill:"white"}),Jr=i.createElement("g",null,i.createElement("rect",{x:0,y:0,width:25.3804963846,height:16,mask:"url(#union-mask)"}));function Qr(e){var t=e.svgRef,n=e.title,a=e.titleId,r=$r(e,["svgRef","title","titleId"]);return i.createElement("svg",qr({id:"svg14",viewBox:"0 0 25.3804963846 16",height:16,width:25.3804963846,ref:t,"aria-labelledby":a},r),n?i.createElement("title",{id:a},n):null,i.createElement("defs",null,i.createElement("mask",{id:"union-mask",x:0,y:0,width:25.3804963846,height:16},Kr,i.createElement("g",{transform:"translate(4.69,0)"},i.createElement("path",{d:"m 11.467471,11.811278 c 0.198237,-0.322177 0.508,-1.011333 0.653661,-1.454255 0.659343,-2.0049141 0.44323,-4.2620847 -0.577734,-6.0340822 l -0.168844,-0.2930481 0.105744,0.017887 c 0.759902,0.1285441 1.368762,0.3699553 1.856675,0.7361658 1.988296,1.4923476 2.192477,4.3353549 0.434717,6.0529895 -0.641216,0.626581 -1.299647,0.94683 -2.294136,1.115833 l -0.108488,0.01844 z M 4.3162122,11.919169 C 1.9278944,11.487872 0.46692382,9.0323123 1.234873,6.7401372 1.5621727,5.763213 2.2610593,4.9489746 3.1840041,4.4693005 3.5978035,4.2542401 3.9427842,4.145371 4.5197023,4.0477802 L 4.6254464,4.0298927 4.4571836,4.3223069 C 3.4332707,6.1017061 3.2180432,8.3476022 3.878868,10.357023 c 0.1458466,0.443487 0.4554716,1.132155 0.6542959,1.455285 0.054471,0.08853 0.087814,0.159599 0.074096,0.157937 -0.013718,-0.0017 -0.1446898,-0.02465 -0.2910477,-0.05108 z M 5.0000001,3 C 2.2,3 0,5.2 0,8 c 0,2.8 2.2,5 5.0000001,5 0.6,0 1.1,-0.1 1.6,-0.3 C 5.3000001,11.6 4.5,9.7999998 4.5,8 4.5,6.2 5.3000001,4.5 6.6000001,3.3 c -0.5,-0.2 -1,-0.3 -1.6,-0.3 z M 4.65,4.02 C 3.92,5.17 3.51,6.54 3.51,8 c 0,1.4599998 0.42,2.83 1.14,3.98 C 2.61,11.8 1.01,10.08 1.01,8 1.01,5.92 2.61,4.2 4.65,4.02 Z M 8,4 C 6.8,4.9 6,6.4 6,8 6,9.6 6.8,11.1 8,12 9.2,11.1 10,9.7 10,8 10,6.3 9.2,4.9 8,4 Z m 3,-1 c 2.8,0 5,2.2 5,5 0,2.8 -2.2,5 -5,5 C 10.4,13 9.9,12.9 9.4,12.7 10.7,11.6 11.5,9.8 11.5,8 11.5,6.2 10.7,4.5 9.4,3.3 9.9,3.1 10.4,3 11,3 Z m 0.35,1.02 c 0.73,1.15 1.14,2.52 1.14,3.98 0,1.46 -0.42,2.83 -1.14,3.98 2.04,-0.18 3.64,-1.9 3.64,-3.98 0,-2.08 -1.6,-3.8 -3.64,-3.98 z",style:{strokeWidth:.234,strokeMiterlimit:4,strokeDasharray:"none",strokeOpacity:1},fill:"black"})))),Jr)}var eo=i.forwardRef((function(e,t){return i.createElement(Qr,qr({svgRef:t},e))}));n.p;function to(e){var t=e.datatype,n=e.onError,a=e.onImportTree,r=e.onCreateLevelZeroNode,o=e.importable,s=e.editable,u=Object(i.useCallback)((function(e,r){return function(){var o=document.createElement("input");o.setAttribute("type","file"),o.setAttribute("accept",r),document.body.appendChild(o),o.click(),o.addEventListener("change",(function(r){if(window.File&&window.FileReader&&window.FileList&&window.Blob){var o=r.target.files;if(o&&1===o.length){var i=new FileReader;i.addEventListener("load",(function(){var r=i.result;try{var o=e(r,t);n(!1),a(o)}catch(l){n(l.message)}}),!1),i.readAsText(o[0])}else n("Incorrect number of files selected.")}else n("Local file reading APIs are not fully supported in this browser.")})),o.remove()}}),[t,n,a]),p=[].concat(Object(c.a)(s?[{title:"Create hierarchy",handler:r,handlerKey:"n"}]:[]),Object(c.a)(o?[{title:"Import hierarchy",subtitle:"(from CSV file)",handler:u(mn,"text/csv"),handlerKey:"c"},{title:"Import hierarchy",subtitle:"(from JSON file)",handler:u(dn,"application/json"),handlerKey:"j"}]:[]));return p.length>0?l.a.createElement(Tr,{menuConfig:p},l.a.createElement("button",{className:"plus-button",type:"submit"},"+")):null}function no(e){var t=e.onUnion,n=e.onIntersection,a=e.onComplement,r=e.operatable,o=e.hasCheckedSetsToUnion,i=e.hasCheckedSetsToIntersect,s=e.hasCheckedSetsToComplement;return l.a.createElement(l.a.Fragment,null,r&&l.a.createElement(l.a.Fragment,null,l.a.createElement("button",{onClick:t,title:"New set from union of checked sets",type:"submit",disabled:!o},l.a.createElement(Zr,null)),l.a.createElement("button",{onClick:n,title:"New set from intersection of checked sets",type:"submit",disabled:!i},l.a.createElement(Wr,null)),l.a.createElement("button",{onClick:a,title:"New set from complement of checked sets",type:"submit",disabled:!s},l.a.createElement(eo,null))))}function ao(e,t){return Object(s.a)({},e,{tree:e?e.tree.map((function(e){return function e(t,n,a){var r,o=[].concat(Object(c.a)(n),[t.name]);return Object(s.a)({},t,{},t.children?{children:t.children.map((function(t){return e(t,o,a)}))}:{},{color:(null===a||void 0===a||null===(r=a.find((function(e){return I()(e.path,o)})))||void 0===r?void 0:r.color)||Be})}(e,[],t)})):[]})}function ro(e){var t=e.sets,n=e.additionalSets,a=e.setColor,r=e.levelSelection,s=e.setSelection,u=e.setExpansion,p=e.hasColorEncoding,d=e.datatype,m=e.draggable,f=void 0===m||m,h=e.checkable,g=void 0===h||h,b=e.editable,y=void 0===b||b,v=e.expandable,O=void 0===v||v,x=e.operatable,j=void 0===x||x,E=e.exportable,C=void 0===E||E,S=e.importable,w=void 0===S||S,L=e.onError,T=e.onCheckNode,A=e.onExpandNode,k=e.onDropNode,_=e.onCheckLevel,P=e.onNodeSetColor,N=e.onNodeSetName,R=e.onNodeCheckNewName,M=e.onNodeRemove,D=e.onNodeView,z=e.onImportTree,G=e.onCreateLevelZeroNode,H=e.onExportLevelZeroNodeJSON,F=e.onExportLevelZeroNodeTabular,X=e.onExportSetJSON,B=e.onUnion,Z=e.onIntersection,U=e.onComplement,V=e.hasCheckedSetsToUnion,Y=e.hasCheckedSetsToIntersect,W=e.hasCheckedSetsToComplement,q=Object(i.useState)(!1),$=Object(o.a)(q,2),K=$[0],J=$[1],Q=Object(i.useState)(null),ee=Object(o.a)(Q,2),te=ee[0],ne=ee[1],ae=Object(i.useMemo)((function(){return ao(t,a)}),[t,a]),re=Object(i.useMemo)((function(){return ao(n,a)}),[n,a]),oe=re?re.tree.flatMap((function(e){return function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t)return null;var a=[].concat(Object(c.a)(n),[t.name]);return t.children?[Xt(a)].concat(Object(c.a)(t.children.flatMap((function(t){return e(t,a)})))):Xt(a)}(e,[])})):[],ie=(s||[]).map(Xt),le=(u||[]).map(Xt),se=ie.filter((function(e){return!oe.includes(e)})),ce=le.filter((function(e){return!oe.includes(e)})),ue=ie.filter((function(e){return oe.includes(e)})),pe=le.filter((function(e){return oe.includes(e)}));function de(e,t,n){return e?e.map((function(e){var o=[].concat(Object(c.a)(n),[e.name]);return l.a.createElement(Hr,Object.assign({key:Xt(o)},function(e,t,n){var a,r=t.length-1;return{title:e.name,nodeKey:Xt(t),path:t,size:Wt(e).length,color:null===n||void 0===n||null===(a=n.find((function(e){return I()(e.path,t)})))||void 0===a?void 0:a.color,level:r,isLeaf:(!e.children||0===e.children.length)&&Boolean(e.set),height:qt(e)}}(e,o,a),{isEditing:I()(te,o),datatype:d,draggable:f&&!t,editable:y&&!t,checkable:g,expandable:O,exportable:C,hasColorEncoding:p,isChecking:!0,checkedLevelPath:r?r.levelZeroPath:null,checkedLevelIndex:r?r.levelIndex:null,onCheckNode:T,onCheckLevel:_,onNodeView:D,onNodeSetColor:P,onNodeSetName:function(e,t){N(e,t),ne(null)},onNodeCheckNewName:R,onNodeSetIsEditing:ne,onNodeRemove:M,onExportLevelZeroNodeJSON:H,onExportLevelZeroNodeTabular:F,onExportSetJSON:X,disableTooltip:K,onDragStart:function(){return J(!0)},onDragEnd:function(){return J(!1)}}),de(e.children,t,o))})):null}return l.a.createElement("div",{className:"sets-manager"},l.a.createElement("div",{className:"sets-manager-tree"},l.a.createElement(yr,{draggable:!1,checkable:g,checkedKeys:se,expandedKeys:ce,autoExpandParent:!0,onCheck:function(e,t){return T(t.node.props.nodeKey,t.checked)},onExpand:function(e,t){return A(e,t.node.props.nodeKey,t.expanded)}},de(ae.tree,!0,[])),l.a.createElement(yr,{draggable:!0,checkable:g,checkedKeys:ue,expandedKeys:pe,autoExpandParent:!0,onCheck:function(e,t){return T(t.node.props.nodeKey,t.checked)},onExpand:function(e,t){return A(e,t.node.props.nodeKey,t.expanded)},onDrop:function(e){var t=e.node.props.eventKey,n=e.dragNode.props.eventKey,a=e.dropToGap,r=e.dropPosition;k(t,n,r,a)}},de(re.tree,!1,[])),l.a.createElement(to,{datatype:d,onError:L,onImportTree:z,onCreateLevelZeroNode:G,importable:w,editable:y})),l.a.createElement("div",{className:"set-operation-buttons"},l.a.createElement(no,{onUnion:B,onIntersection:Z,onComplement:U,operatable:j,hasCheckedSetsToUnion:V,hasCheckedSetsToIntersect:Y,hasCheckedSetsToComplement:W})))}var oo=["cells","cell-sets"];var io,lo=n(114),so=n.n(lo);(io=function(e){var t=e.length-1;return function(n){var a=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[a],o=e[a+1],i=a>0?e[a-1]:2*r-o,l=a<t-1?e[a+2]:2*o-r;return function(e,t,n,a,r){var o=e*e,i=o*e;return((1-3*e+3*o-i)*t+(4-6*o+3*i)*n+(1+3*e+3*o-3*i)*a+i*r)/6}((n-a/t)*t,i,r,o,l)}},function(e){var t,n,a=e.length,r=new Array(a),o=new Array(a),i=new Array(a);for(t=0;t<a;++t)n=[e[t][0],e[t][1],e[t][2]],r[t]=n[0]||0,o[t]=n[1]||0,i[t]=n[2]||0;return r=io(r),o=io(o),i=io(i),function(e){return[r(e),o(e),i(e)]}})([[103,0,31],[178,24,43],[214,96,77],[244,165,130],[253,219,199],[247,247,247],[209,229,240],[146,197,222],[67,147,195],[33,102,172],[5,48,97]]);var co=function(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}([[13,8,135],[16,7,136],[19,7,137],[22,7,138],[25,6,140],[27,6,141],[29,6,142],[32,6,143],[34,6,144],[36,6,145],[38,5,145],[40,5,146],[42,5,147],[44,5,148],[46,5,149],[47,5,150],[49,5,151],[51,5,151],[53,4,152],[55,4,153],[56,4,154],[58,4,154],[60,4,155],[62,4,156],[63,4,156],[65,4,157],[67,3,158],[68,3,158],[70,3,159],[72,3,159],[73,3,160],[75,3,161],[76,2,161],[78,2,162],[80,2,162],[81,2,163],[83,2,163],[85,2,164],[86,1,164],[88,1,164],[89,1,165],[91,1,165],[92,1,166],[94,1,166],[96,1,166],[97,0,167],[99,0,167],[100,0,167],[102,0,167],[103,0,168],[105,0,168],[106,0,168],[108,0,168],[110,0,168],[111,0,168],[113,0,168],[114,1,168],[116,1,168],[117,1,168],[119,1,168],[120,1,168],[122,2,168],[123,2,168],[125,3,168],[126,3,168],[128,4,168],[129,4,167],[131,5,167],[132,5,167],[134,6,166],[135,7,166],[136,8,166],[138,9,165],[139,10,165],[141,11,165],[142,12,164],[143,13,164],[145,14,163],[146,15,163],[148,16,162],[149,17,161],[150,19,161],[152,20,160],[153,21,159],[154,22,159],[156,23,158],[157,24,157],[158,25,157],[160,26,156],[161,27,155],[162,29,154],[163,30,154],[165,31,153],[166,32,152],[167,33,151],[168,34,150],[170,35,149],[171,36,148],[172,38,148],[173,39,147],[174,40,146],[176,41,145],[177,42,144],[178,43,143],[179,44,142],[180,46,141],[181,47,140],[182,48,139],[183,49,138],[184,50,137],[186,51,136],[187,52,136],[188,53,135],[189,55,134],[190,56,133],[191,57,132],[192,58,131],[193,59,130],[194,60,129],[195,61,128],[196,62,127],[197,64,126],[198,65,125],[199,66,124],[200,67,123],[201,68,122],[202,69,122],[203,70,121],[204,71,120],[204,73,119],[205,74,118],[206,75,117],[207,76,116],[208,77,115],[209,78,114],[210,79,113],[211,81,113],[212,82,112],[213,83,111],[213,84,110],[214,85,109],[215,86,108],[216,87,107],[217,88,106],[218,90,106],[218,91,105],[219,92,104],[220,93,103],[221,94,102],[222,95,101],[222,97,100],[223,98,99],[224,99,99],[225,100,98],[226,101,97],[226,102,96],[227,104,95],[228,105,94],[229,106,93],[229,107,93],[230,108,92],[231,110,91],[231,111,90],[232,112,89],[233,113,88],[233,114,87],[234,116,87],[235,117,86],[235,118,85],[236,119,84],[237,121,83],[237,122,82],[238,123,81],[239,124,81],[239,126,80],[240,127,79],[240,128,78],[241,129,77],[241,131,76],[242,132,75],[243,133,75],[243,135,74],[244,136,73],[244,137,72],[245,139,71],[245,140,70],[246,141,69],[246,143,68],[247,144,68],[247,145,67],[247,147,66],[248,148,65],[248,149,64],[249,151,63],[249,152,62],[249,154,62],[250,155,61],[250,156,60],[250,158,59],[251,159,58],[251,161,57],[251,162,56],[252,163,56],[252,165,55],[252,166,54],[252,168,53],[252,169,52],[253,171,51],[253,172,51],[253,174,50],[253,175,49],[253,177,48],[253,178,47],[253,180,47],[253,181,46],[254,183,45],[254,184,44],[254,186,44],[254,187,43],[254,189,42],[254,190,42],[254,192,41],[253,194,41],[253,195,40],[253,197,39],[253,198,39],[253,200,39],[253,202,38],[253,203,38],[252,205,37],[252,206,37],[252,208,37],[252,210,37],[251,211,36],[251,213,36],[251,215,36],[250,216,36],[250,218,36],[249,220,36],[249,221,37],[248,223,37],[248,225,37],[247,226,37],[247,228,37],[246,230,38],[246,232,38],[245,233,38],[245,235,39],[244,237,39],[243,238,39],[243,240,39],[242,242,39],[241,244,38],[241,245,37],[240,247,36],[240,249,33]]);function uo(e){var t=e.cellColorEncoding,n=e.expressionData,a=e.cellSets,r=e.cellSetSelection,i=e.cellSetColor,l=e.expressionDataAttrs;if("geneSelection"===t&&n&&l){for(var s=co,u=new Map,p=0;p<n.length;p+=1){var d=s(n[p]/255);u.set(l.rows[p],d)}return u}return"cellSetSelection"===t&&r&&a?function(e,t,n){var a=[];return t.forEach((function(t){var r=$t(e,t);if(r){var i,l=Wt(r),s=(null===n||void 0===n||null===(i=n.find((function(e){return I()(e.path,t)})))||void 0===i?void 0:i.color)||Be;a=[].concat(Object(c.a)(a),Object(c.a)(l.map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return[n,_t()(a)?s:rn(s,a)]}))))}})),new Map(a)}(a,r,i):new Map}var po,mo=n(699),fo=n(772),ho=n(612),go=n(591),bo=n(1446),yo=n(824),vo=n.n(yo),Oo=n(825),xo=n.n(Oo),jo=n(826),Eo=n.n(jo),Co=n(354),So=n.n(Co),wo=n(196),Lo=n(225),To=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"handleClick",value:function(e,t){t.onEdit({editType:"clearFeatures"})}}]),n}(Lo.DrawRectangleMode),Ao=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"handleClick",value:function(e,t){t.onEdit({editType:"clearFeatures"})}}]),n}(Lo.DrawPolygonByDraggingMode),ko=(po={},Object(B.a)(po,wo.SELECTION_TYPE.RECTANGLE,To),Object(B.a)(po,wo.SELECTION_TYPE.POLYGON,Ao),po),_o={selectionType:wo.SELECTION_TYPE.RECTANGLE,layerIds:[],onSelect:function(){}},Io={type:"FeatureCollection",features:[]},Po=["lineWidthScale","lineWidthMinPixels","lineWidthMaxPixels","lineWidthUnits","lineJointRounded","lineMiterLimit","pointRadiusScale","pointRadiusMinPixels","pointRadiusMaxPixels","lineDashJustified","getLineColor","getFillColor","getRadius","getLineWidth","getLineDashArray","getTentativeLineDashArray","getTentativeLineColor","getTentativeFillColor","getTentativeLineWidth","editHandlePointRadiusScale","editHandlePointRadiusMinPixels","editHandlePointRadiusMaxPixels","getEditHandlePointColor","getEditHandlePointRadius","modeHandlers"],No=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"_selectPolygonObjects",value:function(e){var t=this.props,n=t.onSelect,a=t.getCellCoords,r=t.cellsQuadTree,o=t.flipY?e.map((function(e){return e.map((function(e){return[e[0],-e[1]]}))})):e,i=Object(Bt.polygon)(o),l=[];r.visit((function(e,t,n,r,o){var s=[[[t,n],[r,n],[r,o],[t,o],[t,n]]],c=Object(Bt.polygon)(s),u=xo()(c,i),p=vo()(c,i),d=Eo()(c,i);return!(u||p||d)||(e.data&&So()(Object(Bt.point)(a(e.data[1])),i)&&l.push(e.data),!1)})),n({pickingInfos:l})}},{key:"renderLayers",value:function(){var e=this,t=this.props.onSelect,n=ko[this.props.selectionType]||Lo.ViewMode,a={};return Po.forEach((function(t){void 0!==e.props[t]&&(a[t]=e.props[t])})),[new wo.EditableGeoJsonLayer(this.getSubLayerProps(Object(s.a)({id:"selection-geojson",pickable:!0,mode:n,modeConfig:{dragToDraw:!0},selectedFeatureIndexes:[],data:Io,onEdit:function(n){var a=n.updatedData,r=n.editType;if("addFeature"===r){var o=a.features[0].geometry.coordinates;e._selectPolygonObjects(o)}else"clearFeatures"===r&&t({pickingInfos:[]})}},a)))]}}]),n}(go.a);function Ro(e){return"base-".concat(e)}function Mo(e,t,n,a,r,o){var i=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(!e)return[];var l=Ro(n),s=5/(t+16);return[new No({id:"selection",flipY:i,cellsQuadTree:o,getCellCoords:a,coordinateSystem:ze.a.CARTESIAN,selectionType:e,onSelect:function(e){var t=e.pickingInfos.map((function(e){return e[0]}));r&&r(t)},layerIds:[l],getTentativeFillColor:function(){return[255,255,255,95]},getTentativeLineColor:function(){return[143,143,143,255]},getTentativeLineDashArray:function(){return[7,4]},lineWidthMinPixels:2,lineWidthMaxPixels:2,getEditHandlePointColor:function(){return[255,255,255,255]},getEditHandlePointRadius:function(){return s},editHandlePointRadiusScale:1,editHandlePointRadiusMinPixels:s,editHandlePointRadiusMaxPixels:2*s})]}function Do(e){var t,n=e.id,a=e.getColor,r=e.data,o=e.isSelected,i=Object(vr.a)(e,["id","getColor","data","isSelected"]);return{overlay:Object(s.a)({id:(t=n,"selected-".concat(t)),getFillColor:a,getLineColor:a,data:r,getFilterValue:o,extensions:[new bo.a({filterSize:1})],filterRange:[1,1]},i),base:Object(s.a)({id:Ro(n),getLineColor:a,getFillColor:a,data:r.slice()},i)}}No.layerName="SelectionLayer",No.defaultProps=_o;var zo=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"renderLayers",value:function(){var e=Do(this.props);return[new mo.a(e.base),new mo.a(e.overlay)]}}]),n}(go.a);zo.layerName="SelectablePolygonLayer";var Go=n(433),Ho=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"renderLayers",value:function(){var e=Do(this.props);return[new Go.a(e.base),new Go.a(e.overlay)]}}]),n}(go.a);Ho.layerName="SelectableScatterplotLayer";var Fo,Xo=n(423),Bo=n(771),Zo={dark:[224,224,224],light:[64,64,64]},Uo="-apple-system, 'Helvetica Neue', Arial, sans-serif",Vo=(Fo={},Object(B.a)(Fo,at.default.TEXTURE_MIN_FILTER,at.default.NEAREST),Object(B.a)(Fo,at.default.TEXTURE_MAG_FILTER,at.default.NEAREST),Object(B.a)(Fo,at.default.TEXTURE_WRAP_S,at.default.CLAMP_TO_EDGE),Object(B.a)(Fo,at.default.TEXTURE_WRAP_T,at.default.CLAMP_TO_EDGE),Fo),Yo=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"_getShaders",value:function(e){var t=this;return this.props.extensions.forEach((function(n){e=Object(Xo.a)(e,n.getShaders.call(t,n))})),e}},{key:"updateState",value:function(e){Object(Se.a)(Object(Ce.a)(n.prototype),"updateState",this).call(this,e),this.loadTexture(this.props.image)}},{key:"getShaders",value:function(){var e=this.props.colormap;return this._getShaders({vs:"\n#define SHADER_NAME heatmap-bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:"\n#define SHADER_NAME heatmap-bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nvec4 rdbu (float x_354677415) {\n  const float e0 = 0.0;\n  const vec4 v0 = vec4(0.0196078431372549,0.0392156862745098,0.6745098039215687,1);\n  const float e1 = 0.35;\n  const vec4 v1 = vec4(0.41568627450980394,0.5372549019607843,0.9686274509803922,1);\n  const float e2 = 0.5;\n  const vec4 v2 = vec4(0.7450980392156863,0.7450980392156863,0.7450980392156863,1);\n  const float e3 = 0.6;\n  const vec4 v3 = vec4(0.8627450980392157,0.6666666666666666,0.5176470588235295,1);\n  const float e4 = 0.7;\n  const vec4 v4 = vec4(0.9019607843137255,0.5686274509803921,0.35294117647058826,1);\n  const float e5 = 1.0;\n  const vec4 v5 = vec4(0.6980392156862745,0.0392156862745098,0.10980392156862745,1);\n  float a0 = smoothstep(e0,e1,x_354677415);\n  float a1 = smoothstep(e1,e2,x_354677415);\n  float a2 = smoothstep(e2,e3,x_354677415);\n  float a3 = smoothstep(e3,e4,x_354677415);\n  float a4 = smoothstep(e4,e5,x_354677415);\n  return max(mix(v0,v1,a0)*step(e0,x_354677415)*step(x_354677415,e1),\n    max(mix(v1,v2,a1)*step(e1,x_354677415)*step(x_354677415,e2),\n    max(mix(v2,v3,a2)*step(e2,x_354677415)*step(x_354677415,e3),\n    max(mix(v3,v4,a3)*step(e3,x_354677415)*step(x_354677415,e4),mix(v4,v5,a4)*step(e4,x_354677415)*step(x_354677415,e5)\n  ))));\n}\n\nvec4 jet (float x_3419531890) {\n  const float e0 = 0.0;\n  const vec4 v0 = vec4(0,0,0.5137254901960784,1);\n  const float e1 = 0.125;\n  const vec4 v1 = vec4(0,0.23529411764705882,0.6666666666666666,1);\n  const float e2 = 0.375;\n  const vec4 v2 = vec4(0.0196078431372549,1,1,1);\n  const float e3 = 0.625;\n  const vec4 v3 = vec4(1,1,0,1);\n  const float e4 = 0.875;\n  const vec4 v4 = vec4(0.9803921568627451,0,0,1);\n  const float e5 = 1.0;\n  const vec4 v5 = vec4(0.5019607843137255,0,0,1);\n  float a0 = smoothstep(e0,e1,x_3419531890);\n  float a1 = smoothstep(e1,e2,x_3419531890);\n  float a2 = smoothstep(e2,e3,x_3419531890);\n  float a3 = smoothstep(e3,e4,x_3419531890);\n  float a4 = smoothstep(e4,e5,x_3419531890);\n  return max(mix(v0,v1,a0)*step(e0,x_3419531890)*step(x_3419531890,e1),\n    max(mix(v1,v2,a1)*step(e1,x_3419531890)*step(x_3419531890,e2),\n    max(mix(v2,v3,a2)*step(e2,x_3419531890)*step(x_3419531890,e3),\n    max(mix(v3,v4,a3)*step(e3,x_3419531890)*step(x_3419531890,e4),mix(v4,v5,a4)*step(e4,x_3419531890)*step(x_3419531890,e5)\n  ))));\n}\n\nvec4 viridis (float x_98747489) {\n  const float e0 = 0.0;\n  const vec4 v0 = vec4(0.26666666666666666,0.00392156862745098,0.32941176470588235,1);\n  const float e1 = 0.13;\n  const vec4 v1 = vec4(0.2784313725490196,0.17254901960784313,0.47843137254901963,1);\n  const float e2 = 0.25;\n  const vec4 v2 = vec4(0.23137254901960785,0.3176470588235294,0.5450980392156862,1);\n  const float e3 = 0.38;\n  const vec4 v3 = vec4(0.17254901960784313,0.44313725490196076,0.5568627450980392,1);\n  const float e4 = 0.5;\n  const vec4 v4 = vec4(0.12941176470588237,0.5647058823529412,0.5529411764705883,1);\n  const float e5 = 0.63;\n  const vec4 v5 = vec4(0.15294117647058825,0.6784313725490196,0.5058823529411764,1);\n  const float e6 = 0.75;\n  const vec4 v6 = vec4(0.3607843137254902,0.7843137254901961,0.38823529411764707,1);\n  const float e7 = 0.88;\n  const vec4 v7 = vec4(0.6666666666666666,0.8627450980392157,0.19607843137254902,1);\n  const float e8 = 1.0;\n  const vec4 v8 = vec4(0.9921568627450981,0.9058823529411765,0.1450980392156863,1);\n  float a0 = smoothstep(e0,e1,x_98747489);\n  float a1 = smoothstep(e1,e2,x_98747489);\n  float a2 = smoothstep(e2,e3,x_98747489);\n  float a3 = smoothstep(e3,e4,x_98747489);\n  float a4 = smoothstep(e4,e5,x_98747489);\n  float a5 = smoothstep(e5,e6,x_98747489);\n  float a6 = smoothstep(e6,e7,x_98747489);\n  float a7 = smoothstep(e7,e8,x_98747489);\n  return max(mix(v0,v1,a0)*step(e0,x_98747489)*step(x_98747489,e1),\n    max(mix(v1,v2,a1)*step(e1,x_98747489)*step(x_98747489,e2),\n    max(mix(v2,v3,a2)*step(e2,x_98747489)*step(x_98747489,e3),\n    max(mix(v3,v4,a3)*step(e3,x_98747489)*step(x_98747489,e4),\n    max(mix(v4,v5,a4)*step(e4,x_98747489)*step(x_98747489,e5),\n    max(mix(v5,v6,a5)*step(e5,x_98747489)*step(x_98747489,e6),\n    max(mix(v6,v7,a6)*step(e6,x_98747489)*step(x_98747489,e7),mix(v7,v8,a7)*step(e7,x_98747489)*step(x_98747489,e8)\n  )))))));\n}\n\nvec4 inferno (float x_2396186301) {\n  const float e0 = 0.0;\n  const vec4 v0 = vec4(0,0,0.01568627450980392,1);\n  const float e1 = 0.13;\n  const vec4 v1 = vec4(0.12156862745098039,0.047058823529411764,0.2823529411764706,1);\n  const float e2 = 0.25;\n  const vec4 v2 = vec4(0.3333333333333333,0.058823529411764705,0.42745098039215684,1);\n  const float e3 = 0.38;\n  const vec4 v3 = vec4(0.5333333333333333,0.13333333333333333,0.41568627450980394,1);\n  const float e4 = 0.5;\n  const vec4 v4 = vec4(0.7294117647058823,0.21176470588235294,0.3333333333333333,1);\n  const float e5 = 0.63;\n  const vec4 v5 = vec4(0.8901960784313725,0.34901960784313724,0.2,1);\n  const float e6 = 0.75;\n  const vec4 v6 = vec4(0.9764705882352941,0.5490196078431373,0.0392156862745098,1);\n  const float e7 = 0.88;\n  const vec4 v7 = vec4(0.9764705882352941,0.788235294117647,0.19607843137254902,1);\n  const float e8 = 1.0;\n  const vec4 v8 = vec4(0.9882352941176471,1,0.6431372549019608,1);\n  float a0 = smoothstep(e0,e1,x_2396186301);\n  float a1 = smoothstep(e1,e2,x_2396186301);\n  float a2 = smoothstep(e2,e3,x_2396186301);\n  float a3 = smoothstep(e3,e4,x_2396186301);\n  float a4 = smoothstep(e4,e5,x_2396186301);\n  float a5 = smoothstep(e5,e6,x_2396186301);\n  float a6 = smoothstep(e6,e7,x_2396186301);\n  float a7 = smoothstep(e7,e8,x_2396186301);\n  return max(mix(v0,v1,a0)*step(e0,x_2396186301)*step(x_2396186301,e1),\n    max(mix(v1,v2,a1)*step(e1,x_2396186301)*step(x_2396186301,e2),\n    max(mix(v2,v3,a2)*step(e2,x_2396186301)*step(x_2396186301,e3),\n    max(mix(v3,v4,a3)*step(e3,x_2396186301)*step(x_2396186301,e4),\n    max(mix(v4,v5,a4)*step(e4,x_2396186301)*step(x_2396186301,e5),\n    max(mix(v5,v6,a5)*step(e5,x_2396186301)*step(x_2396186301,e6),\n    max(mix(v6,v7,a6)*step(e6,x_2396186301)*step(x_2396186301,e7),mix(v7,v8,a7)*step(e7,x_2396186301)*step(x_2396186301,e8)\n  )))))));\n}\n\nvec4 magma (float x_4140671788) {\n  const float e0 = 0.0;\n  const vec4 v0 = vec4(0,0,0.01568627450980392,1);\n  const float e1 = 0.13;\n  const vec4 v1 = vec4(0.10980392156862745,0.06274509803921569,0.26666666666666666,1);\n  const float e2 = 0.25;\n  const vec4 v2 = vec4(0.30980392156862746,0.07058823529411765,0.4823529411764706,1);\n  const float e3 = 0.38;\n  const vec4 v3 = vec4(0.5058823529411764,0.1450980392156863,0.5058823529411764,1);\n  const float e4 = 0.5;\n  const vec4 v4 = vec4(0.7098039215686275,0.21176470588235294,0.47843137254901963,1);\n  const float e5 = 0.63;\n  const vec4 v5 = vec4(0.8980392156862745,0.3137254901960784,0.39215686274509803,1);\n  const float e6 = 0.75;\n  const vec4 v6 = vec4(0.984313725490196,0.5294117647058824,0.3803921568627451,1);\n  const float e7 = 0.88;\n  const vec4 v7 = vec4(0.996078431372549,0.7607843137254902,0.5294117647058824,1);\n  const float e8 = 1.0;\n  const vec4 v8 = vec4(0.9882352941176471,0.9921568627450981,0.7490196078431373,1);\n  float a0 = smoothstep(e0,e1,x_4140671788);\n  float a1 = smoothstep(e1,e2,x_4140671788);\n  float a2 = smoothstep(e2,e3,x_4140671788);\n  float a3 = smoothstep(e3,e4,x_4140671788);\n  float a4 = smoothstep(e4,e5,x_4140671788);\n  float a5 = smoothstep(e5,e6,x_4140671788);\n  float a6 = smoothstep(e6,e7,x_4140671788);\n  float a7 = smoothstep(e7,e8,x_4140671788);\n  return max(mix(v0,v1,a0)*step(e0,x_4140671788)*step(x_4140671788,e1),\n    max(mix(v1,v2,a1)*step(e1,x_4140671788)*step(x_4140671788,e2),\n    max(mix(v2,v3,a2)*step(e2,x_4140671788)*step(x_4140671788,e3),\n    max(mix(v3,v4,a3)*step(e3,x_4140671788)*step(x_4140671788,e4),\n    max(mix(v4,v5,a4)*step(e4,x_4140671788)*step(x_4140671788,e5),\n    max(mix(v5,v6,a5)*step(e5,x_4140671788)*step(x_4140671788,e6),\n    max(mix(v6,v7,a6)*step(e6,x_4140671788)*step(x_4140671788,e7),mix(v7,v8,a7)*step(e7,x_4140671788)*step(x_4140671788,e8)\n  )))))));\n}\n\nvec4 plasma (float x_1580529385) {\n  const float e0 = 0.0;\n  const vec4 v0 = vec4(0.050980392156862744,0.03137254901960784,0.5294117647058824,1);\n  const float e1 = 0.13;\n  const vec4 v1 = vec4(0.29411764705882354,0.011764705882352941,0.6313725490196078,1);\n  const float e2 = 0.25;\n  const vec4 v2 = vec4(0.49019607843137253,0.011764705882352941,0.6588235294117647,1);\n  const float e3 = 0.38;\n  const vec4 v3 = vec4(0.6588235294117647,0.13333333333333333,0.5882352941176471,1);\n  const float e4 = 0.5;\n  const vec4 v4 = vec4(0.796078431372549,0.27450980392156865,0.4745098039215686,1);\n  const float e5 = 0.63;\n  const vec4 v5 = vec4(0.8980392156862745,0.4196078431372549,0.36470588235294116,1);\n  const float e6 = 0.75;\n  const vec4 v6 = vec4(0.9725490196078431,0.5803921568627451,0.2549019607843137,1);\n  const float e7 = 0.88;\n  const vec4 v7 = vec4(0.9921568627450981,0.7647058823529411,0.1568627450980392,1);\n  const float e8 = 1.0;\n  const vec4 v8 = vec4(0.9411764705882353,0.9764705882352941,0.12941176470588237,1);\n  float a0 = smoothstep(e0,e1,x_1580529385);\n  float a1 = smoothstep(e1,e2,x_1580529385);\n  float a2 = smoothstep(e2,e3,x_1580529385);\n  float a3 = smoothstep(e3,e4,x_1580529385);\n  float a4 = smoothstep(e4,e5,x_1580529385);\n  float a5 = smoothstep(e5,e6,x_1580529385);\n  float a6 = smoothstep(e6,e7,x_1580529385);\n  float a7 = smoothstep(e7,e8,x_1580529385);\n  return max(mix(v0,v1,a0)*step(e0,x_1580529385)*step(x_1580529385,e1),\n    max(mix(v1,v2,a1)*step(e1,x_1580529385)*step(x_1580529385,e2),\n    max(mix(v2,v3,a2)*step(e2,x_1580529385)*step(x_1580529385,e3),\n    max(mix(v3,v4,a3)*step(e3,x_1580529385)*step(x_1580529385,e4),\n    max(mix(v4,v5,a4)*step(e4,x_1580529385)*step(x_1580529385,e5),\n    max(mix(v5,v6,a5)*step(e5,x_1580529385)*step(x_1580529385,e6),\n    max(mix(v6,v7,a6)*step(e6,x_1580529385)*step(x_1580529385,e7),mix(v7,v8,a7)*step(e7,x_1580529385)*step(x_1580529385,e8)\n  )))))));\n}\n\n// The texture (GL.LUMINANCE & Uint8Array).\nuniform sampler2D uBitmapTexture;\n\n// What are the dimensions of the texture (width, height)?\nuniform vec2 uTextureSize;\n\n// How many consecutive pixels should be aggregated together along each axis?\nuniform vec2 uAggSize;\n\n// What are the values of the color scale sliders?\nuniform vec2 uColorScaleRange;\n\n// The texture coordinate, varying (interpolated between values set by the vertex shader).\nvarying vec2 vTexCoord;\n\nvoid main(void) {\n  // Compute 1 pixel in texture coordinates\n  vec2 onePixel = vec2(1.0, 1.0) / uTextureSize;\n  \n  vec2 viewCoord = vec2(floor(vTexCoord.x * uTextureSize.x), floor(vTexCoord.y * uTextureSize.y));\n\n  // Compute (x % aggSizeX, y % aggSizeY).\n  // These values will be the number of values to the left / above the current position to consider.\n  vec2 modAggSize = vec2(-1.0 * mod(viewCoord.x, uAggSize.x), -1.0 * mod(viewCoord.y, uAggSize.y));\n\n  // Take the sum of values along each axis.\n  float intensitySum = 0.0;\n  vec2 offsetPixels = vec2(0.0, 0.0);\n\n  for(int i = 0; i < 16; i++) {\n    // Check to break outer loop early.\n    // Uniforms cannot be used as conditions in GLSL for loops.\n    if(float(i) >= uAggSize.y) {\n      // Done in the y direction.\n      break;\n    }\n\n    offsetPixels = vec2(offsetPixels.x, (modAggSize.y + float(i)) * onePixel.y);\n\n    for(int j = 0; j < 16; j++) {\n      // Check to break inner loop early.\n      // Uniforms cannot be used as conditions in GLSL for loops.\n      if(float(j) >= uAggSize.x) {\n        // Done in the x direction.\n        break;\n      }\n\n      offsetPixels = vec2((modAggSize.x + float(j)) * onePixel.x, offsetPixels.y);\n      intensitySum += texture2D(uBitmapTexture, vTexCoord + offsetPixels).r;\n    }\n  }\n  \n  // Compute the mean value.\n  float intensityMean = intensitySum / (uAggSize.x * uAggSize.y);\n  \n  // Re-scale using the color scale slider values.\n  float scaledIntensityMean = (intensityMean - uColorScaleRange[0]) / max(0.005, (uColorScaleRange[1] - uColorScaleRange[0]));\n\n  gl_FragColor = __colormap(clamp(scaledIntensityMean, 0.0, 1.0));\n\n  geometry.uv = vTexCoord;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n".replace("__colormap",e),modules:[rt.a,ot.a]})}},{key:"draw",value:function(e){var t=e.uniforms,n=this.state,a=n.bitmapTexture,r=n.model,o=this.props,i=o.aggSizeX,l=o.aggSizeY,s=o.colorScaleLo,c=o.colorScaleHi;a&&r&&r.setUniforms(Object.assign({},t,{uBitmapTexture:a,uTextureSize:[2048,2048],uAggSize:[i,l],uColorScaleRange:[s,c]})).draw()}},{key:"loadTexture",value:function(e){var t=this.context.gl;this.state.bitmapTexture&&this.state.bitmapTexture.delete(),e instanceof it.a?this.setState({bitmapTexture:e}):e&&this.setState({bitmapTexture:new it.a(t,{data:e,mipmaps:!1,parameters:Vo,format:at.default.LUMINANCE,dataFormat:at.default.LUMINANCE,type:at.default.UNSIGNED_BYTE,width:2048,height:2048})})}}]),n}(Bo.a);Yo.layerName="HeatmapBitmapLayer",Yo.defaultProps={image:{type:"object",value:null,async:!0},colormap:{type:"string",value:"plasma",compare:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},aggSizeX:{type:"number",value:8,compare:!0},aggSizeY:{type:"number",value:8,compare:!0},colorScaleLo:{type:"number",value:0,compare:!0},colorScaleHi:{type:"number",value:1,compare:!0}};var Wo=Object(s.a)({},Bo.a.defaultProps,{image:{type:"object",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]}}),qo=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"renderLayers",value:function(){var e=this.props.image;return new Bo.a(this.props,{id:"".concat(this.props.id,"-wrapped"),image:e,textureParameters:Vo})}}]),n}(go.a);qo.layerName="PixelatedBitmapLayer",qo.defaultProps=Wo;var $o=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"_renderAxisTopLayers",value:function(){var e=this.props,t=e.axisTopLabelData,n=e.matrixLeft,a=e.width,r=e.matrixWidth,o=e.viewWidth,i=e.theme,l=e.targetX,s=e.targetY,c=e.axisTopTitle,u=e.cellWidth>=9,p=s+(e.axisOffsetTop-3)/2/e.scaleFactor;return[new fo.a({id:"axisTopLabels",coordinateSystem:ze.a.CARTESIAN,data:t,getText:function(e){return e[1]},getPosition:function(e){return[n+(e[0]+.5)/a*r,p]},getTextAnchor:"start",getColor:function(){return Zo[i]},getSize:u?9:0,getAngle:75,fontFamily:Uo,updateTriggers:{getPosition:[p,n,r,o],getSize:[u],getColor:[i]}}),new fo.a({id:"axisTopTitle",coordinateSystem:ze.a.CARTESIAN,data:[{title:c}],getText:function(e){return e.title},getPosition:[l,s],getTextAnchor:"middle",getColor:function(){return Zo[i]},getSize:u?0:15,getAngle:0,fontFamily:Uo,updateTriggers:{getSize:[u],getColor:[i]}})]}},{key:"_renderAxisLeftLayers",value:function(){var e=this.props,t=e.axisLeftLabelData,n=e.matrixTop,a=e.height,r=e.matrixHeight,o=e.viewHeight,i=e.theme,l=e.axisLeftTitle,s=e.targetX,c=e.targetY,u=e.cellHeight>=9,p=s+(e.axisOffsetLeft-3)/2/e.scaleFactor;return[new fo.a({id:"axisLeftLabels",coordinateSystem:ze.a.CARTESIAN,data:t,getText:function(e){return e[1]},getPosition:function(e){return[p,n+(e[0]+.5)/a*r]},getTextAnchor:"end",getColor:function(){return Zo[i]},getSize:u?9:0,getAngle:0,fontFamily:Uo,updateTriggers:{getPosition:[p,n,r,o],getSize:[u],getColor:[i]}}),new fo.a({id:"axisLeftTitle",coordinateSystem:ze.a.CARTESIAN,data:[{title:l}],getText:function(e){return e.title},getPosition:[s,c],getTextAnchor:"middle",getColor:function(){return Zo[i]},getSize:u?0:15,getAngle:90,fontFamily:Uo,updateTriggers:{getSize:[u],getColor:[i]}})]}},{key:"renderLayers",value:function(){return[this._renderAxisTopLayers(),this._renderAxisLeftLayers()]}}]),n}(go.a);$o.layerName="HeatmapCompositeTextLayer";var Ko=n(1437);function Jo(e,t){return e&&e.length&&t(e[0][1])?Object(Ko.a)().x((function(e){return t(e[1])[0]})).y((function(e){return t(e[1])[1]})).addAll(e):null}var Qo=n(1442),ei=n(701),ti=n(700);function ni(){return(ni=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ai(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var ri=i.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),oi=i.createElement("path",{d:"M21 3L3 10.53v.98l6.84 2.65L12.48 21h.98L21 3z"});function ii(e){var t=e.svgRef,n=e.title,a=e.titleId,r=ai(e,["svgRef","title","titleId"]);return i.createElement("svg",ni({width:24,height:24,viewBox:"0 0 24 24",ref:t,"aria-labelledby":a},r),n?i.createElement("title",{id:a},n):null,ri,oi)}var li=i.forwardRef((function(e,t){return i.createElement(ii,ni({svgRef:t},e))}));n.p;function si(){return(si=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ci(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var ui=i.createElement("path",{d:"       M19 19h2v2h-2v-2zm0-2h2v-2h-2v2z       M3 13h2v-2H3v2zm0 4h2v-2H3v2z       m0-8h2V7H3v2zm0-4h2V3H3v2z       m4 0h2V3H7v2zm8 16h2v-2h-2v2z       m-4 0h2v-2h-2v2z       m4 0h2v-2h-2v2z       m-8 0h2v-2H7v2z       m-4 0h2v-2H3v2z       M11 5h2v-2h-2v2z       M15 5h2v-2h-2v2z       M19 5h2v-2h-2v2z       M19 9h2v-2h-2v2z       M19 13h2v-2h-2v2z     "});function pi(e){var t=e.svgRef,n=e.title,a=e.titleId,r=ci(e,["svgRef","title","titleId"]);return i.createElement("svg",si({width:24,height:24,viewBox:"0 0 24 24",ref:t,"aria-labelledby":a},r),n?i.createElement("title",{id:a},n):null,ui)}var di=i.forwardRef((function(e,t){return i.createElement(pi,si({svgRef:t},e))}));n.p;function mi(){return(mi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function fi(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hi(e){var t=e.svgRef,n=e.title,a=e.titleId,r=fi(e,["svgRef","title","titleId"]);return i.createElement("svg",mi({width:24,height:24,viewBox:"0 0 24 24",ref:t,"aria-labelledby":a},r),n?i.createElement("title",{id:a},n):null,i.createElement("g",{transform:"translate(0,3)"},i.createElement("path",{style:{strokeWidth:.343565},d:"M 23.942314,4.6958443 C 23.446206,1.8868581 19.727461,0 14.687364,0 13.437819,0 12.150138,0.11543779 10.859708,0.34287772 4.1629423,1.5250844 -0.58168816,5.2884937 0.05768601,8.911385 c 0.25355086,1.439193 1.35605049,2.63583 3.04638949,3.461072 -0.2569865,0.387198 -0.4074679,0.826617 -0.4074679,1.29524 0,1.337498 1.1863293,2.457176 2.7639791,2.728248 l -1.3615475,2.333149 c -0.1576963,0.271073 -0.066308,0.61876 0.2047647,0.776457 0.090014,0.05291 0.1886171,0.07799 0.2858459,0.07799 0.1951448,0 0.3851362,-0.100665 0.4912977,-0.281723 l 1.6803757,-2.88148 C 8.41868,16.20561 9.6895264,15.063601 9.6998333,13.683844 c 6.872e-4,-0.0055 0.00137,-0.01065 0.00137,-0.01615 0,-0.02336 -0.00344,-0.04569 -0.00481,-0.06837 1.1292977,-0.0213 2.2847067,-0.130211 3.4435507,-0.334975 6.69711,-1.181863 11.44174,-4.9456164 10.802366,-8.5685077 z M 3.83312,13.667353 c 0,-0.30749 0.1281497,-0.59849 0.3470005,-0.848261 0.1219655,0.04295 0.2456489,0.08383 0.3717372,0.123339 l 1.2234344,2.352045 C 4.6865351,15.149835 3.83312,14.46408 3.83312,13.667353 Z M 7.0141869,15.216144 6.0223152,13.309702 5.4008064,12.114097 c 0.121622,-0.03161 0.2477103,-0.05634 0.3772342,-0.07387 0.1367388,-0.0189 0.2772568,-0.02886 0.420867,-0.02886 0.5067581,0 0.980534,0.11956 1.3701366,0.317454 0.5696305,0.289968 0.9554538,0.750345 0.9904974,1.262944 0.00137,0.02542 0.0055,0.05016 0.0055,0.07593 0,0.698124 -0.6562089,1.310356 -1.5508518,1.548447 z m 5.9185921,-3.126441 c -1.217251,0.214728 -2.429691,0.323982 -3.6060571,0.324669 -0.5765018,-0.911821 -1.7614569,-1.53917 -3.1278143,-1.53917 -0.4717146,0 -0.921441,0.07593 -1.332001,0.211292 -0.3061162,0.100665 -0.5878394,0.237403 -0.8427645,0.39991 C 2.4598914,10.828133 1.4360682,9.8579062 1.2319907,8.7035283 0.72660678,5.8381974 5.2307418,2.5475333 11.067221,1.5175259 c 1.222061,-0.2161023 2.439998,-0.3246688 3.620143,-0.3246688 4.371863,0 7.694479,1.5250844 8.080645,3.7101568 0.505041,2.8653309 -3.998751,6.1566821 -9.83523,7.1866891 z",id:"path10"})))}var gi=i.forwardRef((function(e,t){return i.createElement(hi,mi({svgRef:t},e))}));n.p;function bi(e){var t=e.alt,n=e.onClick,a=e.isActive,r=e.children,o="btn btn-outline-secondary mr-2 icon",i="".concat(o," active");return l.a.createElement("button",{className:a?i:o,onClick:n,type:"button",title:t},r)}function yi(e){var t=e.setActiveTool,n=e.activeTool,a=e.visibleTools,r=void 0===a?{pan:!0,selectRectangle:!0,selectLasso:!0}:a;return l.a.createElement("div",{className:"tool"},r.pan&&l.a.createElement(bi,{alt:"pointer tool",onClick:function(){return t(null)},isActive:null===n},l.a.createElement(li,null)),r.selectRectangle?l.a.createElement(bi,{alt:"select rectangle",onClick:function(){return t(wo.SELECTION_TYPE.RECTANGLE)},isActive:n===wo.SELECTION_TYPE.RECTANGLE},l.a.createElement(di,null)):null,r.selectLasso?l.a.createElement(bi,{alt:"select lasso",onClick:function(){return t(wo.SELECTION_TYPE.POLYGON)},isActive:n===wo.SELECTION_TYPE.POLYGON},l.a.createElement(gi,null)):null)}var vi=function(){return"crosshair"},Oi=function(e){return e.isDragging?"grabbing":"default"},xi=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(e){var a;return Object(z.a)(this,n),(a=t.call(this,e)).state={gl:null,tool:null},a.viewport=null,a.onViewStateChange=a.onViewStateChange.bind(Object(xe.a)(a)),a.onInitializeViewInfo=a.onInitializeViewInfo.bind(Object(xe.a)(a)),a.onWebGLInitialized=a.onWebGLInitialized.bind(Object(xe.a)(a)),a.onToolChange=a.onToolChange.bind(Object(xe.a)(a)),a.onHover=a.onHover.bind(Object(xe.a)(a)),a}return Object(G.a)(n,[{key:"onViewStateChange",value:function(e){var t=e.viewState,n=this.props,a=n.setViewState,r=n.viewState,o=n.layers,i=n.spatialAxisFixed,l=null===o||void 0===o?void 0:o.some((function(e){return e.use3d}));a(Object(s.a)({},t,{target:i&&l?r.target:t.target}))}},{key:"onInitializeViewInfo",value:function(e){var t=e.viewport;this.viewport=t}},{key:"onWebGLInitialized",value:function(e){this.setState({gl:e})}},{key:"onToolChange",value:function(e){var t=this.props.onToolChange;this.setState({tool:e}),t&&t(e)}},{key:"getLayers",value:function(){return[]}},{key:"onHover",value:function(e){var t=e.coordinate,n=e.layer,a=e.sourceLayer,r=this.props,o=r.setCellHighlight,i=r.cellHighlight,l=r.setComponentHover,s=(r.layers||[]).some((function(e){return"bitmask"===e.type}));if(!o)return null;if(!a||!t)return i&&s&&o(null),null;var c=a.props,u=c.channelData,p=c.bounds;if(!u)return i&&s&&o(null),null;var d=u.data,m=u.width;if(!d)return i&&s&&o(null),null;if(a.id.includes("bitmask")){var f=n.props.loader[0].tileSize,h=a.props.tileId.z,g=Math.max(1,Math.pow(2,Math.round(-h+Math.log2(512/f)))),b=[Math.floor((t[0]-p[0])/g),Math.floor((t[1]-p[3])/g)],y=b[1]*m+b[0],v=d.map((function(e){return e[y]})).find((function(e){return e>0}));v!==Number(i)&&(l&&l(),o(v?String(v):null))}}},{key:"viewInfoDidUpdate",value:function(e){var t=this.props,n=t.updateViewInfo,a=t.cells,r=t.uuid,i=this.viewport;n&&i&&n({uuid:r,project:function(t){var n=a[t];try{var r=e(n),l=Object(o.a)(r,2),s=l[0],c=l[1];return i.project([s,c])}catch(u){return[null,null]}}})}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.deckRef,n=e.viewState,a=e.uuid,r=e.layers,o=this.state,i=o.gl,s=o.tool,c=this.getLayers(),u=(r||[]).some((function(e){return e.use3d})),p=null!==this.cellsLayer||this.cellsEntries.length&&this.cellsEntries[0][1].xy,d=null!==this.cellsLayer||r.findIndex((function(e){return"bitmask"===e.type||"raster"===e.type}))>=0,m=this.cellsEntries.length<1e5&&!u;return l.a.createElement(l.a.Fragment,null,l.a.createElement(yi,{activeTool:s,setActiveTool:this.onToolChange,visibleTools:{pan:d,selectRectangle:p,selectLasso:p}}),l.a.createElement(Qo.a,{id:"deckgl-overlay-".concat(a),ref:t,views:[u?new ei.a({id:"orbit",controller:!0,orbitAxis:"Y"}):new ti.a({id:"ortho"})],layers:i&&n.target.slice(0,2).every((function(e){return"number"===typeof e}))?c:[],glOptions:Ye,onWebGLInitialized:this.onWebGLInitialized,onViewStateChange:this.onViewStateChange,viewState:n,useDevicePixels:m,controller:!s||{dragPan:!1},getCursor:s?vi:Oi,onHover:this.onHover},this.onInitializeViewInfo))}}]),n}(i.PureComponent);function ji(e){return function(){return e}}function Ei(e){return e+1e-6*(Math.random()-.5)}var Ci=function(e){return function(t){var n=t[1].mappings;if(!(e in n)){var a=Object.keys(n).map((function(e){return'"'.concat(e,'"')})).join(", ");throw new Error('Expected to find "'.concat(e,'", but available mappings are: ').concat(a))}var r=n[e];return[r[0],-r[1],0]}},Si=function(e){return function(t){return t.mappings[e]}},wi=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(e){var a;return Object(z.a)(this,n),(a=t.call(this,e)).cellsEntries=[],a.cellsQuadTree=null,a.cellsLayer=null,a.cellSetsForceSimulation=function(){var e,t,n,a=1,r=1,o=ji([0,0]);function i(e){return e.x+e.vx+n[e.index][0]/2}function l(e){return e.y+e.vy+n[e.index][1]/2}function s(e){if(e.data)e.size=n[e.data.index];else{e.size=[0,0];for(var t=0;t<4;t++)e[t]&&e[t].size&&(e.size[0]=Math.max(e.size[0],e[t].size[0]),e.size[1]=Math.max(e.size[1],e[t].size[1]))}}function c(){var o,c,u,p,d,m=Object(Ko.a)(e,i,l).visitAfter(s);function f(e,n,r,s,m){var f=e.data,h=(c[0]+e.size[0])/2,g=(c[1]+e.size[1])/2;if(f&&f.index>o.index){var b=Ei(p-i(f)),y=Ei(d-l(f)),v=Math.abs(b)-h,O=Math.abs(y)-g;if(v<0&&O<0){var x=Math.sqrt(b*b+y*y),j=t[f.index]/(u+t[f.index]);Math.abs(v)<Math.abs(O)?(o.vx-=(b*=v/x*a)*j,f.vx+=b*(1-j)):(o.vy-=(y*=O/x*a)*j,f.vy+=y*(1-j))}return n>p+h||s<p-h||r>d+g||m<d-g}return!1}function h(){for(var a=0;a<e.length;a++)o=e[a],c=n[a],u=t[a],p=i(o),d=l(o),m.visit(f)}for(var g=0;g<r;g++)h()}return c.initialize=function(a){n=(e=a).map(o),t=n.map((function(e){return e[0]+e[1]}))},c.iterations=function(){return arguments.length?(r=+(arguments.length<=0?void 0:arguments[0]),c):r},c.strength=function(){return arguments.length?(a=+(arguments.length<=0?void 0:arguments[0]),c):a},c.size=function(){return arguments.length?(o="function"===typeof(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:ji(arguments.length<=0?void 0:arguments[0]),c):o},c}(),a.cellSetsLabelPrevZoom=null,a.cellSetsLayers=[],a.onUpdateCellsData(),a.onUpdateCellsLayer(),a.onUpdateCellSetsLayers(),a}return Object(G.a)(n,[{key:"createCellsLayer",value:function(){var e=this.cellsEntries,t=this.props,n=t.theme,a=t.mapping,r=t.getCellPosition,o=void 0===r?Ci(a):r,i=t.cellRadiusScale,l=void 0===i?.2:i,c=t.cellOpacity,u=void 0===c?1:c,p=t.cellFilter,d=t.cellSelection,m=t.setCellHighlight,f=t.setComponentHover,h=t.getCellIsSelected,g=void 0===h?function(e){return function(t){return!e||e.includes(t[0])}}(e.length===d.length?null:d):h,b=t.cellColors,y=t.getCellColor,v=void 0===y?function(e){return function(t){return e&&e.get(t[0])||Be}}(b):y,O=t.onCellClick,x=p?e.filter((function(e){return p.includes(e[0])})):e;return new Ho(Object(s.a)({id:"scatterplot",backgroundColor:"dark"===n?[0,0,0]:[241,241,241],isSelected:g,opacity:u,radiusScale:l,radiusMinPixels:1,radiusMaxPixels:10,getPosition:o,getColor:v,getLineWidth:0,onClick:function(e){O&&O(e)}},Xe(x,void 0,m,f)))}},{key:"createCellSetsLayers",value:function(){var e=this.props,t=e.theme,n=e.cellSetPolygons,a=e.viewState,r=e.cellSetPolygonsVisible,o=e.cellSetLabelsVisible,i=e.cellSetLabelSize,l=[];if(r&&l.push(new mo.a({id:"cell-sets-polygon-layer",data:n,stroked:!0,filled:!1,wireframe:!0,lineWidthMaxPixels:1,getPolygon:function(e){return e.hull},getLineColor:function(e){return e.color},getLineWidth:1})),o){var s=a.zoom,c=n.map((function(e){return{x:e.centroid[0],y:e.centroid[1],label:e.name}})),u=this.cellSetsForceSimulation.size((function(e){return[1*i/Math.pow(2,s)*4*e.label.length,1*i/Math.pow(2,s)*1.5]}));Object(ho.a)().nodes(c).force("collision",u).tick(100),l.push(new fo.a({id:"cell-sets-text-layer",data:c,getPosition:function(e){return[e.x,e.y]},getText:function(e){return e.label},getColor:"dark"===t?[255,255,255]:[0,0,0],getSize:i,getAngle:0,getTextAnchor:"middle",getAlignmentBaseline:"center",fontFamily:"-apple-system, 'Helvetica Neue', Arial, sans-serif",fontWeight:"normal"}))}return l}},{key:"createSelectionLayers",value:function(){var e=this.props,t=e.viewState,n=e.mapping,a=e.getCellCoords,r=void 0===a?Si(n):a,o=e.setCellSelection,i=this.state.tool,l=this.cellsQuadTree;return Mo(i,t.zoom,"scatterplot",r,o,l,!0)}},{key:"getLayers",value:function(){var e=this.cellsLayer,t=this.cellSetsLayers;return[e].concat(Object(c.a)(t),Object(c.a)(this.createSelectionLayers()))}},{key:"onUpdateCellsData",value:function(){var e=this.props,t=e.cells,n=void 0===t?{}:t,a=e.mapping,r=e.getCellCoords,o=void 0===r?Si(a):r,i=Object.entries(n);this.cellsEntries=i,this.cellsQuadTree=Jo(i,o)}},{key:"onUpdateCellsLayer",value:function(){this.cellsLayer=this.createCellsLayer()}},{key:"onUpdateCellSetsLayers",value:function(e){if(e){var t=this.props,n=t.viewState,a=t.cellSetLabelsVisible,r=n.zoom,o=this.cellSetsLabelPrevZoom;a&&(null===o||Math.abs(o-r)>.25)&&(this.cellSetsLayers=this.createCellSetsLayers(),this.cellSetsLabelPrevZoom=r)}else this.cellSetsLayers=this.createCellSetsLayers()}},{key:"viewInfoDidUpdate",value:function(){var e=this.props,t=e.mapping,a=e.getCellPosition,r=void 0===a?Ci(t):a;Object(Se.a)(Object(Ce.a)(n.prototype),"viewInfoDidUpdate",this).call(this,(function(e){return r([null,e])}))}},{key:"componentDidUpdate",value:function(e){var t=this;this.viewInfoDidUpdate();var n=function(n){return e[n]!==t.props[n]};["cells"].some(n)&&(this.onUpdateCellsData(),this.forceUpdate()),["cells","cellFilter","cellSelection","cellColors","cellRadiusScale"].some(n)&&(this.onUpdateCellsLayer(),this.forceUpdate()),["cellSetPolygons","cellSetPolygonsVisible","cellSetLabelsVisible","cellSetLabelSize"].some(n)&&(this.onUpdateCellSetsLayers(!1),this.forceUpdate()),n("viewState")&&(this.onUpdateCellSetsLayers(!0),this.forceUpdate())}}]),n}(xi),Li=Object(i.forwardRef)((function(e,t){return l.a.createElement(wi,Object.assign({},e,{deckRef:t}))}));function Ti(e){var t=e.x,n=e.y,a=e.parentWidth,r=e.parentHeight,o=e.children,s=Object(i.useRef)(null),c=a<500;return Object(i.useEffect)((function(){var e=s.current,o=c?-5:10,i=t>a/2?-(100+o):o,l=n>r/2?-(100+o):o,u=c?.75:1;e.style.transform="translateX(".concat(i,"%) translateY(").concat(l,"%) scale(").concat(u,")"),e.style.whiteSpace=c?"normal":"nowrap"})),l.a.createElement("div",{ref:s,className:"cell-tooltip bg-primary",style:{left:"".concat(t,"px"),top:"".concat(n,"px")}},o)}function Ai(e){var t=e.parentUuid,n=e.sourceUuid,a=e.x,r=e.y,o=e.parentWidth,i=e.parentHeight,s=e.children;if(a<0||a>o||r<0||r>i)return null;var c=t===n;return l.a.createElement(l.a.Fragment,null,c?l.a.createElement(Ti,{x:a,y:r,parentWidth:o,parentHeight:i},s):l.a.createElement(l.a.Fragment,null,null!==a?l.a.createElement("div",{className:"cell-emphasis-crosshair",style:{left:"".concat(a-.5,"px"),top:0,width:"".concat(1,"px"),height:"".concat(i,"px")}}):null,null!==r?l.a.createElement("div",{className:"cell-emphasis-crosshair",style:{left:0,top:"".concat(r-.5,"px"),width:"".concat(o,"px"),height:"".concat(1,"px")}}):null))}function ki(e){var t=e.info;return l.a.createElement("table",null,l.a.createElement("tbody",null,Object.entries(t).map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return l.a.createElement("tr",{key:n},l.a.createElement("th",null,n),l.a.createElement("td",null,a))}))))}function _i(e){var t=e.parentUuid,n=e.cellHighlight,a=e.width,r=e.height,i=e.getCellInfo,s=Gn(),u=Bn(t),p=n&&i?[i(n)].concat(Object(c.a)(u&&u.project?u.project(n):[null,null])):[null,null,null],d=Object(o.a)(p,3),m=d[0],f=d[1],h=d[2];return m?l.a.createElement(Ai,{x:f,y:h,parentUuid:t,sourceUuid:s,parentWidth:a,parentHeight:r},l.a.createElement(ki,{info:m})):null}var Ii=n(1443),Pi=n(1451),Ni=n(1421),Ri=n(1420),Mi=Object(P.a)((function(e){return{box:{boxSizing:"border-box"},checkbox:{padding:"3px",color:e.palette.primaryForeground,"&:checked":{color:e.palette.primaryForeground},"& input":{height:"100%"}},slider:{color:e.palette.primaryForeground,minWidth:"60px",padding:"10px 0 6px 0"},sliderValueLabel:{"& span":{"& span":{color:e.palette.primaryBackground}}},tableContainer:{overflow:"hidden"},labelCell:{padding:"2px 8px 2px 16px"},inputCell:{padding:"2px 16px 2px 8px",overflow:"visible"},select:{"& select":{fontSize:".875rem"}}}})),Di=n(1436),zi=n(1418),Gi=n(1419),Hi=n(1417);function Fi(e){var t=e.children,n=Mi();return l.a.createElement(Di.a,{className:n.box},l.a.createElement(Hi.a,{className:n.tableContainer},l.a.createElement(zi.a,{className:n.table,size:"small"},l.a.createElement(Gi.a,null,t))))}var Xi=n(1435);function Bi(e){var t=e.observationsLabel,n=e.cellColorEncoding,a=e.setCellColorEncoding,r=Mi(),o=V(t);return l.a.createElement(Ri.a,null,l.a.createElement(Ni.a,{className:r.labelCell,htmlFor:"cell-color-encoding-select"},o," Color Encoding"),l.a.createElement(Ni.a,{className:r.inputCell},l.a.createElement(Xi.a,{native:!0,className:r.select,value:n,onChange:function(e){a(e.target.value)},inputProps:{id:"cell-color-encoding-select"}},l.a.createElement("option",{value:"cellSetSelection"},"Cell Sets"),l.a.createElement("option",{value:"geneSelection"},"Gene Expression"))))}function Zi(e){var t=e.observationsLabel,n=e.cellRadius,a=e.setCellRadius,r=e.cellSetLabelsVisible,o=e.setCellSetLabelsVisible,i=e.cellSetLabelSize,s=e.setCellSetLabelSize,c=e.cellSetPolygonsVisible,u=e.setCellSetPolygonsVisible,p=e.cellColorEncoding,d=e.setCellColorEncoding,m=V(t),f=Mi();return l.a.createElement(Fi,null,l.a.createElement(Ri.a,null,l.a.createElement(Ni.a,{className:f.labelCell},m," Set Labels Visible"),l.a.createElement(Ni.a,{className:f.inputCell},l.a.createElement(Ii.a,{className:f.checkbox,checked:r,onChange:function(e){o(e.target.checked)},name:"scatterplot-option-cell-set-labels",color:"default"}))),l.a.createElement(Ri.a,null,l.a.createElement(Ni.a,{className:f.labelCell},m," Set Label Size"),l.a.createElement(Ni.a,{className:f.inputCell},l.a.createElement(Pi.a,{disabled:!r,classes:{root:f.slider,valueLabel:f.sliderValueLabel},value:i,onChange:function(e,t){s(t)},"aria-labelledby":"cell-set-label-size-slider",valueLabelDisplay:"auto",step:1,min:8,max:36}))),l.a.createElement(Ri.a,null,l.a.createElement(Ni.a,{className:f.labelCell},m," Set Polygons Visible"),l.a.createElement(Ni.a,{className:f.inputCell},l.a.createElement(Ii.a,{className:f.checkbox,checked:c,onChange:function(e){u(e.target.checked)},name:"scatterplot-option-cell-set-polygons",color:"default"}))),l.a.createElement(Ri.a,null,l.a.createElement(Ni.a,{className:f.labelCell},m," Radius"),l.a.createElement(Ni.a,{className:f.inputCell},l.a.createElement(Pi.a,{classes:{root:f.slider,valueLabel:f.sliderValueLabel},value:n,onChange:function(e,t){a(t)},"aria-labelledby":"cell-radius-slider",valueLabelDisplay:"auto",step:.25,min:.25,max:8}))),l.a.createElement(Bi,{observationsLabel:t,cellColorEncoding:p,setCellColorEncoding:d}))}var Ui=["cells","expression-matrix","cell-sets"];var Vi=n(7),Yi=function(e){return e.xy},Wi=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(e){var a;return Object(z.a)(this,n),(a=t.call(this,e)).cellsEntries=[],a.moleculesEntries=[],a.cellsQuadTree=null,a.cellsLayer=null,a.moleculesLayer=null,a.neighborhoodsLayer=null,a.imageLayers=[],a.layerLoaderSelections={},a.randomColorData={data:new Uint8Array(12582912).map((function(e,t){return t<4?0:Math.round(255*Math.random())})),height:2048,width:2048},a.color=Object(s.a)({},a.randomColorData),a.onUpdateCellsData(),a.onUpdateCellsLayer(),a.onUpdateMoleculesData(),a.onUpdateMoleculesLayer(),a.onUpdateNeighborhoodsData(),a.onUpdateNeighborhoodsLayer(),a.onUpdateImages(),a}return Object(G.a)(n,[{key:"createCellsLayer",value:function(e){var t=e.radius,n=e.stroked,a=e.visible,r=e.opacity,o=this.cellsEntries,i=this.props,l=i.cellFilter,c=i.cellSelection,u=i.setCellHighlight,p=i.setComponentHover,d=i.getCellIsSelected,m=void 0===d?function(e){return function(t){return!e||e.includes(t[0])}}(o.length===c.length?null:c):d,f=i.cellColors,h=i.getCellColor,g=void 0===h?function(e){return function(t){return e&&e.get(t[0])||Be}}(f):h,b=i.getCellPolygon,y=void 0===b?function(e){return function(t){var n,a,r,o,i=t[1];return(null===(n=i.poly)||void 0===n?void 0:n.length)?i.poly:(a=i.xy[0],r=i.xy[1],[[a,r+(o=e)],[a+o,r],[a,r-o],[a-o,r]])}}(t):b,v=i.onCellClick,O=i.lineWidthScale,x=void 0===O?10:O,j=i.lineWidthMaxPixels,E=void 0===j?2:j,C=l?o.filter((function(e){return l.includes(e[0])})):o;return new zo(Object(s.a)({id:"cells-layer",backgroundColor:[0,0,0],isSelected:m,getPolygon:y,updateTriggers:{getFillColor:[r],getLineWidth:[n]},getFillColor:function(e){var t=g(e);return t[3]=255*r,t},getLineColor:function(e){var t=g(e);return t[3]=255,t},onClick:function(e){v&&v(e)},visible:a,getLineWidth:n?1:0,lineWidthScale:x,lineWidthMaxPixels:E},Xe(C,void 0,u,p)))}},{key:"createMoleculesLayer",value:function(e){var t=this.props,n=t.setMoleculeHighlight,a=t.getMoleculeColor,r=void 0===a?function(e){return Ze[e[2]%Ze.length]}:a,o=t.getMoleculePosition,i=void 0===o?function(e){return[e[0],e[1],0]}:o,l=this.moleculesEntries;return new Go.a({id:"molecules-layer",coordinateSystem:ze.a.CARTESIAN,data:l,pickable:!0,autoHighlight:!0,radiusMaxPixels:3,opacity:e.opacity,visible:e.visible,getRadius:e.radius,getPosition:i,getLineColor:r,getFillColor:r,onHover:function(e){n&&(e.object?n(e.object[3]):n(null))}})}},{key:"createNeighborhoodsLayer",value:function(e){var t=this.props.getNeighborhoodPolygon,n=void 0===t?function(e){return e[1].poly}:t,a=this.neighborhoodsEntries;return new mo.a({id:"neighborhoods-layer",getPolygon:n,coordinateSystem:ze.a.CARTESIAN,data:a,pickable:!0,autoHighlight:!0,stroked:!0,filled:!1,getElevation:0,getLineWidth:10,visible:e.visible})}},{key:"createSelectionLayers",value:function(){var e=this.props,t=e.viewState,n=e.getCellCoords,a=void 0===n?Yi:n,r=e.setCellSelection,o=this.state.tool,i=this.cellsQuadTree;return Mo(o,t.zoom,"cells-layer",a,r,i)}},{key:"createScaleBarLayer",value:function(){var e=this.props,t=e.viewState,n=e.width,a=e.height,r=e.imageLayerLoaders,o=void 0===r?{}:r,i=(e.layers||[]).some((function(e){return e.use3d})),l=Object.values(o);if(!t||!n||!a||l.length<1)return null;var c=l[0];if(!c)return null;var u=W(c);if(!u.meta)return null;var p=u.meta.physicalSizes;if(p&&!i){var d=p.x,m=d.unit,f=d.size;return m&&f?new Pe.f({id:"scalebar-layer",loader:c,unit:m,size:f,viewState:Object(s.a)({},t,{width:n,height:a})}):null}return null}},{key:"createImageLayer",value:function(e,t,n){var a,r=Object(s.a)({},e,{channels:e.channels.filter((function(e){return e.selection&&e.color&&e.slider}))}),i=r.channels.map((function(e){return e.selection})),l=this.layerLoaderSelections[r.index];I()(l,i)?a=l:(a=i,this.layerLoaderSelections[r.index]=i);var c={colormap:r.colormap,opacity:r.opacity,transparentColor:r.transparentColor,colors:r.channels.map((function(e){return e.color})),sliders:r.channels.map((function(e){return e.slider})),resolution:r.resolution,renderingMode:r.renderingMode,xSlice:r.xSlice,ySlice:r.ySlice,zSlice:r.zSlice,callback:r.callback,visibilities:r.channels.map((function(e){return!(!r.visible&&"boolean"===typeof r.visible)&&e.visible}))};if(!t||!c)return null;var u,p=t.metadata.transform,d=t.data;if(p){var m=p.scale,f=p.translate;u=(new Me.Matrix4).translate([f.x,f.y,0]).scale(m)}else r.modelMatrix&&(u=new Me.Matrix4(r.modelMatrix));if("bitmask"===e.type)return new Pe.d({id:"bitmask-layer-".concat(r.index,"-").concat(n),channelIsOn:c.visibilities,opacity:c.opacity,modelMatrix:u,hoveredCell:Number(this.props.cellHighlight),renderSubLayers:Ct,loader:d,loaderSelection:a,cellColorData:this.color.data,cellColorHeight:this.color.height,cellColorWidth:this.color.width,excludeBackground:!0,onViewportLoad:c.callback});var h=function(e,t){var n=Array.isArray(e)&&e.length>1||!Array.isArray(e)?e:e[0];return t?[Pe.g,Array.isArray(n)?n:[n]]:[Array.isArray(e)&&e.length>1?Pe.d:Pe.b,n]}(d,r.use3d),g=Object(o.a)(h,2);return new(0,g[0])({loader:g[1],id:"".concat(r.use3d?"volume":"image","-layer-").concat(r.index,"-").concat(n),colorValues:c.colors,sliderValues:c.sliders,loaderSelection:a,channelIsOn:c.visibilities,opacity:c.opacity,colormap:c.colormap,modelMatrix:u,transparentColor:c.transparentColor,resolution:c.resolution,renderingMode:c.renderingMode,pickable:!1,xSlice:c.xSlice,ySlice:c.ySlice,zSlice:c.zSlice,onViewportLoad:c.callback})}},{key:"createImageLayers",value:function(){var e=this,t=this.props,n=t.layers,a=t.imageLayerLoaders,r=void 0===a?{}:a,o=t.rasterLayersCallbacks,i=void 0===o?[]:o,l=(n||[]).some((function(e){return e.use3d})),c=(n||[]).findIndex((function(e){return e.use3d}));return(n||[]).filter((function(e){return"raster"===e.type||"bitmask"===e.type})).filter((function(e){return!l||e.use3d===l})).map((function(t,n){return e.createImageLayer(Object(s.a)({},t,{callback:i[l?c:n]}),r[t.index],n)}))}},{key:"getLayers",value:function(){var e=this.imageLayers,t=this.cellsLayer,n=this.neighborhoodsLayer,a=this.moleculesLayer;return[].concat(Object(c.a)(e),[t,n,a,this.createScaleBarLayer()],Object(c.a)(this.createSelectionLayers()))}},{key:"onUpdateCellsData",value:function(){var e=this.props,t=e.cells,n=void 0===t?{}:t,a=e.getCellCoords,r=void 0===a?Yi:a,o=Object.entries(n);this.cellsEntries=o,this.cellsQuadTree=Jo(o,r)}},{key:"onUpdateCellsLayer",value:function(){var e=(this.props.layers||[]).find((function(e){return"cells"===e.type}));this.cellsLayer=e?this.createCellsLayer(e):null}},{key:"onUpdateCellColors",value:function(){var e=this.randomColorData;if("number"===typeof this.props.cellColors.size){var t=this.props.cellColors.keys();e.data=new Uint8Array(e.height*e.width*3).fill(128),e.data[0]=0,e.data[1]=0,e.data[2]=0;var n,a=Object(Vi.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(r>0){var o=this.props.cellColors.get(r);o&&e.data.set(o.slice(0,3),3*Number(r))}}}catch(i){a.e(i)}finally{a.f()}}this.color=e}},{key:"onUpdateMoleculesData",value:function(){var e=this.props.molecules,t=void 0===e?{}:e,n=Object.entries(t).flatMap((function(e,t){var n=Object(o.a)(e,2),a=n[0];return n[1].map((function(e){var n=Object(o.a)(e,2);return[n[0],n[1],t,a]}))}));this.moleculesEntries=n}},{key:"onUpdateMoleculesLayer",value:function(){var e=(this.props.layers||[]).find((function(e){return"molecules"===e.type}));this.moleculesLayer=e?this.createMoleculesLayer(e):null}},{key:"onUpdateNeighborhoodsData",value:function(){var e=this.props.neighborhoods,t=void 0===e?{}:e,n=Object.entries(t);this.neighborhoodsEntries=n}},{key:"onUpdateNeighborhoodsLayer",value:function(){var e=(this.props.layers||[]).find((function(e){return"neighborhoods"===e.type}));this.neighborhoodsLayer=e?this.createNeighborhoodsLayer(e):null}},{key:"onUpdateImages",value:function(){this.imageLayers=this.createImageLayers()}},{key:"viewInfoDidUpdate",value:function(){var e=this.props.getCellCoords,t=void 0===e?Yi:e;Object(Se.a)(Object(Ce.a)(n.prototype),"viewInfoDidUpdate",this).call(this,t)}},{key:"componentDidUpdate",value:function(e){var t=this;this.viewInfoDidUpdate();var n=function(n){return e[n]!==t.props[n]};["cells"].some(n)&&(this.onUpdateCellsData(),this.forceUpdate()),["layers","cells","cellFilter","cellSelection","cellColors"].some(n)&&(this.onUpdateCellsLayer(),this.forceUpdate()),["cellColors"].some(n)&&(this.onUpdateCellColors(),this.forceUpdate()),["molecules"].some(n)&&(this.onUpdateMoleculesData(),this.forceUpdate()),["layers","molecules"].some(n)&&(this.onUpdateMoleculesLayer(),this.forceUpdate()),["neighborhoods"].some(n)&&(this.onUpdateNeighborhoodsData(),this.forceUpdate()),["layers","neighborhoods"].some(n)&&(this.onUpdateNeighborhoodsLayer(),this.forceUpdate()),["layers","imageLayerLoaders","cellColors","cellHighlight","rasterLayersCallbacks"].some(n)&&(this.onUpdateImages(),this.forceUpdate())}}]),n}(xi),qi=Object(i.forwardRef)((function(e,t){return l.a.createElement(Wi,Object.assign({},e,{deckRef:t}))})),$i=n(1448),Ki=Object(P.a)((function(){return Object($i.a)({cameraLabel:{padding:"0px 0px 0px 16px"},box:{padding:"0px"},button:{padding:"0px 0px 0px 8px"}})})),Ji=function(e){var t=e.setSpatialAxisFixed,n=e.spatialAxisFixed,a=e.use3d,r=Ki();return l.a.createElement(Ri.a,null,l.a.createElement(Ni.a,{className:r.cameraLabel},"Fix Camera Axis"),l.a.createElement(Ni.a,{className:r.box},l.a.createElement(Ii.a,{onClick:function(){return t(!n)},disabled:!a,checked:Boolean(n)})))};function Qi(e){var t=e.observationsLabel,n=e.cellColorEncoding,a=e.setCellColorEncoding,r=e.setSpatialAxisFixed,o=e.spatialAxisFixed,i=e.use3d;return l.a.createElement(Fi,null,l.a.createElement(Bi,{observationsLabel:t,cellColorEncoding:n,setCellColorEncoding:a}),l.a.createElement(Ji,{setSpatialAxisFixed:r,spatialAxisFixed:o,use3d:i}))}function el(e){var t=e.parentUuid,n=e.cellHighlight,a=e.width,r=e.height,i=e.getCellInfo,s=Gn(),u=Bn(t),p=n&&i?[i(n)].concat(Object(c.a)(u&&u.project?u.project(n):[null,null])):[null,null,null],d=Object(o.a)(p,3),m=d[0],f=d[1],h=d[2];return m?l.a.createElement(Ai,{x:f,y:h,parentUuid:t,sourceUuid:s,parentWidth:a,parentHeight:r},l.a.createElement(ki,{info:m})):null}var tl=["cells","molecules","raster","cell-sets","expression-matrix"];var nl=n(1422),al=Object(P.a)((function(){return{box:{opacity:.5,height:"80px",bottom:0,right:0,backgroundColor:"transparent",position:"absolute",padding:"10px 0",transition:"opacity 0.1s","&:hover":{opacity:1}}}}));function rl(e){var t=e.colorScaleLo,n=e.colorScaleHi,a=e.onColorScaleChange,r=al();return l.a.createElement(Di.a,{component:"div",m:1,className:r.box},l.a.createElement(Pi.a,{orientation:"vertical",value:[t,n],onChange:a,"aria-labelledby":"colorscale-slider",min:0,max:1,step:.005}))}function ol(e){var t=e.layer,n=e.viewport;return"axisLeft"===n.id?t.id.startsWith("axisLeft"):"axisTop"===n.id?t.id.startsWith("axisTop"):"heatmap"===n.id?t.id.startsWith("heatmap"):"colorsLeft"===n.id?t.id.startsWith("colorsLeft"):"colorsTop"===n.id&&t.id.startsWith("colorsTop")}var il=n(833),ll=n.n(il),sl="undefined"!==typeof navigator?navigator.hardwareConcurrency||4:null,cl=function(e){Object(H.a)(n,e);var t=Object(F.a)(n);function n(){return Object(z.a)(this,n),t.call(this,ll.a)}return Object(G.a)(n,[{key:"process",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a=this;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForWorker();case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,r){n.onmessage=function(t){a.finishTask(n),e(t.data)},n.onerror=function(e){a.finishTask(n),r(e)},n.postMessage(["getTile",t],[t.data])})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(function(){function e(t){Object(z.a)(this,e),this.workers=[],this.idleWorkers=[],this.waitQueue=[],this.decoder=null;for(var n=0;n<sl;++n){var a=new t;this.workers.push(a),this.idleWorkers.push(a)}}return Object(G.a)(e,[{key:"process",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error('Pool needs to implement "process" method');case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"waitForWorker",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t,n,a;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.idleWorkers.pop())){e.next=3;break}return e.abrupt("return",t);case 3:return n={},a=new Promise((function(e){n.resolve=e})),this.waitQueue.push(n),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"finishTask",value:function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.waitQueue.pop())?n.resolve(t):this.idleWorkers.push(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){for(var e=0;e<this.workers.length;++e)this.workers[e].terminate()}}]),e}()),ul=Object(i.forwardRef)((function(e,t){var n,a=e.uuid,r=e.theme,u=e.viewState,p=e.setViewState,d=e.setHeatmapControls,m=e.heatmapControls,f=void 0===m?[0,1]:m,h=e.width,g=e.height,b=e.expressionMatrix,y=e.cellColors,v=e.clearPleaseWait,O=e.setComponentHover,x=e.setCellHighlight,j=void 0===x?(n="Heatmap",function(e){return console.warn("".concat(n," updateCellsHover: ").concat(e.cellId))}):x,E=e.setGeneHighlight,C=void 0===E?function(e){return function(t){return console.warn("".concat(e," updateGenesHover: ").concat(t.geneId))}}("Heatmap"):E,S=e.updateViewInfo,w=void 0===S?function(e){return function(t){return console.warn("".concat(e," updateViewInfo: ").concat(t))}}("Heatmap"):S,L=e.setIsRendering,T=void 0===L?function(){}:L,A=e.transpose,k=void 0!==A&&A,_=e.variablesTitle,P=void 0===_?"Genes":_,N=e.observationsTitle,R=void 0===N?"Cells":N,M=Object(s.a)({},u,{target:k?[u.target[1],u.target[0]]:u.target,minZoom:0}),D=k?P:R,z=k?R:P,G=Object(i.useMemo)((function(){return new cl}),[]);Object(i.useEffect)((function(){v&&b&&v("expression-matrix")}),[v,b]);var H=Object(i.useRef)(),F=Object(i.useRef)(),X=Object(i.useState)([]),B=Object(o.a)(X,2),Z=B[0],U=B[1],V=Object(i.useState)([]),Y=Object(o.a)(V,2),W=Y[0],q=Y[1],$=Object(i.useState)(f[0]),K=Object(o.a)($,2),J=K[0],Q=K[1],ee=Object(i.useState)(f[1]),te=Object(o.a)(ee,2),ne=te[0],re=te[1],oe=Object(i.useCallback)((function(e,t){Q(t[0]),re(t[1]),d(t)}),[d]),ie=Object(i.useReducer)((function(e){return e+1}),0),le=Object(o.a)(ie,2),se=le[0],ce=le[1],ue=Object(i.useState)([]),pe=Object(o.a)(ue,2),de=pe[0],me=pe[1];Object(i.useEffect)((function(){b&&b.matrix&&(F.current=function(e){var t=new ArrayBuffer(e.buffer.byteLength),n=new Uint8Array(t);return n.set(e),n}(b.matrix))}),[F,b]),Object(i.useEffect)((function(){if(b){var e=y&&0!==y.size?Array.from(y.keys()):b.rows,t=k?W:Z;I()(t,e)||(k?q(e):U(e))}}),[b,y,W,Z,k]),Object(i.useEffect)((function(){b&&(k?U(b.cols):q(b.cols))}),[b,k]);var fe=Object(i.useMemo)((function(){return b?[Object(nl.a)(b.rows.map((function(e){return e.length}))),Object(nl.a)(b.cols.map((function(e){return e.length})))]:[0,0]}),[b]),he=Object(o.a)(fe,2),ge=he[0],be=he[1],ye=W.length,xe=Z.length,je=function(e,t,n){return[so()(9*(e?t:n),10,90),so()(9*(e?n:t),10,90)]}(k,be,ge),Ee=Object(o.a)(je,2),Ce=Ee[0],Se=Ee[1],we=Se+20,Le=Ce+20,Te=h-Le,Ae=g-we,_e=-Te/2,Ie=Te/2,Pe=-Ae/2,Ne=Ae/2,Re=Math.ceil(ye/2048),Me=Math.ceil(xe/2048),De=Te/(1-(2048-ye%2048)/(2048*Re))/Re,ze=Ae/(1-(2048-xe%2048)/(2048*Me))/Me,Ge=Math.pow(2,M.zoom),He=Ae*Ge/xe,Fe=Te*Ge/ye,Xe=so()(Math.pow(2,Math.ceil(Math.log2(1/Fe))),1,16),Be=so()(Math.pow(2,Math.ceil(Math.log2(1/He))),1,16),Ze=Object(o.a)(M.target,2),Ue=Ze[0],Ve=Ze[1];Object(i.useEffect)((function(){w({uuid:a,project:function(e,t){return function(e,t,n){var a=n.offsetLeft,r=n.offsetTop,o=n.targetX,i=n.targetY,l=n.scaleFactor,s=n.matrixWidth,c=n.matrixHeight,u=n.numRows,p=n.numCols,d=null,m=null;if(null!==t){var f=-c*l/2,h=i*l-c/2,g=i*l+c/2,b=f+(t+.5)/u*(c*l/2-f);h<=b&&b<=g&&(d=r+(b-h)/(g-h)*c)}if(null!==e){var y=-s*l/2,v=o*l-s/2,O=o*l+s/2,x=y+(e+.5)/p*(s*l/2-y);v<=x&&x<=O&&(m=a+(x-v)/(O-v)*s)}return[m,d]}(k?W.indexOf(e):W.indexOf(t),k?Z.indexOf(t):Z.indexOf(e),{offsetLeft:Le,offsetTop:we,targetX:M.target[0],targetY:M.target[1],scaleFactor:Ge,matrixWidth:Te,matrixHeight:Ae,numRows:xe,numCols:ye})}})}),[a,w,k,W,Z,Le,we,M,Ge,Te,Ae,xe,ye]);var We=Object(i.useCallback)((function(e){var t=e.viewState,n=t.zoom,a=Math.pow(2,n),r=0===n?0:-(Ie-Ie/a),o=-1*r,i=0===n?0:-(Ne-Ne/a),l=-1*i,s=[so()(t.target[0],r,o),so()(t.target[1],i,l)];p({zoom:n,target:k?[s[1],s[0]]:s})}),[Ie,Ne,k,p]);Object(i.useEffect)((function(){b&&W&&Z&&Re&&Me&&me((function(e){return[].concat(Object(c.a)(e),[ae()()])}))}),[F,b,W,Z,Re,Me]),Object(i.useEffect)((function(){if(!(de.length<1)){var e=de[de.length-1];if(F.current&&F.current.buffer.byteLength){var t=b.rows,n=b.cols,a=b.matrix,r=ke()(Me).map((function(r){return ke()(Re).map(function(){var o=Object(Oe.a)(ve.a.mark((function o(i){return ve.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",G.process({curr:e,tileI:r,tileJ:i,tileSize:2048,cellOrdering:k?W:Z,rows:t,cols:n,transpose:k,data:a.buffer.slice()}));case 1:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}())}));(function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t,n;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(r.flat());case 2:t=e.sent,H.current=t.map((function(e){return e.tile})),ce(),F.current=new Uint8Array(t[0].buffer),n=t[0].curr,me((function(e){var t=e.indexOf(n);return e.slice(t+1,e.length)}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}}}),[Z,W,de,b,k,Re,Me,G]),Object(i.useEffect)((function(){T(de.length>0)}),[de,T]);var qe=Object(i.useMemo)((function(){if(!H.current||de.length)return[];return H.current.map((function(e,t){return function(e,t,n){return new Yo({id:"heatmapLayer-".concat(se,"-").concat(e,"-").concat(t),image:n,bounds:[_e+t*De,Pe+e*ze,_e+(t+1)*De,Pe+(e+1)*ze],aggSizeX:Xe,aggSizeY:Be,colorScaleLo:J,colorScaleHi:ne,updateTriggers:{image:[Z,W],bounds:[ze,De]}})}(Math.floor(t/Re),t%Re,e)}))}),[de,se,_e,De,Pe,ze,Xe,Be,J,ne,Z,W,Re]),$e=Object(i.useMemo)((function(){return W.map((function(e,t){return[t,e]}))}),[W]),Ke=Object(i.useMemo)((function(){return Z.map((function(e,t){return[t,e]}))}),[Z]),Je=[new $o({targetX:Ue,targetY:Ve,scaleFactor:Ge,axisLeftLabelData:Ke,matrixTop:Pe,height:xe,matrixHeight:Ae,cellHeight:He,cellWidth:Fe,axisTopLabelData:$e,matrixLeft:_e,width:ye,matrixWidth:Te,viewHeight:g,viewWidth:h,theme:r,axisLeftTitle:D,axisTopTitle:z,axisOffsetLeft:Ce,axisOffsetTop:Se})],Qe=Object(i.useMemo)((function(){if(!y)return null;var e,t,n,a,r=k?W:Z,i=k?2048:1,l=k?1:2048;return ke()(k?Re:Me).map((function(s){var c=new Uint8ClampedArray(8192);return ke()(2048).forEach((function(i){if((a=2048*s+i)<r.length&&(e=r[a],n=y.get(e),t=4*(k?i:2048-i-1),n)){var l=n,u=Object(o.a)(l,3),p=u[0],d=u[1],m=u[2];c[t+0]=p,c[t+1]=d,c[t+2]=m,c[t+3]=255}})),new ImageData(c,i,l)}))}),[y,k,W,Z,Re,Me]),et=Object(i.useMemo)((function(){return Qe?Qe.map((function(e,t){return new qo({id:"".concat(k?"colorsTopLayer":"colorsLeftLayer","-").concat(t,"-").concat(ae()()),image:e,bounds:k?[_e+t*De,-Ae/2,_e+(t+1)*De,Ae/2]:[-Te/2,Pe+t*ze,Te/2,Pe+(t+1)*ze]})})):[]}),[Qe,Pe,_e,Ae,Te,De,ze,k]),tt=qe.concat(Je).concat(et);return l.a.createElement(l.a.Fragment,null,l.a.createElement(Qo.a,{id:"deckgl-overlay-".concat(a),ref:t,views:[new ti.a({id:"heatmap",controller:!0,x:Le,y:we,width:Te,height:Ae}),new ti.a({id:"axisLeft",controller:!1,x:k?20:0,y:we,width:Ce,height:Ae}),new ti.a({id:"axisTop",controller:!1,x:Le,y:k?0:20,width:Te,height:Se}),new ti.a({id:"colorsLeft",controller:!1,x:Ce,y:we,width:17,height:Ae}),new ti.a({id:"colorsTop",controller:!1,x:Le,y:Se,width:Te,height:17})],layers:tt,layerFilter:ol,getCursor:function(e){return e.isDragging?"grabbing":"default"},glOptions:Ye,onViewStateChange:We,viewState:M,onHover:function(e,t){if(b){var n=t.offsetCenter,a=function(e,t,n){var a=n.offsetLeft,r=n.offsetTop,o=n.targetX,i=n.targetY,l=n.scaleFactor,s=n.matrixWidth,c=n.matrixHeight,u=n.numRows,p=n.numCols,d=e-a,m=t-r;if(d<0||m<0)return[null,null];var f=(o*l+s*l/2-s/2)/(s*l)+d/(s*l),h=(i*l+c*l/2-c/2)/(c*l)+m/(c*l),g=Math.floor(h*u);return[Math.floor(f*p),g]}(n.x,n.y,{offsetLeft:Le,offsetTop:we,targetX:Ue,targetY:Ve,scaleFactor:Ge,matrixWidth:Te,matrixHeight:Ae,numRows:xe,numCols:ye}),r=Object(o.a)(a,2),i=r[0],l=r[1];null===i&&(k?j(null):C(null)),null===l&&(k?C(null):j(null));var s=b.rows.indexOf(k?W[i]:Z[l]),c=b.cols.indexOf(k?Z[l]:W[i]),u=b.rows[s],p=b.cols[c];O&&O(),j(u||null),C(p||null)}}}),l.a.createElement(rl,{colorScaleLo:J,colorScaleHi:ne,onColorScaleChange:oe}))}));function pl(e){var t=e.parentUuid,n=e.width,a=e.height,r=e.transpose,i=e.getCellInfo,c=e.getGeneInfo,u=e.cellHighlight,p=e.geneHighlight,d=Gn(),m=Bn(t),f=u&&i?[i(u),m&&m.project?m.project(u,null)[r?0:1]:null]:[null,null],h=Object(o.a)(f,2),g=h[0],b=h[1],y=p&&c?[c(p),m&&m.project?m.project(null,p)[r?1:0]:null]:[null,null],v=Object(o.a)(y,2),O=v[0],x=v[1],j=r?b:x,E=r?x:b;return g||O?l.a.createElement(Ai,{x:j,y:E,parentUuid:t,parentWidth:n,parentHeight:a,sourceUuid:d},l.a.createElement(ki,{info:Object(s.a)({},O,{},g)})):null}var dl=["cells","cell-sets","expression-matrix"];var ml=n(1423),fl=n(835),hl=n.n(fl),gl=n(834),bl=n.n(gl),yl=Object(P.a)((function(e){return{container:{width:"70px",height:"40px",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap"},button:{padding:"3px",width:"16px"},icon:{width:"17px",height:"17px",stroke:e.palette.action.selected,"stroke-width":"1px"}}})),vl=function(e){var t=e.handleChange,n=yl();return l.a.createElement("div",{className:n.container,"aria-label":"color-swatch"},Ue.map((function(e){return l.a.createElement(Aa.a,{className:n.button,key:e,onClick:function(){return t(e)}},l.a.createElement(bl.a,{fontSize:"small",style:{color:"rgb(".concat(e,")")},className:n.icon}))})))},Ol=Object(P.a)((function(){return{menuButton:{backgroundColor:"transparent"},colors:{"&:hover":{backgroundColor:"transparent"},paddingLeft:"2px",paddingRight:"2px"}}}));var xl=function(e){var t=e.handlePropertyChange,n=e.handleChannelRemove,a=e.handleIQRUpdate,r=Object(i.useReducer)((function(e){return!e}),!1),s=Object(o.a)(r,2),c=s[0],u=s[1],p=Ol();return l.a.createElement(Wa,{open:c,toggle:u,buttonIcon:l.a.createElement(hl.a,{fontSize:"small"}),buttonClassName:p.menuButton},l.a.createElement(Ta.a,{dense:!0,disableGutters:!0,onClick:function(){u(),n()}},l.a.createElement(Ya,null,"Remove")),l.a.createElement(Ta.a,{dense:!0,disableGutters:!0,onClick:a},l.a.createElement(Ya,null,"Use IQR")),l.a.createElement(Ta.a,{dense:!0,disableGutters:!0,className:p.colors},l.a.createElement(vl,{handleChange:function(e){t("color",e)}})))};var jl=function(){var e={},t=["Int8","Int16","Int32"];return Object.keys(Pe.a).forEach((function(n){var a=Pe.a[n].max,r=t.includes(n)?-(a+1):0;e[n]=[r,a]})),e}();function El(e){var t=e.handleChange,n=e.disabled,a=e.channelOptions,r=e.selectionIndex;return l.a.createElement(Xi.a,{native:!0,value:r,onChange:function(e){return t(Number(e.target.value))}},a.map((function(e,t){return l.a.createElement("option",{disabled:n,key:e,value:t},e)})))}function Cl(e){var t=e.color,n=e.checked,a=e.toggle,r=e.disabled;return l.a.createElement(Ii.a,{onChange:a,checked:n,disabled:r,style:{color:t,"&$checked":{color:t}}})}function Sl(e){var t=5;Number.isInteger(e)||--t,e<1&&--t;var n=Intl.NumberFormat("en-US",{maximumSignificantDigits:t,useGrouping:!1}).format(e);return n.length<=5?n:e.toExponential(0)}function wl(e){var t=e.color,n=e.slider,a=void 0===n?[0,0]:n,r=e.handleChange,s=e.domain,c=void 0===s?[0,0]:s,u=e.dtype,p=e.disabled,d=Object(o.a)(c,2),m=d[0],f=d[1],h=Object(i.useCallback)(ca()(r,3,{trailing:!0}),[r]),g=f-m<500&&"Float32"===u?(f-m)/500:1;return l.a.createElement(Pi.a,{value:a,valueLabelFormat:Sl,onChange:function(e,t){return h(t)},valueLabelDisplay:"auto",getAriaLabel:function(){return"".concat(t,"-").concat(a)},min:m,max:f,step:g,orientation:"horizontal",style:{color:t,marginTop:"7px"},disabled:p})}var Ll=function(e){var t=e.visibility,n=void 0!==t&&t,a=e.slider,r=e.color,c=e.channels,u=e.channelId,p=e.domainType,d=e.dimName,m=e.theme,f=e.loader,h=e.colormapOn,g=e.channelOptions,b=e.handlePropertyChange,y=e.handleChannelRemove,v=e.handleIQRUpdate,O=e.selectionIndex,x=e.isLoading,j=e.use3d,E=W(f).dtype,C=Object(i.useState)(null),S=Object(o.a)(C,2),w=S[0],L=S[1],T=Object(i.useState)(null),A=Object(o.a)(T,2),k=A[0],_=A[1],P=Object(i.useState)(null),N=Object(o.a)(P,2),R=N[0],M=N[1],D=Object(i.useState)([Object(s.a)({},c[u].selection)]),z=Object(o.a)(D,2),G=z[0],H=z[1],F=function(e,t,n){var a=e||"light"===n&&t.every((function(e){return 255===e}))?[220,220,220]:t;return"rgb(".concat(a,")")}(h,r,m);return Object(i.useEffect)((function(){var e=!0;if(E&&f&&c){var t=[Object(s.a)({},c[u].selection)],n=p!==k,a=R!==j,r=!I()(t,G);if(n||r||a)if("Full"===p){var i=[jl[E]],l=Object(o.a)(i,1)[0];e&&(L(l),_(p),r&&H(t),a&&M(j))}else ht({loader:f.data,selections:t,use3d:j}).then((function(n){var i=n.domains,l=Object(o.a)(i,1)[0];e&&(L(l),_(p),r&&H(t),a&&M(j))}))}return function(){e=!1}}),[k,c,u,f,E,p,G,j,R]),l.a.createElement(ml.a,{container:!0,direction:"column",m:1,justify:"center"},l.a.createElement(ml.a,{container:!0,direction:"row",justify:"space-between"},l.a.createElement(ml.a,{item:!0,xs:10},l.a.createElement(El,{handleChange:function(e){return b("selection",(t=e,Object(B.a)({},d,t)));var t},selectionIndex:O,channelOptions:g,disabled:x})),l.a.createElement(ml.a,{item:!0,xs:1,style:{marginTop:"4px"}},l.a.createElement(xl,{handlePropertyChange:b,handleChannelRemove:y,handleIQRUpdate:v,disabled:x}))),l.a.createElement(ml.a,{container:!0,direction:"row",justify:"space-between"},l.a.createElement(ml.a,{item:!0,xs:2},l.a.createElement(Cl,{color:F,checked:n,toggle:function(){return b("visible",!n)},disabled:x})),l.a.createElement(ml.a,{item:!0,xs:9},l.a.createElement(wl,{color:F,slider:a,domain:w||jl[E],dtype:E,handleChange:function(e){return b("slider",e)},disabled:x}))))},Tl=n(836),Al=n.n(Tl);var kl=function(e){var t=e.visibility,n=void 0!==t&&t,a=e.dimName,r=e.channelOptions,o=e.handlePropertyChange,i=e.handleChannelRemove,s=e.selectionIndex,c=e.disableOptions,u=void 0!==c&&c;return l.a.createElement(ml.a,{container:!0,direction:"row",justify:"space-between"},l.a.createElement(ml.a,{item:!0,xs:2},l.a.createElement(Cl,{color:[220,220,220],checked:n,toggle:function(){return o("visible",!n)}})),l.a.createElement(ml.a,{item:!0,xs:9},l.a.createElement(El,{handleChange:function(e){return o("selection",(t=e,Object(B.a)({},a,t)));var t},selectionIndex:s,disableOptions:u,channelOptions:r})),l.a.createElement(ml.a,{item:!0,xs:1},l.a.createElement(Aa.a,{onClick:i,style:{padding:"6px 6px 6px 0px"}},l.a.createElement(Al.a,null))))},_l=n(1325),Il=n(35),Pl=n(1425),Nl=n(1424),Rl=n(1453),Ml=(Object(Il.a)((function(e){return{paper:{backgroundColor:e.palette.background.paper},span:{width:"70px",textAlign:"center",paddingLeft:"2px",paddingRight:"2px"},colors:{"&:hover":{backgroundColor:"transparent"},paddingLeft:"2px",paddingRight:"2px"},popper:{zIndex:4}}})),{width:"100%",flexDirection:"column"}),Dl=Object(P.a)((function(){return{root:Object(s.a)({},Ml,{padding:"0px 8px"})}})),zl=Object(Il.a)((function(){return{root:Object(s.a)({},Ml,{padding:"8px 8px 24px 8px"})}}))(Nl.a),Gl=Object(Il.a)((function(e){return{root:{padding:"0px 8px"},content:{margin:"4px 0px",minWidth:"0px"},expanded:{marginBottom:e.spacing(-3),top:e.spacing(-1)},expandIcon:{"&$expanded":{top:e.spacing(-1.3)}}}}))(Pl.a),Hl=Object(Il.a)((function(){return{root:{fontSize:"14px"}}}))(Rl.a),Fl=Object(Il.a)((function(){return{item:{width:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}}}))(ml.a),Xl=Object(Il.a)((function(){return{root:{marginTop:"7px"},markActive:{backgroundColor:"rgba(128, 128, 128, 0.7)"}}}))(Pi.a);function Bl(e){var t=e.label,n=e.layer,a=e.layerType,r=e.handleLayerChange,o=n.opacity,i=n.visible;var c=Dl();return l.a.createElement(ml.a,{item:!0,style:{marginTop:"10px"}},l.a.createElement(Fa.a,{className:c.root},l.a.createElement(_l.a,{style:{padding:"15px 8px 0px 8px",marginBottom:"-5px"}},t),l.a.createElement(ml.a,{container:!0,direction:"row",justify:"space-between"},l.a.createElement(ml.a,{item:!0,xs:2},l.a.createElement(Ii.a,{color:"primary",checked:i,onChange:function(e,t){return function(e){r(Object(s.a)({},n,{visible:e}))}(t)}})),l.a.createElement(ml.a,{item:!0,xs:9,style:{paddingRight:"8px"}},l.a.createElement(Pi.a,{value:o,min:0,max:1,step:.001,onChange:function(e,t){return function(e){if("cells"===a){var t=e<.7;r(Object(s.a)({},n,{opacity:e,stroked:t}))}else r(Object(s.a)({},n,{opacity:e}))}(t)},style:{marginTop:"7px"},orientation:"horizontal"})))))}var Zl=n(1427),Ul=n(475),Vl=n.n(Ul),Yl=n(1439),Wl=n(1428),ql=n(1444),$l=n(839),Kl=n.n($l),Jl=n(837),Ql=n.n(Jl),es=n(838),ts=n.n(es),ns=["Full","Min/Max"];var as=function(e,t){var n=e[t],a=n.shape,r=n.labels,o=a[r.indexOf("y")],i=a[r.indexOf("x")],l=a[r.indexOf("z")],s=Math.floor(l/Math.pow(2,t));return{height:o,width:i,depthDownsampled:s,totalBytes:4*o*i*s}};function rs(e){var t=e.loader,n=e.handleMultiPropertyChange,a=e.resolution,r=e.disable3d,i=e.setRasterLayerCallback,u=e.setAreAllChannelsLoading,p=e.setViewState,d=e.spatialHeight,m=e.spatialWidth,f=e.channels,h=e.use3d,g=e.modelMatrix,b=f.map((function(e){return e.selection})),y=t.data,v=function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var a,r,l,v,O,x,j,E,C,S,w,L,T,A;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="number"===typeof t,u(!0),i((function(){u(!1),i(null)})),!a){e.next=18;break}if(r=gt(y),l=Object(o.a)(r,3),v=l[0],O=l[1],x=l[2],j={resolution:t,xSlice:v,ySlice:O,zSlice:x,use3d:a},h){e.next=13;break}return e.next=9,ht({loader:y,selections:b,use3d:a});case 9:E=e.sent,C=E.sliders,j.channels=Object(c.a)(f),j.channels.forEach((function(e,t){e.slider=C[t]}));case 13:n(j),S=Object(Pe.k)(y,{height:d,width:m},1.5,!0,new Me.Matrix4(g)),p(Object(s.a)({},S,{rotationX:0,rotationOrbit:0})),e.next=27;break;case 18:return e.next=20,ht({loader:y,selections:b,use3d:a});case 20:w=e.sent,L=w.sliders,(T=Object(c.a)(f)).forEach((function(e,t){e.slider=L[t]})),n({resolution:t,use3d:a,spatialAxisFixed:!1,channels:T}),A=Object(Pe.k)(y,{height:d,width:m},.5,!1,new Me.Matrix4(g)),p(Object(s.a)({},A,{rotationX:null,rotationOrbit:null,orbitAxis:null}));case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=Array.isArray(y)?y[0]:y,x=O.labels,j=O.shape[x.indexOf("z")]>1;return l.a.createElement(l.a.Fragment,null,l.a.createElement(Xi.a,{native:!0,value:a,onChange:function(e){return v("2D"===e.target.value?e.target.value:Number(e.target.value))}},l.a.createElement("option",{key:"2D",value:"2D"},"2D Visualization"),Array.from({length:y.length}).fill(0).map((function(e,t){if(y&&function(e,t){var n,a,r;return as(e,t).totalBytes<((null===(n=window.performance)||void 0===n?void 0:n.memory)&&(null===(a=window.performance)||void 0===a||null===(r=a.memory)||void 0===r?void 0:r.jsHeapSizeLimit)/2||Math.pow(2,31)-1)}(y,t)){var n=as(y,t),a=n.height,o=n.width,i=n.depthDownsampled,s=n.totalBytes;return l.a.createElement("option",{key:"(".concat(a,", ").concat(o,", ").concat(i,")"),value:t,disabled:r||!j},"3D: ".concat(t,"x Downsampled, ~").concat(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var n=1024,a=t<0?0:t,r=["Bytes","KB","MB","GB"],o=Math.floor(Math.log(e)/Math.log(n));return"".concat(parseFloat((e/Math.pow(n,o)).toFixed(a))," ").concat(r[o])}(s)," per channel, (").concat(a,", ").concat(o,", ").concat(i,")"))}return null}))))}function os(e){var t=e.value,n=e.inputId,a=e.handleChange;return l.a.createElement(Xi.a,{native:!0,onChange:function(e){return a(""===e.target.value?null:e.target.value)},value:t,inputProps:{name:"colormap",id:n},style:{width:"100%"}},l.a.createElement("option",{"aria-label":"None",value:""},"None"),Ve.map((function(e){return l.a.createElement("option",{key:e,value:e},e)})))}function is(e){var t=e.value,n=e.handleChange;return l.a.createElement(Ii.a,{style:{float:"left",padding:0},color:"default",onChange:function(){n(t?null:[0,0,0])},checked:Boolean(t)})}function ls(e){var t=e.value,n=e.handleChange;return l.a.createElement(Pi.a,{value:t,onChange:function(e,t){return n(t)},valueLabelDisplay:"auto",getAriaLabel:function(){return"opacity slider"},min:0,max:1,step:.01,orientation:"horizontal",style:{marginTop:"7px"}})}function ss(e){var t=e.value,n=e.inputId,a=e.handleChange;return l.a.createElement(Xi.a,{native:!0,onChange:function(e){return a(e.target.value)},value:t,inputProps:{name:"domain-selector",id:n},style:{width:"100%"}},ns.map((function(e){return l.a.createElement("option",{key:e,value:e},e)})))}function cs(e){var t=e.field,n=e.value,a=e.handleChange,r=e.possibleValues;return l.a.createElement(Xl,{value:n,onChange:function(e,n){a({selection:Object(B.a)({},t,n),event:e})},onChangeCommitted:function(e,n){a({selection:Object(B.a)({},t,n),event:e})},valueLabelDisplay:"auto",getAriaLabel:function(){return"".concat(t," slider")},marks:r.map((function(e){return{value:e}})),min:Number(r[0]),max:Number(r.slice(-1)),orientation:"horizontal",step:null})}function us(e){var t=e.name,n=e.inputId,a=e.children;return l.a.createElement(ml.a,{container:!0,direction:"row",alignItems:"center",justify:"center"},l.a.createElement(ml.a,{item:!0,xs:6},l.a.createElement(Rl.a,{htmlFor:n},t,":")),l.a.createElement(ml.a,{item:!0,xs:6},a))}var ps=function(e){var t=e.colormap,n=e.opacity,a=e.handleColormapChange,r=e.handleOpacityChange,o=e.handleTransparentColorChange,i=e.globalControlLabels,s=e.globalLabelValues,c=e.handleGlobalChannelsSelectionChange,u=e.handleSliderChange,p=e.handleDomainChange,d=e.transparentColor,m=e.channels,f=e.domainType,h=e.isRgb,g=e.shouldShowTransparentColor,b=e.shouldShowDomain,y=e.shouldShowColormap,v=e.use3d,O=e.loader,x=e.handleMultiPropertyChange,j=e.resolution,E=e.disable3d,C=e.setRasterLayerCallback,S=e.setAreAllChannelsLoading,w=e.setViewState,L=e.spatialHeight,T=e.spatialWidth,A=e.modelMatrix,k=Array.isArray(O.data)?O.data[0]:O.data,_=k.labels,I=k.shape,P=_.length>0&&m.length>0,N=I[_.indexOf("z")]>1;return l.a.createElement(ml.a,{container:!0,direction:"column",style:{width:"100%"}},N&&!E&&l.a.createElement(rs,{loader:O,handleSliderChange:u,handleDomainChange:p,channels:m,handleMultiPropertyChange:x,resolution:j,disable3d:E,setRasterLayerCallback:C,setAreAllChannelsLoading:S,setViewState:w,spatialHeight:L,spatialWidth:T,use3d:v,modelMatrix:A}),P&&!v&&i.map((function(e){return I[_.indexOf(e)]>1&&l.a.createElement(us,{name:e,inputId:"".concat(e,"-slider"),key:e},l.a.createElement(cs,{field:e,value:s[e],handleChange:c,possibleValues:ke()(I[_.indexOf(e)])}))})),h?null:l.a.createElement(l.a.Fragment,null,y&&l.a.createElement(ml.a,{item:!0},l.a.createElement(us,{name:"Colormap",inputId:"colormap-select"},l.a.createElement(os,{value:t||"",inputId:"colormap-select",handleChange:a}))),b&&l.a.createElement(ml.a,{item:!0},l.a.createElement(us,{name:"Domain",inputId:"domain-selector"},l.a.createElement(ss,{value:f||"Min/Max",handleChange:function(e){p(e)}})))),!v&&l.a.createElement(ml.a,{item:!0},l.a.createElement(us,{name:"Opacity",inputId:"opacity-slider"},l.a.createElement(ls,{value:n,handleChange:r}))),g&&!v&&l.a.createElement(ml.a,{item:!0},l.a.createElement(us,{name:"Zero Transparent",inputId:"transparent-color-selector"},l.a.createElement(is,{value:d,handleChange:o}))))},ds=n(1426),ms=Object(P.a)((function(e){return Object($i.a)({enabled:{},disabled:{color:e.palette.text.disabled,"& .MuiSlider-thumb":{color:"rgb(100, 100, 100, 1.0)"},"&  .MuiSlider-track":{color:"rgb(100, 100, 100, 1.0)"}}})})),fs=function(e){var t=e.xSlice,n=e.ySlice,a=e.zSlice,r=e.handleSlicerSetting,i=e.loader,s=e.use3d,c=gt(i.data),u=Object(o.a)(c,3),p=[[t,function(e){return r("x",e)},"x",u[0]],[n,function(e){return r("y",e)},"y",u[1]],[a,function(e){return r("z",e)},"z",u[2]]],d=ms(),m=p.map((function(e){var t=Object(o.a)(e,4),n=t[0],a=t[1],r=t[2],i=Object(o.a)(t[3],2),c=i[0],u=i[1];return l.a.createElement(ml.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center",key:r},l.a.createElement(ml.a,{item:!0,xs:1},l.a.createElement(_l.a,{className:s?d.enabled:d.disabled,style:{marginBottom:0}},r,":")),l.a.createElement(ml.a,{item:!0,xs:11},l.a.createElement(Pi.a,{disabled:!s,className:s?d.enabled:d.disabled,value:n,onChange:function(e,t){return a(t)},valueLabelDisplay:"auto",valueLabelFormat:function(e){return function(e){var t=5;Number.isInteger(e)||--t,e<1&&--t;var n=Intl.NumberFormat("en-US",{maximumSignificantDigits:t,useGrouping:!1}).format(e);return n.length<=5?n:e.toExponential(0)}(e)},getAriaLabel:function(){return"".concat(r," slider")},min:c,max:u,step:.005,orientation:"horizontal"})))}));return l.a.createElement(l.a.Fragment,null,l.a.createElement(_l.a,{className:s?d.enabled:d.disabled,style:{marginTop:16,marginBottom:0}},"Clipping Planes:"," ")," ",m)},hs=Object.values(Pe.e);function gs(e){var t=e.handleRenderingModeChange,n=e.renderingMode,a=e.use3d,r=a?hs:[].concat(Object(c.a)(hs),[""]);return l.a.createElement(ds.a,{fullWidth:!0},l.a.createElement(Rl.a,{htmlFor:"rendering-mode-select"},"Rendering Mode"),l.a.createElement(Xi.a,{native:!0,onChange:function(e){return t(e.target.value)},value:a?n:"",inputProps:{name:"rendering-mode",id:"rendering-mode-select"},disabled:!a},r.map((function(e){return l.a.createElement("option",{key:e,value:e},e)}))))}var bs=function(e){var t=e.setViewState,n=e.use3d,a=e.spatialHeight,r=e.spatialWidth,o=e.loader,i=e.modelMatrix;return l.a.createElement(ml.a,{item:!0,xs:"auto",key:"recenter"},l.a.createElement(Zl.a,{onClick:function(){var e=Object(Pe.k)(o.data,{height:a,width:r},1.5,n,new Me.Matrix4(i));t(Object(s.a)({},e,{rotationX:0,rotationOrbit:0}))},disabled:!n,style:{padding:0,marginBottom:6}},"Re-Center"))},ys=function(e){var t=e.handleSlicerSetting,n=e.handleRenderingModeChange,a=e.renderingMode,r=e.xSlice,o=e.ySlice,i=e.zSlice,s=e.use3d,c=e.loader,u=e.setViewState,p=e.spatialHeight,d=e.spatialWidth,m=e.modelMatrix;return l.a.createElement(l.a.Fragment,null,l.a.createElement(gs,{handleRenderingModeChange:n,renderingMode:a,use3d:s}),l.a.createElement(fs,{xSlice:r,ySlice:o,zSlice:i,handleSlicerSetting:t,use3d:s,loader:c}),l.a.createElement(bs,{setViewState:u,use3d:s,spatialHeight:p,spatialWidth:d,loader:c,modelMatrix:m}))};function vs(e){var t=e.children,n=e.value,a=e.index,r=Object(vr.a)(e,["children","value","index"]);return l.a.createElement("div",Object.assign({role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},r),n===a&&t)}function Os(e,t,n,a){return xs.apply(this,arguments)}function xs(){return(xs=Object(Oe.a)(ve.a.mark((function e(t,n,a,r){var o,i,l,s;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht({loader:t.data,selections:n,use3d:r});case 2:return i=e.sent,l=i.sliders,"Min/Max"===a&&(o=i.domains),"Full"===a&&(s=W(t),o=n.map((function(){return jl[s.dtype]}))),e.abrupt("return",{domains:o,sliders:l});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var js={borderStyle:"dashed",marginTop:"10px",fontWeight:400};function Es(e){var t,n=e.layer,a=e.name,r=e.loader,u=e.theme,p=e.handleLayerRemove,d=e.handleLayerChange,m=e.shouldShowTransparentColor,f=e.shouldShowDomain,h=e.shouldShowColormap,g=e.ChannelController,b=e.setViewState,y=e.disable3d,v=e.setRasterLayerCallback,O=e.setAreLayerChannelsLoading,x=e.areLayerChannelsLoading,j=e.disabled,E=e.spatialHeight,C=e.spatialWidth,S=n.colormap,w=n.opacity,L=n.channels,T=n.transparentColor,A=n.renderingMode,k=n.xSlice,_=n.ySlice,I=n.zSlice,P=n.resolution,N=n.use3d,R=n.modelMatrix,M=(null===(t=L[0])||void 0===t?void 0:t.selection)||{},D=r.data,z=r.channels,G=Object(i.useState)(0),H=Object(o.a)(G,2),F=H[0],X=H[1],Z=Array.isArray(D)?D[D.length-1]:D,U=Z.labels,V=Z.shape,Y=Object(i.useState)(n.domainType),W=Object(o.a)(Y,2),$=W[0],K=W[1],J=Object(i.useState)(!0),Q=Object(o.a)(J,2),ee=Q[0],te=Q[1],ne=Object(i.useState)(Je.filter((function(e){return"number"===typeof M[e]})).reduce((function(e,t){return Object(s.a)({},e,Object(B.a)({},t,M[t]))}),{})),ae=Object(o.a)(ne,2),re=ae[0],oe=ae[1];function ie(e){d(Object(s.a)({},n,{opacity:e}))}function le(e){d(Object(s.a)({},n,{channels:e}))}function se(e,t){d(Object(s.a)({},n,{channels:e,domainType:t}))}function ce(e,t){var a=Object(c.a)(L);a[t]=e,d(Object(s.a)({},n,{channels:a}))}function ue(e){var t=[].concat(Object(c.a)(L),[e]);d(Object(s.a)({},n,{channels:t}))}var pe=function(e){var t=L.map((function(){return e}));O(t)},de=function(){var e=Object(Oe.a)(ve.a.mark((function e(){var t,n,a,o,i,l,u,p,d,m;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},U.forEach((function(e){t[e]=Je.includes(e)&&re[e]||0})),e.next=4,Os(r,[t],$,N);case 4:n=e.sent,a=n.domains,o=n.sliders,i=a[0],l=i,u=[255,255,255],!0,p=L.length,(d=Object(c.a)(x))[p]=!0,O(d),m={selection:t,slider:l,visible:!0,color:u},v((function(){ce(Object(s.a)({},m,{slider:o[0]}),p);var e=Object(c.a)(d);e[p]=!1,O(e),v(null)})),ue(m);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),me=function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a,i,l;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K(t),n=L.map((function(e){return e.selection})),a=L.map((function(e){return e.slider})),e.next=5,Os(r,n,t,N);case 5:i=e.sent,l=i.domains,a=a.map((function(e,t){var n=Object(o.a)(e,2),a=n[0],r=n[1];return[Math.max(a,l[t][0]),Math.min(r,l[t][1])]})),se(L.map((function(e,t){return Object(s.a)({},e,{slider:a[t]})})),t);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a,o;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.selection,a=t.event,o=L.map((function(e){return Object(s.a)({},e.selection,{},n)})),("mouseup"===a.type||"keydown"===a.type)&&(pe(!0),Os(r,o,$,N).then((function(e){var t=e.sliders,a=L.map((function(e){return Object(s.a)({},e,{selection:Object(s.a)({},e.selection,{},n)})}));v((function(){v(null),pe(!1),le(Object(c.a)(a).map((function(e,n){return Object(s.a)({},e,{slider:t[n]})})))})),le(a)}))),oe((function(e){return Object(s.a)({},e,{},n)}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=[];if(U.length>0){var ge=U.find((function(e){return"channel"===e||"c"===e}))||U[0];he=L.map((function(e,t){var a=function(e){var n=Object(c.a)(x);n[t]=e,O(n)},i=function(){var n=Object(Oe.a)(ve.a.mark((function n(){var a,o,i,l,c,u;return ve.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=r.data,o=Array.isArray(a)?a[a.length-1]:a,n.next=4,o.getRaster({selection:L[t].selection});case 4:i=n.sent,l=Object(Pe.j)(i.data),c=l.q1,u=l.q3,ce(Object(s.a)({},e,{slider:[c,u]}),t);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return l.a.createElement(g,{key:"channel-controller-".concat(t),dimName:ge,visibility:e.visible,selectionIndex:e.selection[ge],slider:e.slider,color:e.color,channels:L,channelId:t,domainType:$,loader:r,globalLabelValues:re,theme:u,channelOptions:z,colormapOn:Boolean(S),handlePropertyChange:function(n,i){var l=Object(B.a)({},n,i);"selection"===n?(a(!0),l.selection=Object(s.a)({},re,{},l.selection),ce(Object(s.a)({},e,{},l),t),v(Object(Oe.a)(ve.a.mark((function c(){var u,p,d,m;return ve.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return u=[Object(s.a)({},L[t][n],{},i)],c.next=3,Os(r,u,$,N);case 3:p=c.sent,d=p.sliders,m=Object(o.a)(d,1),l.slider=m[0],ce(Object(s.a)({},e,{},l),t),v(null),a(!1);case 10:case"end":return c.stop()}}),c)}))))):ce(Object(s.a)({},e,{},l),t)},handleChannelRemove:function(){!function(e){var t=Object(c.a)(L);t.splice(e,1),d(Object(s.a)({},n,{channels:t}))}(t)},handleIQRUpdate:i,setRasterLayerCallback:v,isLoading:x[t],use3d:N})}))}var be=Dl(),ye=n.visible,xe="boolean"!==typeof ye||ye?Ql.a:ts.a,je=!y&&V[U.indexOf("z")]>1,Ee=l.a.createElement(l.a.Fragment,null,l.a.createElement(ps,{channels:L,opacity:w,colormap:S,transparentColor:T,domainType:$,globalControlLabels:U.filter((function(e){return Je.includes(e)})),globalLabelValues:re,handleOpacityChange:ie,handleColormapChange:function(e){d(Object(s.a)({},n,{colormap:e}))},handleGlobalChannelsSelectionChange:fe,handleTransparentColorChange:function(e){d(Object(s.a)({},n,{transparentColor:e}))},isRgb:q(r),handleDomainChange:me,shouldShowTransparentColor:m,shouldShowDomain:f,shouldShowColormap:h,use3d:N,loader:r,handleMultiPropertyChange:function(e){d(Object(s.a)({},n,{},e))},resolution:P,disable3d:y,setRasterLayerCallback:v,setAreAllChannelsLoading:pe,setViewState:b,spatialHeight:E,spatialWidth:C,modelMatrix:R}),q(r)?null:he,!q(r)&&l.a.createElement(Zl.a,{disabled:L.length===Pe.c,onClick:de,fullWidth:!0,variant:"outlined",style:js,startIcon:l.a.createElement(Vl.a,null),size:"small"},"Add Channel"));return l.a.createElement(ql.a,{className:be.root,onChange:function(e,t){var n,a,r;return!j&&te(t&&"presentation"===(null===e||void 0===e||null===(n=e.target)||void 0===n||null===(a=n.attributes)||void 0===a||null===(r=a.role)||void 0===r?void 0:r.value))},TransitionProps:{enter:!1},expanded:!j&&ee},l.a.createElement(Gl,{expandIcon:l.a.createElement(Kl.a,null),"aria-controls":"layer-".concat(a,"-controls")},l.a.createElement(ml.a,{container:!0,direction:"column",m:1,justify:"center"},l.a.createElement(Fl,{item:!0},l.a.createElement(Zl.a,{onClick:function(e){var t;j||(e.stopPropagation(),t="boolean"===typeof ye&&!ye,d(Object(s.a)({},n,{visible:t})))},style:{marginRight:8,marginBottom:2,padding:0,minWidth:0}},l.a.createElement(xe,null)),a),!j&&!ee&&!N&&l.a.createElement(ml.a,{container:!0,direction:"row",alignItems:"center",justify:"center"},l.a.createElement(ml.a,{item:!0,xs:6},l.a.createElement(Hl,{htmlFor:"layer-".concat(a,"-opacity-closed")},"Opacity:")),l.a.createElement(ml.a,{item:!0,xs:6},l.a.createElement(Pi.a,{id:"layer-".concat(a,"-opacity-closed"),value:w,onChange:function(e,t){return ie(t)},valueLabelDisplay:"auto",getAriaLabel:function(){return"opacity slider"},min:0,max:1,step:.01,orientation:"horizontal"}))))),l.a.createElement(zl,null,je?l.a.createElement(l.a.Fragment,null,l.a.createElement(Yl.a,{value:F,onChange:function(e,t){X(t)},"aria-label":"simple tabs example",style:{height:"24px",minHeight:"24px"}},l.a.createElement(Wl.a,{label:"Channels",style:{fontSize:".75rem",bottom:12,width:"50%",minWidth:"50%"},disableRipple:!0}),l.a.createElement(Wl.a,{label:"Volume",style:{fontSize:".75rem",bottom:12,width:"50%",minWidth:"50%"}})),l.a.createElement(vs,{value:F,index:0},Ee),l.a.createElement(vs,{value:F,index:1,style:{marginTop:4}},l.a.createElement(ys,{loader:r,handleSlicerSetting:function(e,t){d(Object(s.a)({},n,Object(B.a)({},"".concat(e,"Slice"),t)))},handleRenderingModeChange:function(e){d(Object(s.a)({},n,{renderingMode:e}))},renderingMode:A,xSlice:k,ySlice:_,zSlice:I,use3d:N,setViewState:b,spatialHeight:E,spatialWidth:C,modelMatrix:R}))):Ee,l.a.createElement(Zl.a,{onClick:p,fullWidth:!0,variant:"outlined",style:js,size:"small"},"Remove Image Layer")))}var Cs=Object(P.a)((function(){return{addButton:{marginTop:"10px",marginBottom:"10px",fontWeight:400}}}));function Ss(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(Vl.a,null),"Add Image Layer")}var ws=function(e){var t=e.imageOptions,n=e.handleImageAdd,a=Object(i.useReducer)((function(e){return!e}),!1),r=Object(o.a)(a,2),s=r[0],c=r[1],u=Cs();return t?l.a.createElement(Wa,{open:s,toggle:c,buttonIcon:l.a.createElement(Ss,null),buttonClassName:u.addButton},t.map((function(e,t){return l.a.createElement(Ta.a,{dense:!0,key:e.name,onClick:function(){return function(e){c(),n(e)}(t)}},l.a.createElement("span",null,e.name))}))):null},Ls=["raster"],Ts=l.a.memo(Object(i.forwardRef)((function(e,t){var n=e.title,a=e.removeGridComponent,r=e.theme,o=e.isReady,i=e.moleculesLayer,s=e.dataset,u=e.setMoleculesLayer,p=e.cellsLayer,d=e.canShowCellVecmask,m=e.setCellsLayer,f=e.rasterLayers,h=e.imageLayerLoaders,g=e.imageLayerMeta,b=e.rasterLayersCallbacks,y=e.setRasterLayersCallbacks,v=e.areLoadingRasterChannnels,O=e.setAreLoadingRasterChannnels,x=e.handleRasterLayerChange,j=e.handleRasterLayerRemove,E=e.disable3d,C=e.globalDisable3d,S=e.layerIs3DIndex,w=e.setZoom,L=e.setTargetX,T=e.setTargetY,A=e.setTargetZ,k=e.setRotationX,_=e.setRotationOrbit,I=e.componentHeight,P=e.componentWidth,N=e.spatialLayout,R=e.handleImageAdd;return l.a.createElement(tr,{title:n,isScroll:!0,removeGridComponent:a,theme:r,isReady:o},l.a.createElement("div",{className:"layer-controller-container",ref:t},i&&l.a.createElement(Bl,{key:"".concat(s,"-molecules"),label:"Molecules",layerType:"molecules",layer:i,handleLayerChange:u}),p&&d&&l.a.createElement(Bl,{key:"".concat(s,"-cells"),label:"Cell Segmentations",layerType:"cells",layer:p,handleLayerChange:m}),f&&f.map((function(e,t){var n,a=e.index,o=h[a],i=g[a],u=!(null===i||void 0===i||null===(n=i.metadata)||void 0===n?void 0:n.isBitmask),p=u?Ll:kl,d=(v||[])[t]||[];return o&&i?l.a.createElement(ml.a,{key:"".concat(s,"-raster-").concat(a,"-").concat(t),item:!0,style:{marginTop:"10px"}},l.a.createElement(Es,{name:i.name,layer:e,loader:o,theme:r,handleLayerChange:function(e){return x(e,t)},handleLayerRemove:function(){return j(t)},ChannelController:p,shouldShowTransparentColor:u,shouldShowDomain:u,shouldShowColormap:u,disable3d:C||(E||[]).indexOf(i.name)>=0||"number"===typeof S&&-1!==S&&S!==t,disabled:"number"===typeof S&&-1!==S&&S!==t,rasterLayersCallbacks:b,setRasterLayerCallback:function(e){var n=Object(c.a)(b||[]);n[t]=e,y(n)},setViewState:function(e){var t=e.zoom,n=e.target,a=e.rotationX,r=e.rotationOrbit;w(t),L(n[0]),T(n[1]),A(n[2]),k(a),_(r)},setAreLayerChannelsLoading:function(e){var n=Object(c.a)(v||[]);n[t]=e,O(n)},areLayerChannelsLoading:d,spatialHeight:I*N.h/12,spatialWidth:P*N.w/12})):null})),l.a.createElement(ml.a,{item:!0},l.a.createElement(ws,{imageOptions:g,handleImageAdd:R}))))})));var As=function(e){var t=e.coordinationScopes,n=e.removeGridComponent,a=e.theme,r=e.title,u=void 0===r?"Spatial Layers":r,p=e.disable3d,d=e.globalDisable3d,m=zn(),f=Rn(ra.layerController,t),h=Object(o.a)(f,2),g=h[0],b=g.dataset,y=g.spatialRasterLayers,v=g.spatialCellsLayer,O=g.spatialMoleculesLayer,x=h[1],j=x.setSpatialRasterLayers,E=x.setSpatialCellsLayer,C=x.setSpatialMoleculesLayer,S=x.setSpatialTargetX,w=x.setSpatialTargetY,L=x.setSpatialTargetZ,T=x.setSpatialRotationX,A=x.setSpatialRotationOrbit,k=x.setSpatialZoom,_=Dn(ra.layerController,t),I=Object(o.a)(_,2),P=I[0],N=P.rasterLayersCallbacks,R=P.areLoadingRasterChannnels,M=I[1],D=M.setRasterLayersCallbacks,z=M.setAreLoadingRasterChannnels,G=function(e,t,n){return An((function(a){return a.viewConfig.layout.filter((function(t){return t.component===e})).filter((function(e){return t.every((function(t){return e.coordinationScopes[t]===n[t]}))}))}))}("spatial",["spatialRasterLayers"],t),H=Object(o.a)(G,1)[0],F=Object(i.useRef)(),X=function(e){var t=Object(i.useState)(),n=Object(o.a)(t,2),a=n[0],r=n[1],l=Object(i.useState)(),s=Object(o.a)(l,2),c=s[0],u=s[1];return Object(i.useEffect)((function(){function t(){if(e.current){var t=e.current.closest(".vitessce-container"),n=t.clientHeight,a=t.clientWidth;u(a),r(n)}}var n=ca()(t,100,{trailing:!0});return window.addEventListener("resize",n),t(),function(){window.removeEventListener("resize",n)}}),[e]),[c,a]}(F),B=Object(o.a)(X,2),Z=B[0],U=B[1],V=function(){var e=Object(i.useState)(ua()),t=Object(o.a)(e,2),n=t[0],a=t[1];return Object(i.useEffect)((function(){var e=ca()((function(){a(ua())}),100,{trailing:!0});return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),n}(),Y=V.height,W=V.width,q=ma(Ls),$=Object(o.a)(q,3),K=$[0],J=$[1],Q=$[2];Object(i.useEffect)((function(){Q()}),[m,b]);var ee=Sa(m,b,J,(function(){}),!1,{setSpatialRasterLayers:j},{spatialRasterLayers:y}),te=Object(o.a)(ee,3),ne=(te[0],te[1]),ae=te[2];va(m,b,J,(function(){}),!1,{setSpatialCellsLayer:E},{spatialCellsLayer:v}),Ca(m,b,J,(function(){}),!1,{setSpatialMoleculesLayer:C},{spatialMoleculesLayer:O});var re=Object(i.useCallback)(function(){var e=Object(Oe.a)(ve.a.mark((function e(t){var n,a,r,o,i,l,u,p,d;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=ne[t],e.next=3,vt(l,(y[t]||{}).use3d);case 3:u=e.sent,p=Object(s.a)({index:t,modelMatrix:null===(n=ae[t])||void 0===n||null===(a=n.metadata)||void 0===a||null===(r=a.transform)||void 0===r?void 0:r.matrix},Qe,{channels:u,type:(null===(o=ae[t])||void 0===o||null===(i=o.metadata)||void 0===i?void 0:i.isBitmask)?"bitmask":"raster"}),d=[].concat(Object(c.a)(y),[p]),j(d);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[ne,ae,y,j]),oe=Object(i.useCallback)((function(e,t){var n=Object(c.a)(y);n[t]=e,j(n)}),[y,j]),ie=Object(i.useCallback)((function(e){var t=Object(c.a)(y);t.splice(e,1),j(t)}),[y,j]),le=(ae.length?ae:[{metadata:{isBitmask:!0}}]).every((function(e){var t;return!(null===e||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.isBitmask)})),se=(null===y||void 0===y?void 0:y.findIndex)&&y.findIndex((function(e){return e.use3d}));return l.a.createElement(Ts,{ref:F,title:u,removeGridComponent:n,theme:a,isReady:K,moleculesLayer:O,dataset:b,setMoleculesLayer:C,cellsLayer:v,canShowCellVecmask:le,setCellsLayer:E,rasterLayers:y,imageLayerLoaders:ne,imageLayerMeta:ae,rasterLayersCallbacks:N,setRasterLayersCallbacks:D,areLoadingRasterChannnels:R,setAreLoadingRasterChannnels:z,handleRasterLayerChange:oe,handleRasterLayerRemove:ie,disable3d:p,globalDisable3d:d,layerIs3DIndex:se,setZoom:k,setTargetX:S,setTargetY:w,setTargetZ:L,setRotationX:T,setRotationOrbit:A,componentHeight:U||Y,componentWidth:Z||W,spatialLayout:H,handleImageAdd:re})},ks=n(840),_s=n(841),Is=n(607),Ps=mr.dependencies["window-pixi"],Ns=mr.dependencies.higlass,Rs="https://unpkg.com/window-pixi@".concat(Ps,"/dist/pixi.").concat("min.js"),Ms="https://unpkg.com/higlass@".concat(Ns,"/dist/hglib.").concat("min.js");ks.a.initialize(),Object(_s.a)({dataFetcher:Is.a,config:Is.a.config},{pluginType:"dataFetcher"});var Ds=l.a.lazy((function(){return window.React||(window.React=l.a),window.ReactDOM||(window.ReactDOM=r.a),new Promise((function(e){var t=function(t){var n;console.warn(t),e(Ke((n={title:"Could not load HiGlass",message:"The HiGlass scripts could not be dynamically imported."},function(){var e=n.title,t=n.message;return l.a.createElement("div",{className:E},l.a.createElement("h1",null,e),l.a.createElement("div",null,t))})))};__import__(Rs).then((function(){__import__(Ms).then((function(){e(Ke(window.hglib.HiGlassComponent))})).catch(t)})).catch(t)}))}));function zs(e){var t=e.coordinationScopes,n=e.theme,a=e.hgViewConfig,r=e.hgOptions,c=e.genomeSize,u=e.height,p=Rn(ra.higlass,t),d=Object(o.a)(p,2),m=d[0],f=m.genomicZoomX,h=m.genomicZoomY,g=m.genomicTargetX,b=m.genomicTargetY,y=d[1],v=y.setGenomicZoomX,O=y.setGenomicZoomY,x=y.setGenomicTargetX,j=y.setGenomicTargetY,E=pa(),C=Object(o.a)(E,3),S=C[0],w=(C[1],C[2]),L=Object(i.useState)(),T=Object(o.a)(L,2),A=T[0],k=T[1],_=Object(i.useRef)(),I=Object(i.useMemo)((function(){return Object(s.a)({},r,{theme:n})}),[r,n]),P=Object(i.useMemo)((function(){var e=g,t=c/Math.pow(2,f),n=S/800,r=[e-t*n/2,e+t*n/2],o=b,i=c/Math.pow(2,h),l=u/800,p=[o-i*l/2,o+i*l/2];return{editable:!1,zoomFixed:!1,trackSourceServers:["//higlass.io/api/v1"],exportViewUrl:"//higlass.io/api/v1/viewconfs",views:[Object(s.a)({uid:"main"},a,{initialXDomain:r,initialYDomain:p})],zoomLocks:{locksByViewUid:{},locksDict:{}},locationLocks:{locksByViewUid:{},locksDict:{}},valueScaleLocks:{locksByViewUid:{},locksDict:{}}}}),[g,c,f,S,b,h,u,a]);return Object(i.useEffect)((function(){var e=function(){_.current=!0},t=function(){_.current=!1},n=w.current;return n.addEventListener("mouseenter",e),n.addEventListener("mouseleave",t),function(){n.removeEventListener("mouseenter",e),n.removeEventListener("mouseenter",t)}}),[w]),Object(i.useEffect)((function(){return A?(A.api.on("viewConfig",(function(e){if(_.current){var t=JSON.parse(e),n=t.views[0].initialXDomain,a=t.views[0].initialYDomain,r=Math.log2(c/((n[1]-n[0])*(800/S))),o=Math.log2(c/((a[1]-a[0])*(800/u))),i=n[0]+(n[1]-n[0])/2,l=a[0]+(a[1]-a[0])/2;v(r),O(o),x(i),j(l)}})),function(){return A.api.off("viewConfig")}):function(){}}),[A,c,S,u,v,O,x,j]),l.a.createElement("div",{className:"higlass-wrapper-parent"},l.a.createElement("div",{className:"higlass-wrapper",ref:w,style:{height:"".concat(u,"px")}},l.a.createElement(i.Suspense,{fallback:l.a.createElement("div",null,"Loading...")},l.a.createElement(Ds,{ref:k,zoomFixed:!1,viewConfig:P,options:I}))))}zs.defaultProps={hgOptions:{bounded:!0,pixelPreciseMarginPadding:!0,containerPaddingX:0,containerPaddingY:0,sizeMode:"default"},genomeSize:31e8};var Gs=[];var Hs=n(478),Fs=n(1431),Xs="table";function Bs(e){return"https://vega.github.io/schema/vega/v5.json"===e.$schema}function Zs(e){var t=e.spec,n=e.data,a=e.signalListeners,r=Object(s.a)({},t,{data:Bs(t)?[{name:Xs}].concat(Object(c.a)(t.data)):{name:Xs}}),o=Object(i.useMemo)((function(){return l.a.createElement(Fs.a,{spec:r,data:Object(B.a)({},Xs,n),signalListeners:a,tooltip:(new Hs.a).call,renderer:"canvas",scaleFactor:3})}),[r,n,a]);return r&&n&&n.length>0?l.a.createElement(i.Suspense,{fallback:l.a.createElement("div",null,"Loading...")},o):null}var Us={dark:{background:null,title:{color:"#fff"},style:{"guide-label":{fill:"#fff"},"guide-title":{fill:"#fff"}},axis:{domainColor:"#fff",gridColor:"#888",tickColor:"#fff"}},light:{background:null}};function Vs(e){var t=e.data,n=e.theme,a=e.width,r=e.height,o=e.marginRight,i=void 0===o?90:o,c=e.marginBottom,u=void 0===c?120:c,p=e.keyLength,d=void 0===p?36:p,m=t.map((function(e){return Object(s.a)({},e,{keyName:e.key+e.name,colorString:Dt(e.color)})})),f={domain:m.map((function(e){return e.key})),range:m.map((function(e){return e.colorString}))},h=m.map((function(e){return e.keyName})),g={mark:{type:"bar"},encoding:{x:{field:"keyName",type:"nominal",axis:{labelExpr:"substring(datum.label, ".concat(d,")")},title:"Cell Set",sort:h},y:{field:"size",type:"quantitative",title:"Cell Set Size"},color:{field:"key",type:"nominal",scale:f,legend:null},tooltip:{field:"size",type:"quantitative"}},width:so()(a-i,10,1/0),height:so()(r-u,10,1/0),config:Us[n]};return l.a.createElement(Zs,{data:m,spec:g})}var Ys=["cell-sets"];var Ws=n(1429),qs=["genomic-profiles"],$s={hg38:{chromosomes:"NyITQvZsS_mOFNlz5C2LJg",genes:"P0PLbQMwTYGy-5uPIQid7A"},hg19:{chromosomes:"N12wVGG9SPiTkk03yUayUw",genes:"OHJakQICQD6gTD7skx4EWA"},mm9:{chromosomes:"WAVhNHYxQVueq6KulwgWiQ",genes:"GUm5aBiLRCyz2PsBea7Yzg"},mm10:{chromosomes:"EtrWT0VtScixmsmwFSd7zg",genes:"QDutvmyiSrec5nX4pA5WGQ"}};function Ks(e){var t=e.geneSelection,n=e.data,a=e.theme,r=e.width,o=e.height,i=e.marginRight,s=void 0===i?90:i,c=e.marginBottom,u=void 0===c?50:c,p={mark:{type:"bar"},encoding:{x:{field:"value",type:"quantitative",bin:{maxbins:50},title:t&&t.length>=1?"Normalized Expression Value":"Total Normalized Transcript Count"},y:{type:"quantitative",aggregate:"count",title:"Number of Cells"},color:{value:"gray"}},width:so()(r-s,10,1/0),height:so()(o-u,10,1/0),config:Us[a]};return l.a.createElement(Zs,{data:n,spec:p})}var Js=["expression-matrix"];function Qs(e,t,n,a,r,l,s,c){var u=Object(i.useMemo)((function(){return $e(n,a)}),[n,a]),p=Object(i.useMemo)((function(){if(u&&l&&r&&r.length>=1&&e){for(var n=function(e,t,n){for(var a=[],r=function(r){var i=t[r],l=$t(e,i);if(l){var s,c=Wt(l),u=(null===n||void 0===n||null===(s=n.find((function(e){return I()(e.path,i)})))||void 0===s?void 0:s.color)||Be;a=a.concat(c.map((function(e){return{obsId:Object(o.a)(e,1)[0],name:l.name,color:u}})))}},i=0;i<t.length;i+=1)r(i);return a}(u,l,s),a=r[0],i=-1/0,p={},d=0;d<t.rows.length;d+=1)p[t.rows[d]]=d;return[n.map((function(t){var n=p[t.obsId],r=100*e[0][n]/255,o=c?Math.log(1+r):r;return i=Math.max(o,i),{value:o,gene:a,set:t.name}})),i]}return[null,null]}),[e,t,r,u,l,s,c]),d=Object(o.a)(p,2),m=d[0],f=d[1];return[m,Object(i.useMemo)((function(){return u&&l&&s?on(u,l,s):[]}),[u,l,s]),f]}function ec(e){var t=e.toggleGeneExpressionTransform,n=e.useGeneExpressionTransform,a=Mi();return l.a.createElement(Fi,null,l.a.createElement(Ri.a,null,l.a.createElement(Ni.a,{className:a.labelCell},"Log Transform"),l.a.createElement(Ni.a,{className:a.inputCell},l.a.createElement(Ii.a,{className:a.checkbox,checked:Boolean(n),onChange:function(){t()},name:"scatterplot-option-cell-set-labels",color:"default"}))))}function tc(e){var t=e.domainMax,n=void 0===t?100:t,a=e.colors,r=e.data,o=e.theme,i=e.width,c=e.height,u=e.marginRight,p=void 0===u?90:u,d=e.marginBottom,m=e.useGeneExpressionTransform,f=r.reduce((function(e,t){return e=void 0===e||t.set.length>e?t.set.length:e}),0),h=d||30+30*Math.sqrt(f/2),g={domain:a.map((function(e){return e.name})),range:a.map((function(e){return Dt(e.color)}))},b=so()(i-p,10,1/0),y=so()(c-h,10,1/0),v=b/a.length,O="dark"===o?"white":"black",x={$schema:"https://vega.github.io/schema/vega/v5.json",description:"A violin plot showing distributions of expression levels for selected cell sets.",width:b,height:y,config:Object(s.a)({},Us[o],{axisBand:{bandPosition:1,tickExtra:!0,tickOffset:0}}),signals:[{name:"bandWidth",value:v},{name:"width",value:b},{name:"height",value:y},{name:"trim",value:!0}],data:[{name:"density",source:Xs,transform:[{type:"kde",field:"value",groupby:["set"],bandwidth:0,extent:[0,n]}]},{name:"stats",source:Xs,transform:[{type:"aggregate",groupby:["set"],fields:["value","value","value"],ops:["q1","median","q3"],as:["q1","median","q3"]}]}],scales:[{name:"layout",type:"band",range:"width",domain:{data:Xs,field:"set"}},{name:"yscale",type:"linear",range:"height",domain:[0,n]},{name:"wscale",type:"linear",range:[0,{signal:"bandWidth"}],domain:{data:"density",field:"density"}},{name:"wscaleReversed",type:"linear",reverse:!0,range:[0,{signal:"bandWidth"}],domain:{data:"density",field:"density"}},Object(s.a)({name:"color",type:"ordinal"},g)],axes:[{orient:"left",scale:"yscale",zindex:1,title:m?["Log-Transformed","Normalized Expression Values"]:"Normalized Expression Values"},{orient:"bottom",scale:"layout",tickCount:5,zindex:1,title:"Cell Set",labelAngle:-45,labelAlign:"right"}],marks:[{type:"group",from:{facet:{data:"density",name:"violin",groupby:"set"}},encode:{enter:{xc:{scale:"layout",field:"set",band:.5},width:{signal:"bandWidth"},height:{signal:"height"}}},data:[{name:"summary",source:"stats",transform:[{type:"filter",expr:"datum.set === parent.set"}]}],marks:[{type:"area",orient:"vertical",from:{data:"violin"},encode:{enter:{fill:{scale:"color",field:{parent:"set"}}},update:{width:{scale:"wscale",field:"density"},xc:{signal:"bandWidth / 2"},y2:{scale:"yscale",field:"value"},y:{scale:"yscale",value:0}}}},{type:"area",orient:"vertical",from:{data:"violin"},encode:{enter:{fill:{scale:"color",field:{parent:"set"}}},update:{width:{scale:"wscaleReversed",field:"density"},xc:{signal:"bandWidth"},y2:{scale:"yscale",field:"value"},y:{scale:"yscale",value:0}}}},{type:"rect",from:{data:"summary"},encode:{enter:{fill:{value:O},width:{value:2}},update:{y:{scale:"yscale",field:"q1"},y2:{scale:"yscale",field:"q3"},xc:{signal:"bandWidth / 2"}}}},{type:"rect",from:{data:"summary"},encode:{enter:{fill:{value:O},height:{value:2},width:{value:8}},update:{y:{scale:"yscale",field:"median"},xc:{signal:"bandWidth / 2"}}}}]}]};return l.a.createElement(Zs,{data:r,spec:x})}var nc=["cell-sets","expression-matrix"];var ac={description:function(e){var t=e.coordinationScopes,n=e.description,a=e.removeGridComponent,r=e.theme,s=e.title,c=void 0===s?"Data Set":s,u=zn(),p=Rn(ra.description,t),d=Object(o.a)(p,1)[0],m=d.dataset,f=d.spatialRasterLayers,h=ma(ar),g=Object(o.a)(h,3),b=g[0],y=g[1],v=g[2];Object(i.useEffect)((function(){v()}),[u,m]);var O=function(e,t){var n=Object(i.useState)(),a=Object(o.a)(n,2),r=a[0],l=a[1];return Object(i.useEffect)((function(){e[t]&&(e[t].description?l(e[t].description):l(null))}),[e,t]),[r]}(u,m),x=Object(o.a)(O,1)[0],j=Sa(u,m,y,(function(){}),!1),E=Object(o.a)(j,3),C=E[0],S=E[1],w=E[2],L=Object(i.useMemo)((function(){var e=new Map;return f&&f.length>0&&C&&w&&S&&f.forEach((function(t){if(w[t.index]){var n=S[t.index].metadata.format;e.set("".concat(t.index),{name:C.meta[t.index].name,metadata:n&&n()})}})),e}),[C,f,w,S]);return l.a.createElement(tr,{title:c,removeGridComponent:a,isScroll:!0,theme:r,isReady:b},l.a.createElement(nr,{description:n||x,metadata:L}))},status:function(e){var t=e.coordinationScopes,n=e.removeGridComponent,a=e.theme,r=e.title,i=void 0===r?"Status":r,s=Rn(ra.status,t),u=Object(o.a)(s,1)[0],p=u.cellHighlight,d=u.geneHighlight,m=u.moleculeHighlight,f=Fn(),h=[].concat(Object(c.a)(p?["Hovered cell ".concat(p)]:[]),Object(c.a)(d?["Hovered gene ".concat(d)]:[]),Object(c.a)(m?["Hovered gene ".concat(m)]:[])).join("; ");return l.a.createElement(tr,{title:i,theme:a,removeGridComponent:n,isScroll:!0,isReady:!0},l.a.createElement(rr,{warn:f,info:h}))},genes:function(e){var t=e.coordinationScopes,n=e.removeGridComponent,a=e.variablesLabelOverride,r=void 0===a?"gene":a,s=e.variablesPluralLabelOverride,c=void 0===s?"".concat(r,"s"):s,u=e.theme,p=e.title,d=void 0===p?"Expression Levels":p,m=zn(),f=Rn(ra.genes,t),h=Object(o.a)(f,2),g=h[0],b=g.dataset,y=g.geneSelection,v=g.geneFilter,O=g.cellColorEncoding,x=h[1],j=x.setGeneSelection,E=x.setGeneFilter,C=x.setGeneHighlight,S=x.setCellColorEncoding,w=fa(),L=Object(o.a)(w,3),T=L[0],A=L[1],k=L[2],_=ma(dr),I=Object(o.a)(_,3),P=I[0],N=I[1],R=I[2];Object(i.useEffect)((function(){k(),R()}),[m,b]);var M=Ea(m,b,N,A,!0),D=Object(o.a)(M,1)[0],z=D?D.cols:[],G=z.length;return l.a.createElement(tr,{title:d,info:"".concat(G," ").concat(U(r,c,G)),theme:u,isScroll:!0,removeGridComponent:n,isReady:P,urls:T},l.a.createElement(pr,{hasColorEncoding:"geneSelection"===O,geneList:z,geneSelection:y,geneFilter:v,setGeneSelection:function(e){j(e),S("geneSelection")},setGeneFilter:E,setGeneHighlight:C}))},cellSets:function(e){var t=e.coordinationScopes,n=e.removeGridComponent,a=e.theme,r=e.title,u=void 0===r?"Cell Sets":r,p=zn(),d=Xn(),m=Rn(ra.cellSets,t),f=Object(o.a)(m,2),h=f[0],g=h.dataset,b=h.cellSetSelection,y=h.cellSetColor,v=h.additionalCellSets,O=h.cellColorEncoding,x=f[1],j=x.setCellSetSelection,E=x.setCellColorEncoding,C=x.setCellSetColor,S=x.setAdditionalCellSets,w=fa(),L=Object(o.a)(w,3),T=L[0],A=L[1],k=L[2],_=ma(oo),P=Object(o.a)(_,3),N=P[0],R=P[1],M=P[2],D=Object(i.useState)([]),z=Object(o.a)(D,2),G=z[0],H=z[1];Object(i.useEffect)((function(){k(),M(),H([])}),[p,g]);var F=va(p,g,R,A,!0),X=Object(o.a)(F,1)[0],B=Oa(p,g,R,A,!0,{setCellSetSelection:j,setCellSetColor:C},{cellSetSelection:b,cellSetColor:y}),Z=Object(o.a)(B,1)[0];Object(i.useEffect)((function(){if(v){var e;try{e=pn(v,"cell")}catch(t){return void d(t.message)}S(e)}}),[v,S,d]);var U=Object(i.useMemo)((function(){return X?Object.keys(X):[]}),[X]);function V(){E("cellSetSelection")}var Y=Object(i.useMemo)((function(){return $e(Z,v)}),[Z,v]),W=Object(i.useMemo)((function(){return b&&b.length>0&&Y&&Y.tree.length>0?function(e,t){var n=null;return e&&e.tree.forEach((function(e){var a=[e.name],r=qt(e);ke()(r).forEach((function(r){var o=r+1,i=en(e,o,[],!0);I()(i,t)&&(n={levelZeroPath:a,levelIndex:o})}))})),n}(Y,b):null}),[b,Y]);return l.a.createElement(tr,{title:u,isScroll:!0,removeGridComponent:n,urls:T,theme:a,isReady:N},l.a.createElement(ro,{setColor:y,sets:Z,additionalSets:v,levelSelection:W,setSelection:b,setExpansion:G,hasColorEncoding:"cellSetSelection"===O,draggable:!0,datatype:"cell",onError:d,onCheckNode:function(e,t){var n=Array.isArray(e)?e:e.split("___");e&&(j(t?[].concat(Object(c.a)(b),[n]):b.filter((function(e){return!I()(e,n)}))),V())},onExpandNode:function(e,t,n){H(n?function(e){return[].concat(Object(c.a)(e),[t.split("___")])}:function(e){return e.filter((function(e){return!I()(e,t.split("___"))}))})},onDropNode:function(e,t,n,a){var r=e.split("___"),o=$t(v,r);if(o.children||a){var i=0===r.length-1,l=t.split("___"),u=$t(v,l);if(!i||!a||u.children){var p,d,m;i?m=v.tree.findIndex((function(e){return e.name===o.name})):(d=r.slice(0,-1),m=(p=$t(v,d)).children.findIndex((function(e){return e.name===o.name})));var f=u.name;if(!(!i&&a?p.children.find((function(e){return e!==u&&e.name===f})):a?v.tree.find((function(e){return e!==u&&e.name===f})):o.children.find((function(e){return e!==u&&e.name===f})))){var h=Object(s.a)({},v,{tree:v.tree.map((function(e){return ln(e,[],l)})).filter(Boolean)});m=i?h.tree.findIndex((function(e){return e.name===o.name})):p.children.findIndex((function(e){return e.name===o.name}));var g=[];if(a&&i)if(-1===n)h.tree.unshift(u),S(h),g=[u.name],j([g]);else{var b=m+(n>m?1:0),O=Array.from(h.tree);O.splice(b,0,u),h.tree=O,S(h),g=[u.name],j([g])}else{var x,E,w=[];if(a){if(!i)if(E=function(e){return I()(e,d)},-1===n)x=function(e){return t=e,n=u,Object(s.a)({},t,{children:[n].concat(Object(c.a)(t.children))});var t,n};else{var L=m+(n>m?1:0);x=function(e){return function(e,t,n){var a=Array.from(e.children);return a.splice(n,0,t),Object(s.a)({},e,{children:a})}(e,u,L)}}}else x=function(e){return Jt(e,u)},E=function(e){return I()(e,r)};h.tree=h.tree.map((function(e){return Kt(e,(function(e,t){return E(t)}),(function(e){return x(e)}),w)})),S(h),g=[].concat(Object(c.a)(w[0]),[u.name]),j([g])}var T=y.filter((function(e){return Ht(l,e.path)})).map((function(e){return Object(s.a)({},e,{path:I()(e.path,l)?g:g.concat(e.path.slice(l.length))})})),A=y.filter((function(e){return!Ht(l,e.path)}));A.push.apply(A,Object(c.a)(T)),C(A)}}}},onCheckLevel:function(e,t){var n=Y.tree.find((function(t){return t.name===e}));if(n){var a=en(n,t,[],!0);j(a),V()}},onNodeSetColor:function(e,t){var n=null===y||void 0===y?void 0:y.find((function(t){return I()(t.path,e)}));C([].concat(n?Object(c.a)(y.filter((function(t){return!I()(t.path,e)}))):Object(c.a)(y||[]),[{path:e,color:t}]))},onNodeSetName:function(e,t){var n=Object(c.a)(e);n.pop(),n.push(t);var a=Object(s.a)({},v,{tree:v.tree.map((function(n){return function n(a,r){return I()([].concat(Object(c.a)(r),[a.name]),e)?Object(s.a)({},a,{name:t}):a.children?Object(s.a)({},a,{children:a.children.map((function(e){return n(e,[].concat(Object(c.a)(r),[a.name]))}))}):a}(n,[])}))}),r=y.map((function(t){return{path:Ft(e,t.path,n),color:t.color}})),o=b.map((function(t){return Ft(e,t,n)})),i=G.map((function(t){return Ft(e,t,n)}));S(a),C(r),j(o),H(i)},onNodeCheckNewName:function(e,t){var n=Object(c.a)(e);return n.pop(),n.push(t),!I()(e,n)&&$t(v,n)},onNodeRemove:function(e){var t=Object(s.a)({},v,{tree:v.tree.map((function(t){return ln(t,[],e)})).filter(Boolean)}),n=y.filter((function(t){return!Ht(e,t.path)})),a=b.filter((function(t){return!Ht(e,t)})),r=G.filter((function(t){return!Ht(e,t)}));S(t),C(n),j(a),H(r)},onNodeView:function(e){var t=[];!function e(n,a){G.find((function(e){return I()(a,e)}))&&n.children?n.children.forEach((function(t){e(t,[].concat(Object(c.a)(a),[t.name]))})):t.push(a)}($t(Y,e),e),j(t),V()},onImportTree:function(e){if(!sn(Y,e)){S(Object(s.a)({},v||an("cell"),{tree:[].concat(Object(c.a)(v?v.tree:[]),Object(c.a)(e.tree))}));var t=cn(e,y);C([].concat(Object(c.a)(y),Object(c.a)(t)))}},onCreateLevelZeroNode:function(){var e=We(null===v||void 0===v?void 0:v.tree,"My hierarchy ");S(Object(s.a)({},v||an("cell"),{tree:[].concat(Object(c.a)(v?v.tree:[]),[{name:e,children:[]}])}))},onExportLevelZeroNodeJSON:function(e){var t=nn(Y,e,"cell",y),n=t.treeToExport,a=t.nodeName;hn(fn(n),"".concat(a,"_").concat(mr.name,"-").concat("cell","-hierarchy.").concat("json"))},onExportLevelZeroNodeTabular:function(e){var t=nn(Y,e,"cell",y),n=t.treeToExport,a=t.nodeName;hn(function(e){var t=[];e.tree.forEach((function(e){e.children.forEach((function(n){n.set&&n.set.forEach((function(a){var r=Object(o.a)(a,2),i=r[0],l=r[1];t.push({groupName:e.name,setName:n.name,setColor:Dt(n.color),obsId:i,predictionScore:_t()(l)?"NA":l})}))}))}));var n=Object(Pt.parse)(t,{fields:["groupName","setName","setColor","obsId","predictionScore"],delimiter:","});return"data:".concat("text/csv",";charset=utf-8,").concat(encodeURIComponent(n))}(n),"".concat(a,"_").concat(mr.name,"-").concat("cell","-hierarchy.").concat("csv"))},onExportSetJSON:function(e){var t=function(e,t){var n=$t(e,t);return{setToExport:Wt(n),nodeName:n.name}}(Y,e),n=t.setToExport,a=t.nodeName;hn(fn(n),"".concat(a,"_").concat(mr.name,"-").concat("cell","-set.").concat("json"))},onUnion:function(){qe(Qt(Y,b),v,y,j,S,C,E,"Union ")},onIntersection:function(){qe(function(e,t){var n=t.map((function(t){return $t(e,t)})).map((function(e){return Wt(e).map((function(e){return Object(o.a)(e,1)[0]}))}));return n.reduce((function(e,t){return t.filter((function(t){return e.includes(t)}))}),n[0]||[])}(Y,b),v,y,j,S,C,E,"Intersection ")},onComplement:function(){qe(function(e,t,n){var a=Qt(e,t);return n.filter((function(e){return!a.includes(e)}))}(Y,b,U),v,y,j,S,C,E,"Complement ")},hasCheckedSetsToUnion:(null===b||void 0===b?void 0:b.length)>1,hasCheckedSetsToIntersect:(null===b||void 0===b?void 0:b.length)>1,hasCheckedSetsToComplement:(null===b||void 0===b?void 0:b.length)>0}))},scatterplot:function(e){var t=e.uuid,n=e.coordinationScopes,a=e.removeGridComponent,r=e.theme,u=e.disableTooltip,p=void 0!==u&&u,d=e.observationsLabelOverride,m=void 0===d?"cell":d,f=e.observationsPluralLabelOverride,h=void 0===f?"".concat(m,"s"):f,g=e.title,b=zn(),y=Hn(),v=Zn(t),O=Rn(ra.scatterplot,n),x=Object(o.a)(O,2),j=x[0],E=j.dataset,C=j.embeddingZoom,S=j.embeddingTargetX,w=j.embeddingTargetY,L=j.embeddingTargetZ,T=j.embeddingType,A=j.cellFilter,k=j.cellHighlight,_=j.geneSelection,P=j.cellSetSelection,N=j.cellSetColor,R=j.cellColorEncoding,M=j.additionalCellSets,D=j.embeddingCellSetPolygonsVisible,z=j.embeddingCellSetLabelsVisible,G=j.embeddingCellSetLabelSize,H=j.embeddingCellRadius,F=x[1],X=F.setEmbeddingZoom,Z=F.setEmbeddingTargetX,Y=F.setEmbeddingTargetY,W=F.setEmbeddingTargetZ,q=F.setCellFilter,$=F.setCellSetSelection,K=F.setCellHighlight,J=F.setCellSetColor,Q=F.setCellColorEncoding,ee=F.setAdditionalCellSets,te=F.setEmbeddingCellSetPolygonsVisible,ne=F.setEmbeddingCellSetLabelsVisible,ae=F.setEmbeddingCellSetLabelSize,re=F.setEmbeddingCellRadius,oe=fa(),ie=Object(o.a)(oe,3),le=ie[0],se=ie[1],ce=ie[2],ue=da(),pe=Object(o.a)(ue,3),de=pe[0],me=pe[1],fe=pe[2],he=ma(Ui),ge=Object(o.a)(he,3),be=ge[0],ye=ge[1],ve=ge[2],Oe=g||"Scatterplot (".concat(T,")");Object(i.useEffect)((function(){ce(),ve()}),[b,E]);var xe=va(b,E,ye,se,!0),je=Object(o.a)(xe,2),Ee=je[0],Ce=je[1],Se=Oa(b,E,ye,se,!1,{setCellSetSelection:$,setCellSetColor:J},{cellSetSelection:P,cellSetColor:N}),we=Object(o.a)(Se,1)[0],Le=ja(b,E,ye,!1,_),Ae=Object(o.a)(Le,1)[0],ke=Ea(b,E,ye,se,!1),_e=Object(o.a)(ke,1)[0],Ie=Object(i.useState)(.2),Pe=Object(o.a)(Ie,2),Ne=Pe[0],Re=Pe[1],Me=Object(i.useMemo)((function(){return $e(we,M)}),[we,M]),De=Object(i.useCallback)((function(e){qe(e,M,N,$,ee,J,Q)}),[M,N,Q,ee,J,$]),ze=Object(i.useMemo)((function(){return uo({cellColorEncoding:R,expressionData:Ae&&Ae[0],geneSelection:_,cellSets:Me,cellSetSelection:P,cellSetColor:N,expressionDataAttrs:_e})}),[R,_,Me,P,N,Ae,_e]),Ge=Object(i.useState)([]),He=Object(o.a)(Ge,2),Fe=He[0],Xe=He[1],Be=Object(i.useMemo)((function(){var e,t;if((z||D)&&(t=P,-1===Fe.findIndex((function(e){return I()(e[0],t)})))&&(null===Me||void 0===Me||null===(e=Me.tree)||void 0===e?void 0:e.length)&&Object.values(Ee).length&&(null===N||void 0===N?void 0:N.length)){var n=un({cells:Ee,mapping:T,cellSets:Me,cellSetSelection:P,cellSetColor:N});return Xe((function(e){return[].concat(Object(c.a)(e),[[P,n]])})),n}return function(e,t){var n;return null===(n=e.find((function(e){return I()(e[0],t)})))||void 0===n?void 0:n[1]}(Fe,P)||[]}),[D,Fe,z,Ee,T,Me,P,N]),Ze=Object(i.useMemo)((function(){return Array.from(ze.keys())}),[ze]);Object(i.useEffect)((function(){var e=Ee&&Object.values(Ee);if(null===e||void 0===e?void 0:e.length){var t=Object.values(Ee).map((function(e){return e.mappings[T]})),n=Object(Te.a)(t,(function(e){return e[0]})),a=Object(Te.a)(t,(function(e){return e[1]})),r=n[1]-n[0],o=a[1]-a[0],i=Math.sqrt(Math.pow(r,2)+Math.pow(o,2)),l=so()(i/300,0,.2);if(l&&Re(l),"number"!==typeof S||"number"!==typeof w){var s=n[0]+r/2,c=a[0]+o/2,u=Math.log2(Math.min(de/r,me/o));Z(s),Y(-c),X(u)}}}),[Ee,T]);var Ue=Object(i.useCallback)((function(e){var t=Ee[e];return Object(s.a)(Object(B.a)({},"".concat(V(m)," ID"),e),t?t.factors:{})}),[Ee,m]);return l.a.createElement(tr,{title:Oe,info:"".concat(Ce," ").concat(U(m,h,Ce)),removeGridComponent:a,urls:le,theme:r,isReady:be,options:l.a.createElement(Zi,{observationsLabel:m,cellRadius:H,setCellRadius:re,cellSetLabelsVisible:z,setCellSetLabelsVisible:ne,cellSetLabelSize:G,setCellSetLabelSize:ae,cellSetPolygonsVisible:D,setCellSetPolygonsVisible:te,cellColorEncoding:R,setCellColorEncoding:Q})},l.a.createElement(Li,{ref:fe,uuid:t,theme:r,viewState:{zoom:C,target:[S,w,L]},setViewState:function(e){var t=e.zoom,n=e.target;X(t),Z(n[0]),Y(n[1]),W(n[2])},cells:Ee,mapping:T,cellFilter:A,cellSelection:Ze,cellHighlight:k,cellColors:ze,cellSetPolygons:Be,cellSetLabelSize:G,cellSetLabelsVisible:z,cellSetPolygonsVisible:D,setCellFilter:q,setCellSelection:De,setCellHighlight:K,cellRadiusScale:Ne*H,setComponentHover:function(){y(t)},updateViewInfo:v}),!p&&l.a.createElement(_i,{parentUuid:t,cellHighlight:k,width:de,height:me,getCellInfo:Ue}))},spatial:function(e){var t=e.uuid,n=e.coordinationScopes,a=e.removeGridComponent,r=e.observationsLabelOverride,u=void 0===r?"cell":r,p=e.observationsPluralLabelOverride,d=void 0===p?"".concat(u,"s"):p,m=e.subobservationsLabelOverride,f=void 0===m?"molecule":m,h=e.subobservationsPluralLabelOverride,g=void 0===h?"".concat(f,"s"):h,b=e.theme,y=e.disableTooltip,v=void 0!==y&&y,O=e.title,x=void 0===O?"Spatial":O,j=zn(),E=Hn(),C=Zn(t),S=Rn(ra.spatial,n),w=Object(o.a)(S,2),L=w[0],T=L.dataset,A=L.spatialZoom,k=L.spatialTargetX,_=L.spatialTargetY,I=L.spatialTargetZ,P=L.spatialRotationX,N=L.spatialRotationY,R=L.spatialRotationZ,M=L.spatialRotationOrbit,D=L.spatialOrbitAxis,z=L.spatialRasterLayers,G=L.spatialCellsLayer,H=L.spatialMoleculesLayer,F=L.spatialNeighborhoodsLayer,X=L.cellFilter,Z=L.cellHighlight,Y=L.geneSelection,W=L.cellSetSelection,q=L.cellSetColor,$=L.cellColorEncoding,K=L.additionalCellSets,J=L.spatialAxisFixed,Q=w[1],ee=Q.setSpatialZoom,te=Q.setSpatialTargetX,ne=Q.setSpatialTargetY,ae=Q.setSpatialTargetZ,re=Q.setSpatialRotationX,oe=Q.setSpatialRotationOrbit,ie=Q.setSpatialOrbitAxis,le=Q.setSpatialRasterLayers,ce=Q.setSpatialCellsLayer,ue=Q.setSpatialMoleculesLayer,pe=Q.setSpatialNeighborhoodsLayer,de=Q.setCellFilter,me=Q.setCellSetSelection,fe=Q.setCellHighlight,he=Q.setCellSetColor,ge=Q.setCellColorEncoding,be=Q.setAdditionalCellSets,ye=Q.setMoleculeHighlight,ve=Q.setSpatialAxisFixed,Oe=Dn(ra.layerController,n),xe=Object(o.a)(Oe,1)[0].rasterLayersCallbacks,je=null===z||void 0===z?void 0:z.some((function(e){return e.use3d})),Ee=fa(),Ce=Object(o.a)(Ee,3),Se=Ce[0],we=Ce[1],Le=Ce[2],Ae=ma(tl),ke=Object(o.a)(Ae,3),_e=ke[0],Ie=ke[1],Ne=ke[2],Me=da(),De=Object(o.a)(Me,3),ze=De[0],Ge=De[1],He=De[2];Object(i.useEffect)((function(){Le(),Ne()}),[j,T]);var Fe=va(j,T,Ie,we,!1,{setSpatialCellsLayer:ce},{spatialCellsLayer:G}),Xe=Object(o.a)(Fe,2),Be=Xe[0],Ze=Xe[1],Ue=Ca(j,T,Ie,we,!1,{setSpatialMoleculesLayer:ue},{spatialMoleculesLayer:H}),Ve=Object(o.a)(Ue,3),Ye=Ve[0],We=Ve[1],Ke=Ve[2],Je=function(e,t,n,a,r,l,c){var u=Object(i.useState)(),p=Object(o.a)(u,2),d=p[0],m=p[1],f=Xn();return Object(i.useEffect)((function(){e[t]&&(e[t].loaders.neighborhoods?e[t].loaders.neighborhoods.load().catch((function(e){return ba(e,f)})).then((function(e){if(e){var t=e.data,r=e.url,o=e.coordinationValues;m(t),a(r,"Neighborhoods"),ya(Object(s.a)({spatialNeighborhoodsLayer:nt},o),l,c),n("neighborhoods")}})):(m({}),r?ba(new se(t,"neighborhoods",null,null),f):n("neighborhoods")))}),[e,t]),[d]}(j,T,Ie,we,!1,{setSpatialNeighborhoodsLayer:pe},{spatialNeighborhoodsLayer:F}),Qe=Object(o.a)(Je,1)[0],et=Oa(j,T,Ie,we,!1,{setCellSetSelection:me,setCellSetColor:he},{cellSetSelection:W,cellSetColor:q}),tt=Object(o.a)(et,1)[0],at=ja(j,T,Ie,!1,Y),rt=Object(o.a)(at,1)[0],ot=Ea(j,T,Ie,we,!1),it=Object(o.a)(ot,1)[0],lt=Sa(j,T,Ie,we,!1,{setSpatialRasterLayers:le},{spatialRasterLayers:z}),st=Object(o.a)(lt,3),ct=(st[0],st[1]),ut=st[2],pt=Object(i.useMemo)((function(){var e=!ut.some((function(e){var t;return null===e||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.isBitmask}));return[].concat(Object(c.a)(H?[Object(s.a)({},H,{type:"molecules"})]:[]),Object(c.a)(G&&e?[Object(s.a)({},G,{type:"cells"})]:[]),Object(c.a)(F?[Object(s.a)({},F,{type:"neighborhoods"})]:[]),Object(c.a)(z?z.map((function(e){return Object(s.a)({},e,{type:e.type&&["raster","bitmask"].includes(e.type)?e.type:"raster"})})):[]))}),[G,H,F,z,ut]);Object(i.useEffect)((function(){if("number"!==typeof k||"number"!==typeof _){var e=function(e){var t=e.width,n=e.height,a=e.cells,r=e.imageLayerLoaders,o=e.useRaster,i=e.use3d,l=-1/0,s=-1/0,u=-1/0,p=-1/0,d=i?1.5:.1,m=Object.values(a);if(r.length>0&&o)for(var f=0;f<r.length;f+=1){var h={height:n,width:t},g=Object(Pe.k)(r[f].data,h,d,i),b=g.target,y=g.zoom;b[0]>l&&(l=b[0],p=y),b[1]>s&&(s=b[1],p=y),b[2]>u?(u=b[2],p=y):u=null}else{if(!(m.length>0&&m[0].xy)||o)return{initialTargetX:null,initialTargetY:null,initialTargetZ:null,initialZoom:null};var v=m.map((function(e){return e.xy})),O=Object(Te.a)(v,(function(e){return e[0]})),x=Object(Te.a)(v,(function(e){return e[1]})),j=O[1]-O[0],E=x[1]-x[0],C=function(e){return[Math.min.apply(Math,Object(c.a)(e.map((function(e){return e[0]})))),Math.max.apply(Math,Object(c.a)(e.map((function(e){return e[1]}))))]};0===j&&(j=(O=C(m.map((function(e){return Object(Te.a)(e.poly,(function(e){return e[0]}))}))))[1]-O[0]);0===E&&(E=(x=C(m.map((function(e){return Object(Te.a)(e.poly,(function(e){return e[1]}))}))))[1]-x[0]);l=O[0]+j/2,s=x[0]+E/2,u=null,p=Math.log2(Math.min(t/j,n/E))-d}return{initialTargetX:l,initialTargetY:s,initialZoom:p,initialTargetZ:u}}({width:ze,height:Ge,cells:Be,imageLayerLoaders:ct,useRaster:Boolean(j[T].loaders.raster),use3d:je}),t=e.initialTargetX,n=e.initialTargetY,a=e.initialTargetZ,r=e.initialZoom;te(t),ne(n),ae(a),ee(r)}}),[ct,Be,k,_,te,ne,ee,je]);var dt=Object(i.useMemo)((function(){return $e(tt,K)}),[tt,K]),mt=Object(i.useCallback)((function(e){qe(e,K,q,me,be,he,ge)}),[K,q,ge,be,he,me]),ft=Object(i.useMemo)((function(){return uo({cellColorEncoding:$,expressionData:rt&&rt[0],geneSelection:Y,cellSets:dt,cellSetSelection:W,cellSetColor:q,expressionDataAttrs:it})}),[$,Y,dt,q,W,rt,it]),ht=Object(i.useMemo)((function(){return Array.from(ft.keys())}),[ft]),gt=function(e){var t=e.observationsCount,n=e.observationsLabel,a=e.observationsPluralLabel,r=e.subobservationsCount,o=e.subobservationsLabel,i=e.subobservationsPluralLabel,l=e.locationsCount,s=[];if(r>0){var c="".concat(r," ").concat(U(o,i,r));l>0&&(c+=" at ".concat(Re()(l)," locations")),s.push(c)}return t>0&&s.push("".concat(t," ").concat(U(n,a,t))),s.join(", ")}({observationsCount:Ze,observationsLabel:u,observationsPluralLabel:d,subobservationsCount:We,subobservationsLabel:f,subobservationsPluralLabel:g,locationsCount:Ke});return l.a.createElement(tr,{title:x,info:gt,isSpatial:!0,urls:Se,theme:b,removeGridComponent:a,isReady:_e,options:l.a.createElement(Qi,{observationsLabel:u,cellColorEncoding:$,setCellColorEncoding:ge,setSpatialAxisFixed:ve,spatialAxisFixed:J,use3d:je})},l.a.createElement(qi,{ref:He,uuid:t,width:ze,height:Ge,viewState:{zoom:A,target:[k,_,I],rotationX:P,rotationY:N,rotationZ:R,rotationOrbit:M,orbitAxis:D},setViewState:function(e){var t=e.zoom,n=e.target,a=e.rotationX,r=e.rotationOrbit,o=e.orbitAxis;ee(t),te(n[0]),ne(n[1]),ae(n[2]),re(a),oe(r),ie(o)},layers:pt,cells:Be,cellFilter:X,cellSelection:ht,cellHighlight:Z,cellColors:ft,molecules:Ye,neighborhoods:Qe,imageLayerLoaders:ct,setCellFilter:de,setCellSelection:mt,setCellHighlight:fe,setMoleculeHighlight:ye,setComponentHover:function(){E(t)},updateViewInfo:C,rasterLayersCallbacks:xe,spatialAxisFixed:J}),!v&&l.a.createElement(el,{parentUuid:t,cellHighlight:Z,width:ze,height:Ge,getCellInfo:function(e){var t=Be[e];return t?Object(s.a)(Object(B.a)({},"".concat(V(u)," ID"),e),t.factors):null}}))},heatmap:function(e){var t=e.uuid,n=e.coordinationScopes,a=e.removeGridComponent,r=e.theme,c=e.transpose,u=e.observationsLabelOverride,p=void 0===u?"cell":u,d=e.observationsPluralLabelOverride,m=void 0===d?"".concat(p,"s"):d,f=e.variablesLabelOverride,h=void 0===f?"gene":f,g=e.variablesPluralLabelOverride,b=void 0===g?"".concat(h,"s"):g,y=e.disableTooltip,v=void 0!==y&&y,O=e.title,x=void 0===O?"Heatmap":O,j=zn(),E=Hn(),C=Zn(t),S=Rn(ra.heatmap,n),w=Object(o.a)(S,2),L=w[0],T=L.dataset,A=L.heatmapZoomX,k=L.heatmapTargetX,_=L.heatmapTargetY,I=L.geneSelection,P=L.cellHighlight,N=L.geneHighlight,R=L.cellSetSelection,M=L.cellSetColor,D=L.cellColorEncoding,z=L.additionalCellSets,G=L.geneExpressionColormapRange,H=w[1],F=H.setHeatmapZoomX,X=H.setHeatmapZoomY,Z=H.setHeatmapTargetX,Y=H.setHeatmapTargetY,W=H.setCellHighlight,q=H.setGeneHighlight,$=H.setCellSetSelection,K=H.setCellSetColor,J=H.setGeneExpressionColormapRange,Q=V(m),ee=V(b),te=Object(i.useState)(!1),ne=Object(o.a)(te,2),ae=ne[0],re=ne[1],oe=ma(dl),ie=Object(o.a)(oe,3),le=ie[0],se=ie[1],ce=ie[2],ue=fa(),pe=Object(o.a)(ue,3),de=pe[0],me=pe[1],fe=pe[2],he=da(),ge=Object(o.a)(he,3),be=ge[0],ye=ge[1],ve=ge[2];Object(i.useEffect)((function(){fe(),ce()}),[j,T]);var Oe=va(j,T,se,me,!0),xe=Object(o.a)(Oe,1)[0],je=xa(j,T,se,me,!0),Ee=Object(o.a)(je,1)[0],Ce=ja(j,T,se,!1,I),Se=Object(o.a)(Ce,1)[0],we=Oa(j,T,se,me,!1,{setCellSetSelection:$,setCellSetColor:K},{cellSetSelection:R,cellSetColor:M}),Le=Object(o.a)(we,1)[0],Te=Object(i.useMemo)((function(){return $e(Le,z)}),[Le,z]),Ae=Object(i.useMemo)((function(){return uo({cellColorEncoding:D,expressionData:Se&&Se[0],geneSelection:I,cellSets:Te,cellSetSelection:R,cellSetColor:M,expressionDataAttrs:Ee})}),[D,Te,I,M,R,Se,Ee]),ke=Object(i.useCallback)((function(e){if(e){var t=xe[e];return Object(s.a)(Object(B.a)({},"".concat(V(p)," ID"),e),t?t.factors:{})}return null}),[xe,p]),_e=Object(i.useCallback)((function(e){return e?Object(B.a)({},"".concat(V(h)," ID"),e):null}),[h]),Ie=Ee&&Ee.rows?Ee.rows.length:0,Pe=Ee&&Ee.cols?Ee.cols.length:0,Ne=Ae.size;return l.a.createElement(tr,{title:x,info:"".concat(Ie," ").concat(U(p,m,Ie)," \xd7 ").concat(Pe," ").concat(U(h,b,Pe),",\n             with ").concat(Ne," ").concat(U(p,m,Ne)," selected"),urls:de,theme:r,removeGridComponent:a,isReady:le&&!ae},l.a.createElement(ul,{ref:ve,transpose:c,viewState:{zoom:A,target:[k,_]},setViewState:function(e){var t=e.zoom,n=e.target;F(t),X(t),Z(n[0]),Y(n[1])},heatmapControls:G,setHeatmapControls:J,height:ye,width:be,theme:r,uuid:t,expressionMatrix:Ee,cellColors:Ae,setIsRendering:re,setCellHighlight:W,setGeneHighlight:q,setComponentHover:function(){E(t)},updateViewInfo:C,observationsTitle:Q,variablesTitle:ee}),!v&&l.a.createElement(pl,{parentUuid:t,width:be,height:ye,transpose:c,getCellInfo:ke,getGeneInfo:_e,cellHighlight:P,geneHighlight:N}))},layerController:As,cellSetSizes:function(e){var t=e.coordinationScopes,n=e.removeGridComponent,a=e.theme,r=e.title,s=void 0===r?"Cell Set Sizes":r,c=zn(),u=Rn(ra.cellSetSizes,t),p=Object(o.a)(u,2),d=p[0],m=d.dataset,f=d.cellSetSelection,h=d.cellSetColor,g=d.additionalCellSets,b=p[1],y=b.setCellSetSelection,v=b.setCellSetColor,O=pa(),x=Object(o.a)(O,3),j=x[0],E=x[1],C=x[2],S=fa(),w=Object(o.a)(S,3),L=w[0],T=w[1],A=w[2],k=ma(Ys),_=Object(o.a)(k,3),I=_[0],P=_[1],N=_[2];Object(i.useEffect)((function(){A(),N()}),[c,m]);var R=Oa(c,m,P,T,!0,{setCellSetSelection:y,setCellSetColor:v},{cellSetSelection:f,cellSetColor:h}),M=Object(o.a)(R,1)[0],D=Object(i.useMemo)((function(){return $e(M,g)}),[M,g]),z=Object(i.useMemo)((function(){return D&&f&&h?on(D,f,h):[]}),[D,f,h]);return l.a.createElement(tr,{title:s,removeGridComponent:n,urls:L,theme:a,isReady:I},l.a.createElement("div",{ref:C,className:"vega-container"},l.a.createElement(Vs,{data:z,theme:a,width:j,height:E})))},expressionHistogram:function(e){var t=e.coordinationScopes,n=e.removeGridComponent,a=e.theme,r=zn(),s=Rn(ra.expressionHistogram,t),c=Object(o.a)(s,1)[0],u=c.dataset,p=c.geneSelection,d=pa(),m=Object(o.a)(d,3),f=m[0],h=m[1],g=m[2],b=fa(),y=Object(o.a)(b,3),v=y[0],O=y[1],x=y[2],j=ma(Js),E=Object(o.a)(j,3),C=E[0],S=E[1],w=E[2];Object(i.useEffect)((function(){x(),w()}),[r,u]);var L=xa(r,u,S,O,!0),T=Object(o.a)(L,1)[0],A=ja(r,u,S,!1,p),k=Object(o.a)(A,1)[0],_=p&&p.length>=1?p[0]:null,I=Object(i.useMemo)((function(){if(_&&T&&k)return Array.from(k[0]).map((function(e,t){return{value:100*k[0][t]/255,gene:_}}));if(T){var e=T.cols.length;return T.rows.map((function(t,n){var a=T.matrix.subarray(n*e,(n+1)*e);return{value:100*Object(Ws.a)(a)/255,gene:null}}))}return null}),[T,_,k]);return l.a.createElement(tr,{title:"Expression Histogram".concat(_?" (".concat(_,")"):""),removeGridComponent:n,urls:v,theme:a,isReady:C},l.a.createElement("div",{ref:g,className:"vega-container"},l.a.createElement(Ks,{geneSelection:p,data:I,theme:a,width:f,height:h})))},genomicProfiles:function(e){var t=e.coordinationScopes,n=e.theme,a=e.removeGridComponent,r=e.profileTrackUidKey,s=void 0===r?"path":r,u=e.profileTrackNameKey,p=void 0===u?null:u,d=e.higlassServer,m=void 0===d?"https://higlass.io/api/v1":d,f=e.assembly,h=void 0===f?"hg38":f,g=e.title,b=void 0===g?"Genomic Profiles":g,y=pa(),v=Object(o.a)(y,3),O=(v[0],v[1]),x=v[2],j=zn(),E=Rn(ra.genomicProfiles,t),C=Object(o.a)(E,1)[0],S=C.dataset,w=C.cellSetColor,L=C.cellSetSelection,T=ma(qs),A=Object(o.a)(T,3),k=A[0],_=A[1],P=A[2],N=fa(),R=Object(o.a)(N,3),M=R[0],D=R[1],z=R[2],G=function(e,t,n,a,r,l,s){var c=Object(i.useState)(),u=Object(o.a)(c,2),p=u[0],d=u[1],m=Xn();return Object(i.useEffect)((function(){e[t]&&(e[t].loaders["genomic-profiles"]?e[t].loaders["genomic-profiles"].load().catch((function(e){return ba(e,m)})).then((function(e){if(e){var t=e.data,r=e.url,o=e.coordinationValues;d(t),a(r),ya(o,l,s),n("genomic-profiles")}})):(d(null),r?ba(new se(t,"genomic-profiles",null,null),m):n("genomic-profiles")))}),[e,t]),[p]}(j,S,_,D,!0),H=Object(o.a)(G,1)[0],F=Object(i.useMemo)((function(){if(!H||1!==M.length)return null;var e=M[0].url,t="dark"===n?"#C0C0C0":"#000000",a="dark"===n?"#000000":"#f1f1f1",r="dark"===n?"dimgray":"silver",o=[{type:"horizontal-chromosome-labels",server:m,tilesetUid:$s[h].chromosomes,uid:"chromosome-labels",options:{color:t,fontSize:12,fontIsLeftAligned:!1,showMousePosition:!0,mousePositionColor:t},height:30},{type:"horizontal-gene-annotations",server:m,tilesetUid:$s[h].genes,uid:"gene-annotations",options:{name:"Gene Annotations (hg38)",fontSize:10,labelPosition:"hidden",labelLeftMargin:0,labelRightMargin:0,labelTopMargin:0,labelBottomMargin:0,minHeight:24,geneAnnotationHeight:16,geneLabelPosition:"outside",geneStrandSpacing:4,showMousePosition:!0,mousePositionColor:t,plusStrandColor:t,minusStrandColor:t,labelColor:"black",labelBackgroundColor:a,trackBorderWidth:0,trackBorderColor:"black"},height:70}],i=Object(Ws.a)(o.map((function(e){return e.height}))),l=(O-i-10)/H.row_infos.length,u=H.row_infos.map((function(a,o){var i,c=a[s],u=Array.isArray(c),d=p?a[p]:u?c[c.length-1]:c,m=!!u&&(null===L||void 0===L?void 0:L.find((function(e){return I()(e,c)}))),f=u?null===w||void 0===w||null===(i=w.find((function(e){return I()(e.path,c)})))||void 0===i?void 0:i.color:null,h=u?c.join("__"):c,g={type:"horizontal-bar",uid:"bar-track-".concat(h),data:{type:"zarr-multivec",url:e,row:o},options:{name:d,showMousePosition:!0,mousePositionColor:t,labelColor:"dark"===n?"white":"black",labelBackgroundColor:"dark"===n?"black":"white",labelShowAssembly:!1},height:l};if(f&&m){var b=f;g.options.barFillColor="rgb(".concat(b[0],",").concat(b[1],",").concat(b[2],")")}else g.options.barFillColor=r;return g}));return{tracks:{top:[].concat(o,Object(c.a)(u)),left:[],center:[],right:[],bottom:[],whole:[],gallery:[]},layout:{w:12,h:12,x:0,y:0,static:!1}}}),[H,M,n,O,s,p,L,w,m,h]);return Object(i.useEffect)((function(){z(),P()}),[j,S]),l.a.createElement("div",{className:"higlass-title-wrapper"},l.a.createElement(tr,{title:b,removeGridComponent:a,theme:n,isReady:k,urls:M},l.a.createElement("div",{className:"higlass-lazy-wrapper",ref:x},F?l.a.createElement(zs,{coordinationScopes:t,theme:n,hgViewConfig:F,height:O}):null)))},cellSetExpression:function(e){var t=e.coordinationScopes,n=e.removeGridComponent,a=e.theme,r=zn(),s=Rn(ra.cellSetExpression,t),c=Object(o.a)(s,2),u=c[0],p=u.dataset,d=u.geneSelection,m=u.geneExpressionTransform,f=u.cellSetSelection,h=u.cellSetColor,g=u.additionalCellSets,b=c[1].setGeneExpressionTransform,y=pa(),v=Object(o.a)(y,3),O=v[0],x=v[1],j=v[2],E=fa(),C=Object(o.a)(E,3),S=C[0],w=C[1],L=C[2],T=ma(nc),A=Object(o.a)(T,3),k=A[0],_=A[1],I=A[2],P=Object(i.useReducer)((function(e){var t=!e;return b(t?"log1p":null),t}),m),N=Object(o.a)(P,2),R=N[0],M=N[1];Object(i.useEffect)((function(){L(),I()}),[r,p]);var D=ja(r,p,_,!1,d),z=Object(o.a)(D,1)[0],G=Ea(r,p,_,w,!1),H=Object(o.a)(G,1)[0],F=Oa(r,p,_,w,!0),X=Qs(z,H,Object(o.a)(F,1)[0],g,d,f,h,R),B=Object(o.a)(X,3),Z=B[0],U=B[1],V=B[2],Y=d&&d.length>=1?d[0]:null;return l.a.createElement(tr,{title:"Expression by Cell Set".concat(Y?" (".concat(Y,")"):""),removeGridComponent:n,urls:S,theme:a,isReady:k,options:l.a.createElement(ec,{useGeneExpressionTransform:R,toggleGeneExpressionTransform:M})},l.a.createElement("div",{ref:j,className:"vega-container"},Z?l.a.createElement(tc,{domainMax:V,colors:U,data:Z,theme:a,width:O,height:x,useGeneExpressionTransform:R}):l.a.createElement("span",null,"Select a gene.")))},higlass:function(e){var t=e.coordinationScopes,n=e.theme,a=e.hgViewConfig,r=e.removeGridComponent,i=pa(),s=Object(o.a)(i,3),c=(s[0],s[1]),u=s[2],p=ma(Gs),d=Object(o.a)(p,3),m=d[0],f=(d[1],d[2],fa()),h=Object(o.a)(f,3),g=h[0];return h[1],h[2],l.a.createElement("div",{className:"higlass-title-wrapper"},l.a.createElement(tr,{title:"HiGlass",removeGridComponent:r,theme:n,isReady:m,urls:g},l.a.createElement("div",{className:"higlass-lazy-wrapper",ref:u},l.a.createElement(zs,{coordinationScopes:t,theme:n,hgViewConfig:a,height:c}))))}};function rc(e){if(void 0===ac[e])throw new Error('Could not find definition for "'.concat(e,'" in registry.'));return ac[e]}function oc(e,t){var n,a=Object.keys((null===e||void 0===e||null===(n=e.coordinationSpace)||void 0===n?void 0:n[t])||{}),r=e.layout.map((function(e){var n;return null===(n=e.coordinationScopes)||void 0===n?void 0:n[t]}));return Array.from(new Set([].concat(Object(c.a)(a),Object(c.a)(r))))}function ic(e){var t=e,n=t,a=n.layout,r=n.datasets;return Object.values(ta).forEach((function(e){if(!a.every((function(t){var n;return!ra[t.component].includes(e)||(null===(n=t.coordinationScopes)||void 0===n?void 0:n[e])}))){var n=na[e];"dataset"===e&&r.length>=1&&(n=r[0].uid),t=aa.includes(e)?function(e,t,n){var a=Object(s.a)({},e,{layout:Object(c.a)(e.layout)}),r={};return a.layout.forEach((function(o,i){var l;if(ra[o.component].includes(t)&&!(null===(l=o.coordinationScopes)||void 0===l?void 0:l[t])){var u=Y([].concat(Object(c.a)(oc(e,t)),Object(c.a)(Object.keys(r))));r[u]=n,a.layout[i]=Object(s.a)({},o,{coordinationScopes:Object(s.a)({},o.coordinationScopes,Object(B.a)({},t,u))})}})),a.coordinationSpace=Object(s.a)({},a.coordinationSpace,Object(B.a)({},t,Object(s.a)({},a.coordinationSpace[t],{},r))),a}(t,e,n):function(e,t,n){var a,r=Y(oc(e,t));return Object(s.a)({},e,{coordinationSpace:Object(s.a)({},e.coordinationSpace,Object(B.a)({},t,Object(s.a)({},null===e||void 0===e||null===(a=e.coordinationSpace)||void 0===a?void 0:a[t],Object(B.a)({},r,n)))),layout:e.layout.map((function(e){var n;return Object(s.a)({},e,{coordinationScopes:Object(s.a)({},e.coordinationScopes,{},ra[e.component].includes(t)&&!(null===(n=e.coordinationScopes)||void 0===n?void 0:n[t])?Object(B.a)({},t,r):{})})}))})}(t,e,n)}})),t}var lc=Object(T.a)({disableGlobal:!0});function sc(e){var t=e.config,n=e.rowHeight,a=e.height,r=e.theme,s=e.onWarn,c=e.onConfigChange,u=e.onLoaderChange,p=e.validateOnConfigChange,d=void 0!==p&&p,m=Object(i.useMemo)((function(){if(!t)return[{title:"No such dataset",unformatted:"The dataset configuration could not be found."},!1];if(!t.version)return[{title:"Missing version",unformatted:"The dataset configuration is missing a version, preventing validation."},!1];var e=function(e){var t,n,a,r=e;do{if(t=r.version,!Object.keys(ia).includes(t))return[{title:"Config validation failed",preformatted:"Unknown config version."},!1];var i=Object(o.a)(ia[t],2);if(a=i[0],n=i[1],!a(r))return[{title:"Config validation failed",preformatted:JSON.stringify(a.errors,null,2)},!1];n&&(r=n(r))}while(n);return console.groupCollapsed("\ud83d\ude84 Vitessce (".concat(mr.version,") view configuration")),console.info("data:,".concat(JSON.stringify(r))),console.info(JSON.stringify(r,null,2)),console.groupEnd(),[r,!0]}(t),n=Object(o.a)(e,2),a=n[0];return n[1]?[function(e){return"auto"===e.initStrategy?ic(e):e}(a),!0]:[a,!1]}),[t]),f=Object(o.a)(m,2),h=f[0],g=f[1];return Object(i.useEffect)((function(){g&&!I()(h,t)&&c&&c(h)}),[g,t,h,c]),g?l.a.createElement(A.b,{generateClassName:lc},l.a.createElement(k.a,{theme:D[r]},l.a.createElement(Yn,{config:h,getComponent:rc,rowHeight:n,height:a,theme:r}),l.a.createElement(la,{onWarn:s,onConfigChange:c,onLoaderChange:u,validateOnConfigChange:d}))):l.a.createElement(L,Object.assign({theme:r},h))}n(1311),n(1312),n(1313);function cc(e){var t=e.response,n=e.theme,a=Object(i.useState)(!0),r=Object(o.a)(a,2),s=r[0],c=r[1],u=Object(i.useRef)();return Object(i.useEffect)((function(){t.then((function(e){u.current=e,c(!1)}))}),[t]),s?l.a.createElement(L,{title:"Loading...",theme:n}):l.a.createElement(u.current)}function uc(e){return"\n    ok: ".concat(e.ok,"\n    status: ").concat(e.status,"\n    statusText: ").concat(e.statusText,"\n    redirected: ").concat(e.redirected,"\n    type: ").concat(e.type,"\n    url: ").concat(e.url)}n(846),n(610);!function(e,t){r.a.render(e,document.getElementById(t))}(function(){var e=new URLSearchParams(window.location.search).get("dataset");if(e){var t=x[e];return l.a.createElement(sc,{config:t,rowHeight:600,theme:"dark"})}var n=fetch("config.json").then((function(e){return function(e,t){return e.ok?e.text().then((function(n){try{var a=window.location.href.split("?")[0],r=n.replaceAll("http://localhost/",a),o=JSON.parse(r);return Promise.resolve((function(){return l.a.createElement(sc,{config:o,rowHeight:600,theme:t})}))}catch(i){return Promise.resolve((function(){return l.a.createElement(L,{title:"Error parsing JSON",preformatted:uc(e),unformatted:"".concat(i.message,": ").concat(n),theme:t})}))}})):Promise.resolve((function(){return l.a.createElement(L,{title:"Fetch response not OK",preformatted:uc(e),theme:t})}))}(e,"dark")})).catch((function(e){return Promise.resolve((function(){return l.a.createElement(L,{title:"Error fetching",unformatted:e.message,theme:"dark"})}))}));return l.a.createElement(cc,{response:n,theme:"dark"})}(),"full-app")},192:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://github.com/hubmapconsortium/vitessce/#cell-sets","title":"Vitessce cell sets data","type":"object","definitions":{"stringArray":{"type":"array","items":{"type":"string"}},"stringProbabilityTupleArray":{"type":"array","items":{"type":"array","additionalItems":false,"items":[{"type":"string"},{"oneOf":[{"type":"number","minimum":0,"maximum":1},{"type":"null"}]}]}},"colorArray":{"type":"array","items":{"type":"integer","minimum":0,"maximum":255},"minItems":3,"maxItems":3},"treeNodeLeaf":{"type":"object","additionalProperties":false,"required":["name"],"properties":{"name":{"type":"string"},"color":{"$ref":"#/definitions/colorArray"},"set":{"$ref":"#/definitions/stringArray"}}},"treeNodeNonLeaf":{"type":"object","additionalProperties":false,"required":["name"],"properties":{"name":{"type":"string"},"color":{"$ref":"#/definitions/colorArray"},"children":{"type":"array","items":{"$ref":"#/definitions/treeNode"}}}},"treeNode":{"oneOf":[{"$ref":"#/definitions/treeNodeNonLeaf"},{"$ref":"#/definitions/treeNodeLeaf"}]},"version0.1.2":{"type":"object","additionalProperties":false,"required":["version","datatype","tree"],"properties":{"dataset":{"type":"string"},"version":{"type":"string","enum":["0.1.2"]},"datatype":{"type":"string","enum":["cell"]},"tree":{"type":"array","items":{"$ref":"#/definitions/treeNodeNonLeaf"}}}},"treeNodeLeafProbabilistic":{"type":"object","additionalProperties":false,"required":["name"],"properties":{"name":{"type":"string"},"color":{"$ref":"#/definitions/colorArray"},"set":{"$ref":"#/definitions/stringProbabilityTupleArray"}}},"treeNodeNonLeafProbabilistic":{"type":"object","additionalProperties":false,"required":["name"],"properties":{"name":{"type":"string"},"color":{"$ref":"#/definitions/colorArray"},"children":{"type":"array","items":{"$ref":"#/definitions/treeNodeProbabilistic"}}}},"treeNodeProbabilistic":{"oneOf":[{"$ref":"#/definitions/treeNodeNonLeafProbabilistic"},{"$ref":"#/definitions/treeNodeLeafProbabilistic"}]},"version0.1.3":{"type":"object","additionalProperties":false,"required":["version","datatype","tree"],"properties":{"dataset":{"type":"string"},"version":{"type":"string","enum":["0.1.3"]},"datatype":{"type":"string","enum":["cell"]},"tree":{"type":"array","items":{"$ref":"#/definitions/treeNodeNonLeafProbabilistic"}}}}},"oneOf":[{"$ref":"#/definitions/version0.1.2"},{"$ref":"#/definitions/version0.1.3"}]}')},210:function(e){e.exports=JSON.parse('{"name":"vitessce","version":"1.1.12","description":"Vitessce app and React component library","author":"C McCallum","homepage":"http://vitessce.io/","license":"MIT","repository":"https://github.com/hubmapconsortium/vitessce/","keywords":["react-component"],"files":["dist","src"],"main":"dist/umd/production/index.min.js","module":"dist/es/production/index.min.js","peerDependencies":{"react":"^16.8.6","react-dom":"^16.8.6"},"dependencies":{"@hms-dbmi/viv":"^0.10.4","@loaders.gl/3d-tiles":"^2.3.0","@loaders.gl/core":"^2.3.0","@loaders.gl/images":"^2.3.0","@loaders.gl/loader-utils":"^2.3.0","@luma.gl/core":"^8.4.0","@material-ui/core":"^4.8.3","@material-ui/icons":"^4.9.1","@turf/boolean-contains":"^6.0.1","@turf/boolean-overlap":"^6.0.1","@turf/boolean-point-in-polygon":"^6.0.1","@turf/boolean-within":"^6.0.1","@turf/centroid":"^6.0.2","@turf/helpers":"^6.1.4","ajv":"^6.10.0","bowser":"^2.11.0","classnames":"^2.2.6","clsx":"^1.1.1","concaveman":"^1.2.0","d3-array":"^2.4.0","d3-dsv":"^1.1.1","d3-force":"^2.1.1","d3-quadtree":"^1.0.7","d3-scale-chromatic":"^1.3.3","deck.gl":"^8.4.0","dynamic-import-polyfill":"^0.1.1","fast-deep-equal":"^3.1.3","glslify":"^7.0.0","higlass":"1.11.4","higlass-register":"^0.3.0","higlass-zarr-datafetchers":"^0.2.0","json2csv":"^4.5.2","lodash":"^4.17.15","lz-string":"^1.4.4","math.gl":"^3.1.3","mathjs":"^9.2.0","nebula.gl":"^0.21.1","prop-types":"^15.7.2","rc-tooltip":"^4.0.3","rc-tree":"2.1.0","react-color":"^2.18.0","react-grid-layout":"^1.1.1","react-vega":"^7.3.0","react-virtualized":"^9.22.2","short-number":"^1.0.6","store":"^2.0.12","tinycolor2":"^1.4.1","uuid":"^3.3.2","vega":"^5.13.0","vega-lite":"^4.13.0","vega-tooltip":"^0.23.0","whatwg-fetch":"^3.0.0","window-pixi":"5.3.3","zarr":"^0.4.0","zustand":"^3.0.2"},"devDependencies":{"@babel/core":"7.9.0","@svgr/webpack":"5.3.1","@typescript-eslint/eslint-plugin":"^2.10.0","@typescript-eslint/parser":"^2.10.0","babel-eslint":"10.0.3","babel-loader":"8.1.0","babel-plugin-glsl":"^1.0.0","babel-plugin-named-asset-import":"^0.3.6","babel-preset-react-app":"^9.1.2","camelcase":"^5.3.1","case-sensitive-paths-webpack-plugin":"2.3.0","concurrently":"^5.3.0","css-loader":"3.4.2","cypress":"^3.6.1","cypress-fail-on-console-error":"^2.0.6","dotenv":"8.2.0","dotenv-expand":"5.1.0","enzyme":"^3.9.0","enzyme-adapter-react-16":"^1.11.2","eslint":"^6.6.0","eslint-config-airbnb":"^17.1.0","eslint-config-react-app":"^5.2.0","eslint-loader":"3.0.3","eslint-plugin-cypress":"^2.2.1","eslint-plugin-flowtype":"4.6.0","eslint-plugin-import":"2.20.0","eslint-plugin-jsx-a11y":"6.2.3","eslint-plugin-react":"7.18.0","eslint-plugin-react-hooks":"^1.6.1","eslint-plugin-vitessce-rules":"file:eslint","expect":"^24.5.0","file-loader":"4.3.0","fs-extra":"^8.1.0","glsl-colormap":"^1.0.1","html-webpack-plugin":"4.0.0-beta.11","http-server":"^0.12.3","identity-obj-proxy":"3.0.0","js-yaml":"^3.13.1","karma":"4.4.1","karma-chrome-launcher":"3.1.0","karma-mocha":"1.3.0","karma-mocha-reporter":"2.2.5","karma-sourcemap-loader":"0.3.7","karma-webpack":"4.0.2","mini-css-extract-plugin":"0.9.0","mocha":"7.1.0","node-sass":"^5.0.0","object.fromentries":"^2.0.2","optimize-css-assets-webpack-plugin":"5.0.3","pnp-webpack-plugin":"1.6.0","postcss-flexbugs-fixes":"4.1.0","postcss-loader":"3.0.0","postcss-normalize":"8.0.1","postcss-preset-env":"6.7.0","postcss-safe-parser":"4.0.1","react":"^16.8.6","react-app-polyfill":"^1.0.6","react-dev-utils":"^10.2.0","react-dom":"^16.8.6","resolve":"1.15.0","resolve-url-loader":"3.1.1","sass-loader":"^10.0.1","semver":"6.3.0","style-loader":"0.23.1","terser-webpack-plugin":"2.3.4","url-loader":"2.3.0","wait-on":"^3.2.0","webpack":"4.41.5","webpack-dev-server":"3.10.2","webpack-node-externals":"^2.5.2","workbox-webpack-plugin":"4.3.1","worker-loader":"^2.0.0"},"resolutions":{"@turf/difference":"6.0.1"},"scripts":{"build-demo:prod":"node scripts/build-demo.js production","build-lib:prod":"node scripts/build-lib.js production","build-demo:dev":"node scripts/build-demo.js development","build-lib:dev":"node scripts/build-lib.js development","build:prod":"npm run build-demo:prod && npm run build-lib:prod","build:dev":"npm run build-demo:dev && npm run build-lib:dev","prepublishOnly":"npm run build-lib:prod","clean":"rm -r dist-demo dist","start":"node scripts/start-demo.js","start:fixtures":"http-server src/loaders/fixtures/ --cors=\\"*\\" -s","start:fixtures-concurrently":"concurrently --kill-others \\"npm run start:fixtures\\"","test":"npm run start:fixtures-concurrently -- --success first \\"karma start scripts/karma.config.js --single-run\\"","test:watch":"npm run start:fixtures-concurrently -- \\"karma start scripts/karma.config.js --auto-watch\\"","cypress:open":"npm run start:fixtures-concurrently -- \\"cypress open\\"","cypress:run":"npm run start:fixtures-concurrently -- --success first --kill-others \\"cypress run\\"","lint-fix":"eslint -c .eslintrc.yml --ext .js --fix src/"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"babel":{"presets":["react-app"],"plugins":["glsl"]}}')},234:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://github.com/hubmapconsortium/vitessce/#raster","title":"Vitessce image data","type":"object","definitions":{"transform":{"type":"object","additionalProperties":false,"oneOf":[{"required":["scale","translate"]},{"required":["matrix"]}],"properties":{"scale":{"type":"number"},"translate":{"type":"object","additionalProperties":false,"required":["y","x"],"properties":{"y":{"type":"number"},"x":{"type":"number"}}},"matrix":{"type":"array","items":{"type":"number"},"minItems":16,"maxItems":16}}},"dimensions":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["field","type","values"],"properties":{"field":{"type":"string"},"type":{"type":"string","enum":["quantitative","nominal","ordinal","temporal"]},"values":{"type":["array","null"],"items":{"type":"string"}}}}},"metadata":{"type":"object","additionalProperties":false,"anyOf":[{"required":["dimensions","isPyramid"]},{"required":["transform"]},{"required":["omeTiffOffsetsUrl"]},{"required":["isBitmask"]}],"properties":{"dimensions":{"$ref":"#/definitions/dimensions"},"isPyramid":{"type":"boolean"},"transform":{"$ref":"#/definitions/transform"},"isBitmask":{"type":"boolean"},"omeTiffOffsetsUrl":{"type":"string","format":"uri"}}},"requestInit":{"type":"object","additionalProperties":false,"required":[],"properties":{"method":{"type":"string"},"headers":{"type":"object"},"body":{"type":"string"},"mode":{"type":"string"},"credentials":{"type":"string"},"cache":{"type":"string"},"redirect":{"type":"string"},"referrer":{"type":"string"},"integrity":{"type":"string"}}},"image":{"type":"object","additionalProperties":false,"required":["name","url","type"],"properties":{"name":{"type":"string"},"url":{"type":"string","format":"uri"},"type":{"type":"string"},"metadata":{"$ref":"#/definitions/metadata"},"requestInit":{"$ref":"#/definitions/requestInit"}}}},"additionalProperties":false,"required":["schemaVersion","images"],"properties":{"schemaVersion":{"type":"string"},"usePhysicalSizeScaling":{"type":"boolean","description":"Default is false: passing true in will infer scaling from the reported physcial size"},"renderLayers":{"type":"array","items":{"type":"string"}},"images":{"type":"array","items":{"$ref":"#/definitions/image"}}}}')},383:function(e,t){},384:function(e,t){},597:function(e,t){},598:function(e,t){},599:function(e,t){},605:function(e,t){},781:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://github.com/hubmapconsortium/vitessce/#cells","title":"Vitessce cell data","type":"object","definitions":{"coord":{"type":"array","minItems":2,"maxItems":2,"items":{"type":"number"}},"positiveFloatValues":{"type":"object","patternProperties":{".":{"type":"number","minimum":0}}},"stringValues":{"type":"object","patternProperties":{".":{"type":"string"}}}},"patternProperties":{".":{"additionalProperties":false,"required":[],"properties":{"mappings":{"type":"object","patternProperties":{".":{"$ref":"#/definitions/coord"}}},"xy":{"$ref":"#/definitions/coord"},"genes":{"$ref":"#/definitions/positiveFloatValues"},"factors":{"$ref":"#/definitions/stringValues"},"poly":{"type":"array","items":{"$ref":"#/definitions/coord"}}}}}}')},782:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://github.com/hubmapconsortium/vitessce/#molecules","title":"Vitessce molecule data","type":"object","definitions":{"coord":{"type":"array","maxItems":2,"minItems":2,"items":{"type":"number"}}},"patternProperties":{".":{"type":"array","items":{"$ref":"#/definitions/coord"}}}}')},783:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://github.com/hubmapconsortium/vitessce/#neighborhoods","title":"Vitessce neighborhood data","type":"object","definitions":{"coord":{"type":"array","maxItems":2,"minItems":2,"items":{"type":"number"}}},"patternProperties":{".":{"additionalProperties":false,"required":["poly"],"properties":{"poly":{"type":"array","maxItems":3,"minItems":3,"items":{"$ref":"#/definitions/coord"}}}}}}')},784:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://github.com/hubmapconsortium/vitessce/#genes","title":"Vitessce gene data","type":"object","definitions":{"positiveFloatValues":{"type":"object","patternProperties":{".":{"type":"number","minimum":0}}}},"patternProperties":{".":{"additionalProperties":false,"required":["max","cells"],"properties":{"max":{"type":"number"},"cells":{"$ref":"#/definitions/positiveFloatValues"}}}}}')},785:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://github.com/hubmapconsortium/vitessce/#clusters","title":"Vitessce cluster data","type":"object","definitions":{"stringArray":{"type":"array","items":{"type":"string"}},"matrix":{"type":"array","items":{"type":"array","items":{"type":"number","minimum":0,"maximum":1}}}},"additionalProperties":false,"required":["rows","cols","matrix"],"properties":{"rows":{"$ref":"#/definitions/stringArray"},"cols":{"$ref":"#/definitions/stringArray"},"matrix":{"$ref":"#/definitions/matrix"}}}')},806:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://github.com/hubmapconsortium/vitessce/#cell-sets-tabular","title":"Vitessce cell sets data, tabular format","definitions":{"colorArray":{"type":"array","items":{"type":"integer","minimum":0,"maximum":255},"minItems":3,"maxItems":3}},"type":"array","items":{"type":"object","additionalProperties":false,"required":["groupName","setName","obsId"],"properties":{"groupName":{"type":"string"},"setName":{"type":"string"},"setColor":{"$ref":"#/definitions/colorArray"},"obsId":{"type":"string"},"predictionScore":{"oneOf":[{"type":"number","minimum":0,"maximum":1},{"type":"null"}]}}}}')},809:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://github.com/hubmapconsortium/vitessce/#dataset","title":"Vitessce data set","type":"object","definitions":{"components":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["component","x","y"],"properties":{"component":{"type":"string"},"props":{"type":"object"},"x":{"type":"integer"},"y":{"type":"integer"},"w":{"type":"integer"},"h":{"type":"integer"}}}},"requestInit":{"type":"object","additionalProperties":false,"required":[],"properties":{"method":{"type":"string"},"headers":{"type":"object"},"body":{"type":"string"},"mode":{"type":"string"},"credentials":{"type":"string"},"cache":{"type":"string"},"redirect":{"type":"string"},"referrer":{"type":"string"},"integrity":{"type":"string"}}}},"additionalProperties":false,"required":["version","name","layers"],"properties":{"name":{"type":"string"},"public":{"type":"boolean"},"description":{"type":"string"},"layers":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["name","type","fileType","url"],"properties":{"name":{"type":"string"},"type":{"type":"string"},"fileType":{"type":"string"},"url":{"type":"string"},"requestInit":{"$ref":"#/definitions/requestInit"}}}},"staticLayout":{"$ref":"#/definitions/components"},"version":{"type":"string","enum":["0.1.0"]}}}')},810:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://github.com/hubmapconsortium/vitessce/#dataset","title":"Vitessce data set","type":"object","definitions":{"components":{"description":"The layout array defines the views, or components, rendered in the grid.","type":"array","items":{"type":"object","additionalProperties":false,"required":["component","x","y"],"properties":{"component":{"type":"string","description":"Specify a component using a name defined in the component registry."},"props":{"type":"object","description":"Extra prop values for the component."},"x":{"type":"integer"},"y":{"type":"integer"},"w":{"type":"integer"},"h":{"type":"integer"},"coordinationScopes":{"type":"object","description":"Component-level coordination scope mappings define which coordination object values a particular component can read and write, for each coordination type.","additionalProperties":false,"required":[],"properties":{"dataset":{"type":"string"},"embeddingType":{"type":"string"},"embeddingZoom":{"type":"string"},"embeddingRotation":{"type":"string"},"embeddingTargetX":{"type":"string"},"embeddingTargetY":{"type":"string"},"embeddingTargetZ":{"type":"string"},"embeddingCellSetPolygonsVisible":{"type":"string"},"embeddingCellSetLabelsVisible":{"type":"string"},"embeddingCellSetLabelSize":{"type":"string"},"embeddingCellRadius":{"type":"string"},"spatialZoom":{"type":"string"},"spatialRotation":{"type":"string"},"spatialTargetX":{"type":"string"},"spatialTargetY":{"type":"string"},"spatialTargetZ":{"type":"string"},"heatmapZoomX":{"type":"string"},"heatmapZoomY":{"type":"string"},"heatmapTargetX":{"type":"string"},"heatmapTargetY":{"type":"string"},"cellFilter":{"type":"string"},"cellHighlight":{"type":"string"},"cellSetSelection":{"type":"string"},"cellSetHighlight":{"type":"string"},"cellSetColor":{"type":"string"},"geneFilter":{"type":"string"},"geneHighlight":{"type":"string"},"geneSelection":{"type":"string"},"geneExpressionTransform":{"type":"string"},"geneExpressionColormap":{"type":"string"},"geneExpressionColormapRange":{"type":"string"},"cellColorEncoding":{"type":"string"},"spatialLayers":{"type":"string"},"genomicZoomX":{"type":"string"},"genomicZoomY":{"type":"string"},"genomicTargetX":{"type":"string"},"genomicTargetY":{"type":"string"},"additionalCellSets":{"type":"string"},"moleculeHighlight":{"type":"string"}}}}}},"annDataCellSets":{"type":"array","description":"Array of cell set configuration, following closely the conventions of the tabular schema","items":{"type":"object","additionalProperties":false,"required":["groupName","setName"],"properties":{"groupName":{"type":"string","description":"The display name for the set, like \'Cell Type\' or \'Louvain.\'"},"setName":{"type":"string","description":"The location in the AnnData store for the set, like \'obs/louvain\' or \'obs/celltype.\'"}}}},"annDataCells":{"type":"object","description":"The properties of this object are the configuration for how to layout scatterplots and spatial information","minProperties":1,"additionalProperties":false,"required":[],"properties":{"xy":{"type":"string","description":"The location in the AnnData store of cell centroids, like \'obsm/X_centroids.\'"},"poly":{"type":"string","description":"The location in the AnnData store of cell polygon outlines, like \'obsm/X_polygons.\'"},"factors":{"type":"array","description":"List of locations in the AnnData store of cell sets, like \'obs/louvain\'","items":{"type":"string"}},"mappings":{"patternProperties":{".":{"type":"object","description":"An object containing key-values for mappings like { UMAP: { key: \'obsm/X_umap\', dims: [0, 1] } }.","additionalProperties":false,"required":["key"],"properties":{"key":{"type":"string","description":"Where to look in the AnnData store for this mapping, like \'obsm/X_umap.\'"},"dims":{"type":"array","description":"Which indices of the obsm object to take for a scatterplot, allowing for, for example, different PCs from obsm/X_pca","minItems":2,"maxItems":2,"items":{"type":"number"}}}}}}}},"annDataExpressionMatrix":{"type":"object","description":"The properties of this object are the configuration for how to fetch the cell x genes matrix","additionalProperties":false,"required":["matrix"],"properties":{"matrix":{"type":"string","description":"The location in the AnnData store of the cell x gene matrix, like \'obsm/hvg_subset.\' or \'X\'"},"geneFilter":{"type":"string","description":"The location in the AnnData store of a filter for the genes if using a subset of the data, like \'var.highly_variable.\' if the matrix comes from \'obsm/hvg_subset.\'"},"matrixGeneFilter":{"type":"string","description":"The location in the AnnData store of a filter for the matrix data (used in heatmap and histogram), like \'var.highly_variable.\'\'"}}},"requestInit":{"type":"object","description":"The properties of this object correspond to the parameters of the JavaScript fetch() function.","additionalProperties":false,"required":[],"properties":{"method":{"type":"string"},"headers":{"type":"object"},"body":{"type":"string"},"mode":{"type":"string"},"credentials":{"type":"string"},"cache":{"type":"string"},"redirect":{"type":"string"},"referrer":{"type":"string"},"integrity":{"type":"string"}}},"rasterLayer":{"description":"The properties of this object are the rendering settings for the raster layer.","additionalProperties":false,"required":["channels","colormap","index","opacity","type"],"properties":{"channels":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["selection"],"properties":{"color":{"type":"array","items":{"type":"number"},"description":"The color to use when rendering this channel under the null colormap."},"selection":{"type":"object","description":"Determines the channel selection, e.g. some Z and time slice."},"slider":{"type":"array","items":{"type":"number"},"description":"Determines the range for color mapping."},"visible":{"type":"boolean","description":"Determines whether this channel of the layer will be rendered in the spatial component."}}}},"colormap":{"oneOf":[{"type":"string","description":"The name of the colormap to use for this layer."},{"type":"null","description":"Use the solid color definitions."}]},"transparentColor":{"oneOf":[{"type":"array","minItems":3,"maxItems":3,"items":{"type":"number","description":"One of R G or B (0 - 255)."},"description":"Determines the color to be set to opacity 0"},{"type":"null","description":"No selection."}]},"index":{"type":"number","description":"The index of the layer among the array of layers available in the image file."},"modelMatrix":{"oneOf":[{"type":"array","minItems":16,"maxItems":16,"description":"transformation matrix for this layer"},{"type":"null","description":"Use no transformation."}]},"opacity":{"type":"number"},"domainType":{"type":"string","enum":["Full","Min/Max"],"description":"Determines the extent of the channel slider input element in the layer controller."},"type":{"type":"string","enum":["raster"]}}},"moleculesLayer":{"description":"The properties of this object are the rendering settings for the molecules layer.","additionalProperties":false,"required":["visible","radius","opacity","type"],"properties":{"visible":{"type":"boolean"},"radius":{"type":"number"},"opacity":{"type":"number"},"type":{"type":"string","enum":["molecules"]}}},"cellsLayer":{"description":"The properties of this object are the rendering settings for the cells layer.","additionalProperties":false,"required":["visible","stroked","radius","opacity","type"],"properties":{"visible":{"type":"boolean"},"stroked":{"type":"boolean"},"radius":{"type":"number"},"opacity":{"type":"number"},"type":{"type":"string","enum":["cells"]}}},"neighborhoodsLayer":{"description":"The properties of this object are the rendering settings for the neighborhoods layer.","additionalProperties":false,"required":["visible","type"],"properties":{"visible":{"type":"boolean"},"type":{"type":"string","enum":["neighborhoods"]}}},"spatialLayers":{"type":"array","description":"Array of Spatial Layers","items":{"oneOf":[{"$ref":"#/definitions/rasterLayer"},{"$ref":"#/definitions/cellsLayer"},{"$ref":"#/definitions/moleculesLayer"},{"$ref":"#/definitions/neighborhoodsLayer"}]}}},"additionalProperties":false,"required":["version","name","datasets","layout","initStrategy"],"properties":{"name":{"type":"string"},"public":{"type":"boolean"},"description":{"type":"string"},"datasets":{"type":"array","description":"The datasets array defines groups of files, where the files within each dataset reference the same entities (cells, genes, cell sets, etc).","items":{"type":"object","additionalProperties":false,"required":["uid","files"],"properties":{"uid":{"type":"string"},"name":{"type":"string"},"description":{"type":"string"},"files":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["type","fileType"],"properties":{"name":{"type":"string"},"type":{"type":"string"},"fileType":{"type":"string"},"url":{"type":"string"},"options":{"oneOf":[{"$ref":"#/definitions/annDataCellSets"},{"$ref":"https://github.com/hubmapconsortium/vitessce/#raster"},{"$ref":"#/definitions/annDataCells"},{"$ref":"#/definitions/annDataExpressionMatrix"}]},"requestInit":{"$ref":"#/definitions/requestInit"}}}}}}},"coordinationSpace":{"type":"object","description":"The coordination space stores the values for each scope of each coordination object.","additionalProperties":false,"required":[],"properties":{"dataset":{"type":"object","patternProperties":{".":{"type":"string"}}},"embeddingZoom":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"embeddingRotation":{"type":"object","patternProperties":{".":{"type":"number"}}},"embeddingTargetX":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"embeddingTargetY":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"embeddingTargetZ":{"type":"object","patternProperties":{".":{"type":"number"}}},"embeddingType":{"type":"object","patternProperties":{".":{"type":"string"}}},"embeddingCellSetPolygonsVisible":{"type":"object","patternProperties":{".":{"type":"boolean"}}},"embeddingCellSetLabelsVisible":{"type":"object","patternProperties":{".":{"type":"boolean"}}},"embeddingCellSetLabelSize":{"type":"object","patternProperties":{".":{"type":"number"}}},"embeddingCellRadius":{"type":"object","patternProperties":{".":{"type":"number"}}},"spatialZoom":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"spatialRotation":{"type":"object","patternProperties":{".":{"type":"number"}}},"spatialTargetX":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"spatialTargetY":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"spatialTargetZ":{"type":"object","patternProperties":{".":{"type":"number"}}},"spatialLayers":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided and auto layer initialization is enabled, layers will be automatically initialized."},{"$ref":"#/definitions/spatialLayers"}]}}},"heatmapZoomX":{"type":"object","patternProperties":{".":{"type":"number"}}},"heatmapZoomY":{"type":"object","patternProperties":{".":{"type":"number"}}},"heatmapTargetX":{"type":"object","patternProperties":{".":{"type":"number"}}},"heatmapTargetY":{"type":"object","patternProperties":{".":{"type":"number"}}},"cellFilter":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no cells will be filtered out initially."},{"type":"array","items":{"type":"string"}}]}}},"cellHighlight":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no cell will be highlighted initially."},{"type":"string"}]}}},"cellSetSelection":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided and auto cell set initialization is enabled, cell set selections will be automatically initialized."},{"type":"array"}]}}},"cellSetHighlight":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no cell sets will be highlighted initially."},{"type":"string"}]}}},"cellSetColor":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, cell set colors will be automatically initialized."},{"type":"array","items":{"type":"object","additionalProperties":false,"required":["path","color"],"properties":{"path":{"type":"array","items":{"type":"string"}},"color":{"type":"array","items":{"type":"number"}}}}}]}}},"cellColorEncoding":{"type":"object","patternProperties":{".":{"type":"string"}}},"geneFilter":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no genes will be filtered out initially."},{"type":"array","items":{"type":"string"}}]}}},"geneHighlight":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no genes will be highlighted initially."},{"type":"string"}]}}},"geneSelection":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null"},{"type":"array","items":{"type":"string"}}]}}},"geneExpressionTransform":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null"},{"type":"string","pattern":"log1p"}]}}},"geneExpressionColormap":{"type":"object","patternProperties":{".":{"type":"string"}}},"geneExpressionColormapRange":{"type":"object","patternProperties":{".":{"type":"array","items":{"type":"number"}}}},"genomicZoomX":{"type":"object","patternProperties":{".":{"type":"number"}}},"genomicZoomY":{"type":"object","patternProperties":{".":{"type":"number"}}},"genomicTargetX":{"type":"object","patternProperties":{".":{"type":"number"}}},"genomicTargetY":{"type":"object","patternProperties":{".":{"type":"number"}}},"additionalCellSets":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no cell will be highlighted initially."},{"$ref":"https://github.com/hubmapconsortium/vitessce/#cell-sets"}]}}},"moleculeHighlight":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no molecule will be highlighted initially."},{"type":"string"}]}}}}},"layout":{"$ref":"#/definitions/components"},"initStrategy":{"type":"string","enum":["none","auto"],"description":"The initialization strategy determines how missing coordination objects and coordination scope mappings are initially filled in."},"version":{"type":"string","enum":["1.0.0"],"description":"The schema version for the view config."}}}')},811:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://github.com/hubmapconsortium/vitessce/#dataset","title":"Vitessce data set","type":"object","definitions":{"components":{"description":"The layout array defines the views, or components, rendered in the grid.","type":"array","items":{"type":"object","additionalProperties":false,"required":["component","x","y"],"properties":{"component":{"type":"string","description":"Specify a component using a name defined in the component registry."},"props":{"type":"object","description":"Extra prop values for the component."},"x":{"type":"integer"},"y":{"type":"integer"},"w":{"type":"integer"},"h":{"type":"integer"},"coordinationScopes":{"type":"object","description":"Component-level coordination scope mappings define which coordination object values a particular component can read and write, for each coordination type.","additionalProperties":false,"required":[],"properties":{"dataset":{"type":"string"},"embeddingType":{"type":"string"},"embeddingZoom":{"type":"string"},"embeddingRotation":{"type":"string"},"embeddingTargetX":{"type":"string"},"embeddingTargetY":{"type":"string"},"embeddingTargetZ":{"type":"string"},"embeddingCellSetPolygonsVisible":{"type":"string"},"embeddingCellSetLabelsVisible":{"type":"string"},"embeddingCellSetLabelSize":{"type":"string"},"embeddingCellRadius":{"type":"string"},"spatialZoom":{"type":"string"},"spatialRotation":{"type":"string"},"spatialTargetX":{"type":"string"},"spatialTargetY":{"type":"string"},"spatialTargetZ":{"type":"string"},"spatialRotationX":{"type":"string"},"spatialRotationY":{"type":"string"},"spatialRotationZ":{"type":"string"},"spatialRotationOrbit":{"type":"string"},"spatialOrbitAxis":{"type":"string"},"spatialAxisFixed":{"type":"string"},"heatmapZoomX":{"type":"string"},"heatmapZoomY":{"type":"string"},"heatmapTargetX":{"type":"string"},"heatmapTargetY":{"type":"string"},"cellFilter":{"type":"string"},"cellHighlight":{"type":"string"},"cellSetSelection":{"type":"string"},"cellSetHighlight":{"type":"string"},"cellSetColor":{"type":"string"},"geneFilter":{"type":"string"},"geneHighlight":{"type":"string"},"geneSelection":{"type":"string"},"geneExpressionTransform":{"type":"string"},"geneExpressionColormap":{"type":"string"},"geneExpressionColormapRange":{"type":"string"},"cellColorEncoding":{"type":"string"},"spatialRasterLayers":{"type":"string"},"spatialCellsLayer":{"type":"string"},"spatialMoleculesLayer":{"type":"string"},"spatialNeighborhoodsLayer":{"type":"string"},"genomicZoomX":{"type":"string"},"genomicZoomY":{"type":"string"},"genomicTargetX":{"type":"string"},"genomicTargetY":{"type":"string"},"additionalCellSets":{"type":"string"},"moleculeHighlight":{"type":"string"}}}}}},"annDataCellSets":{"type":"array","description":"Array of cell set configuration, following closely the conventions of the tabular schema","items":{"type":"object","additionalProperties":false,"required":["groupName","setName"],"properties":{"groupName":{"type":"string","description":"The display name for the set, like \'Cell Type\' or \'Louvain.\'"},"setName":{"type":"string","description":"The location in the AnnData store for the set, like \'obs/louvain\' or \'obs/celltype.\'"}}}},"annDataCells":{"type":"object","description":"The properties of this object are the configuration for how to layout scatterplots and spatial information","minProperties":1,"additionalProperties":false,"required":[],"properties":{"xy":{"type":"string","description":"The location in the AnnData store of cell centroids, like \'obsm/X_centroids.\'"},"poly":{"type":"string","description":"The location in the AnnData store of cell polygon outlines, like \'obsm/X_polygons.\'"},"factors":{"type":"array","description":"List of locations in the AnnData store of cell sets, like \'obs/louvain\'","items":{"type":"string"}},"mappings":{"patternProperties":{".":{"type":"object","description":"An object containing key-values for mappings like { UMAP: { key: \'obsm/X_umap\', dims: [0, 1] } }.","additionalProperties":false,"required":["key"],"properties":{"key":{"type":"string","description":"Where to look in the AnnData store for this mapping, like \'obsm/X_umap.\'"},"dims":{"type":"array","description":"Which indices of the obsm object to take for a scatterplot, allowing for, for example, different PCs from obsm/X_pca","minItems":2,"maxItems":2,"items":{"type":"number"}}}}}}}},"annDataExpressionMatrix":{"type":"object","description":"The properties of this object are the configuration for how to fetch the cell x genes matrix","additionalProperties":false,"required":["matrix"],"properties":{"matrix":{"type":"string","description":"The location in the AnnData store of the cell x gene matrix, like \'obsm/hvg_subset.\' or \'X\'"},"geneFilter":{"type":"string","description":"The location in the AnnData store of a filter for the genes if using a subset of the data, like \'var.highly_variable.\' if the matrix comes from \'obsm/hvg_subset.\'"},"matrixGeneFilter":{"type":"string","description":"The location in the AnnData store of a filter for the matrix data (used in heatmap and histogram), like \'var.highly_variable.\'\'"}}},"requestInit":{"type":"object","description":"The properties of this object correspond to the parameters of the JavaScript fetch() function.","additionalProperties":false,"required":[],"properties":{"method":{"type":"string"},"headers":{"type":"object"},"body":{"type":"string"},"mode":{"type":"string"},"credentials":{"type":"string"},"cache":{"type":"string"},"redirect":{"type":"string"},"referrer":{"type":"string"},"integrity":{"type":"string"}}},"rasterLayer":{"description":"The properties of this object are the rendering settings for the raster layer.","additionalProperties":false,"required":["channels","colormap","index","opacity"],"properties":{"channels":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["selection"],"properties":{"color":{"type":"array","items":{"type":"number"},"description":"The color to use when rendering this channel under the null colormap."},"selection":{"type":"object","description":"Determines the channel selection, e.g. some Z and time slice."},"slider":{"type":"array","items":{"type":"number"},"description":"Determines the range for color mapping."},"visible":{"type":"boolean","description":"Determines whether this channel of the layer will be rendered in the spatial component."}}}},"colormap":{"oneOf":[{"type":"string","description":"The name of the colormap to use for this layer."},{"type":"null","description":"Use the solid color definitions."}]},"transparentColor":{"oneOf":[{"type":"array","minItems":3,"maxItems":3,"items":{"type":"number","description":"One of R G or B (0 - 255)."},"description":"Determines the color to be set to opacity 0"},{"type":"null","description":"No selection."}]},"index":{"type":"number","description":"The index of the layer among the array of layers available in the image file."},"opacity":{"type":"number"},"modelMatrix":{"oneOf":[{"type":"array","minItems":16,"maxItems":16,"description":"transformation matrix for this layer"},{"type":"null","description":"Use no transformation."}]},"domainType":{"type":"string","enum":["Full","Min/Max"],"description":"Determines the extent of the channel slider input element in the layer controller."},"resolution":{"type":"number","description":"Resolution of 3D volumetric rendering"},"xSlice":{"oneOf":[{"type":"array","minItems":2,"maxItems":2,"description":"Slice bounds"},{"type":"null","description":"No slicing"}]},"renderingMode":{"type":"string","description":"Rendering mode of 3D volumetric rendering"},"ySlice":{"oneOf":[{"type":"array","minItems":2,"maxItems":2,"description":"Slice bounds"},{"type":"null","description":"No slicing"}]},"zSlice":{"oneOf":[{"type":"array","minItems":2,"maxItems":2,"description":"Slice bounds"},{"type":"null","description":"No slicing"}]},"type":{"type":"string"},"use3d":{"type":"boolean"},"visible":{"type":"boolean","description":"Determines whether this entire layer will be rendered in the spatial component."}}},"moleculesLayer":{"type":"object","description":"The properties of this object are the rendering settings for the molecules layer.","additionalProperties":false,"required":["visible","radius","opacity"],"properties":{"visible":{"type":"boolean"},"radius":{"type":"number"},"opacity":{"type":"number"}}},"cellsLayer":{"type":"object","description":"The properties of this object are the rendering settings for the cells layer.","additionalProperties":false,"required":["visible","stroked","radius","opacity"],"properties":{"visible":{"type":"boolean"},"stroked":{"type":"boolean"},"radius":{"type":"number"},"opacity":{"type":"number"}}},"neighborhoodsLayer":{"type":"object","description":"The properties of this object are the rendering settings for the neighborhoods layer.","additionalProperties":false,"required":["visible"],"properties":{"visible":{"type":"boolean"}}},"spatialRasterLayers":{"type":"array","description":"Array of Spatial Layers","items":{"$ref":"#/definitions/rasterLayer"}}},"additionalProperties":false,"required":["version","name","datasets","layout","initStrategy"],"properties":{"name":{"type":"string"},"public":{"type":"boolean"},"description":{"type":"string"},"datasets":{"type":"array","description":"The datasets array defines groups of files, where the files within each dataset reference the same entities (cells, genes, cell sets, etc).","items":{"type":"object","additionalProperties":false,"required":["uid","files"],"properties":{"uid":{"type":"string"},"name":{"type":"string"},"description":{"type":"string"},"files":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["type","fileType"],"properties":{"name":{"type":"string"},"type":{"type":"string"},"fileType":{"type":"string"},"url":{"type":"string"},"options":{"oneOf":[{"$ref":"#/definitions/annDataCellSets"},{"$ref":"https://github.com/hubmapconsortium/vitessce/#raster"},{"$ref":"#/definitions/annDataCells"},{"$ref":"#/definitions/annDataExpressionMatrix"}]},"requestInit":{"$ref":"#/definitions/requestInit"}}}}}}},"coordinationSpace":{"type":"object","description":"The coordination space stores the values for each scope of each coordination object.","additionalProperties":false,"required":[],"properties":{"dataset":{"type":"object","patternProperties":{".":{"type":"string"}}},"embeddingZoom":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"embeddingRotation":{"type":"object","patternProperties":{".":{"type":"number"}}},"embeddingTargetX":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"embeddingTargetY":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"embeddingTargetZ":{"type":"object","patternProperties":{".":{"type":"number"}}},"embeddingType":{"type":"object","patternProperties":{".":{"type":"string"}}},"embeddingCellSetPolygonsVisible":{"type":"object","patternProperties":{".":{"type":"boolean"}}},"embeddingCellSetLabelsVisible":{"type":"object","patternProperties":{".":{"type":"boolean"}}},"embeddingCellSetLabelSize":{"type":"object","patternProperties":{".":{"type":"number"}}},"embeddingCellRadius":{"type":"object","patternProperties":{".":{"type":"number"}}},"spatialZoom":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"spatialRotation":{"type":"object","patternProperties":{".":{"type":"number"}}},"spatialTargetX":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"spatialTargetY":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"spatialTargetZ":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"spatialRotationX":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set. Only useful for 3D viewing."},{"type":"number"}]}}},"spatialRotationY":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set. Only useful for 3D viewing."},{"type":"number"}]}}},"spatialRotationZ":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set. Only useful for 3D viewing."},{"type":"number"}]}}},"spatialRotationOrbit":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set. Only useful for 3D viewing."},{"type":"number"}]}}},"spatialOrbitAxis":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set. Only useful for 3D viewing."},{"type":"string"}]}}},"spatialAxisFixed":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"Whether or not to have a fixed axis for the camera. Only useful for 3D viewing."},{"type":"boolean"}]}}},"spatialRasterLayers":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided and auto layer initialization is enabled, layers will be automatically initialized."},{"$ref":"#/definitions/spatialRasterLayers"}]}}},"spatialCellsLayer":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided and auto layer initialization is enabled, layers will be automatically initialized."},{"$ref":"#/definitions/cellsLayer"}]}}},"spatialNeighborhoodsLayer":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided and auto layer initialization is enabled, layers will be automatically initialized."},{"$ref":"#/definitions/neighborhoodsLayer"}]}}},"spatialMoleculesLayer":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided and auto layer initialization is enabled, layers will be automatically initialized."},{"$ref":"#/definitions/moleculesLayer"}]}}},"heatmapZoomX":{"type":"object","patternProperties":{".":{"type":"number"}}},"heatmapZoomY":{"type":"object","patternProperties":{".":{"type":"number"}}},"heatmapTargetX":{"type":"object","patternProperties":{".":{"type":"number"}}},"heatmapTargetY":{"type":"object","patternProperties":{".":{"type":"number"}}},"cellFilter":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no cells will be filtered out initially."},{"type":"array","items":{"type":"string"}}]}}},"cellHighlight":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no cell will be highlighted initially."},{"type":"string"}]}}},"cellSetSelection":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided and auto cell set initialization is enabled, cell set selections will be automatically initialized."},{"type":"array"}]}}},"cellSetHighlight":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no cell sets will be highlighted initially."},{"type":"string"}]}}},"cellSetColor":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, cell set colors will be automatically initialized."},{"type":"array","items":{"type":"object","additionalProperties":false,"required":["path","color"],"properties":{"path":{"type":"array","items":{"type":"string"}},"color":{"type":"array","items":{"type":"number"}}}}}]}}},"cellColorEncoding":{"type":"object","patternProperties":{".":{"type":"string"}}},"geneFilter":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no genes will be filtered out initially."},{"type":"array","items":{"type":"string"}}]}}},"geneHighlight":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no genes will be highlighted initially."},{"type":"string"}]}}},"geneSelection":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null"},{"type":"array","items":{"type":"string"}}]}}},"geneExpressionTransform":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null"},{"type":"string","pattern":"log1p"}]}}},"geneExpressionColormap":{"type":"object","patternProperties":{".":{"type":"string"}}},"geneExpressionColormapRange":{"type":"object","patternProperties":{".":{"type":"array","items":{"type":"number"}}}},"genomicZoomX":{"type":"object","patternProperties":{".":{"type":"number"}}},"genomicZoomY":{"type":"object","patternProperties":{".":{"type":"number"}}},"genomicTargetX":{"type":"object","patternProperties":{".":{"type":"number"}}},"genomicTargetY":{"type":"object","patternProperties":{".":{"type":"number"}}},"additionalCellSets":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no cell will be highlighted initially."},{"$ref":"https://github.com/hubmapconsortium/vitessce/#cell-sets"}]}}},"moleculeHighlight":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no molecule will be highlighted initially."},{"type":"string"}]}}}}},"layout":{"$ref":"#/definitions/components"},"initStrategy":{"type":"string","enum":["none","auto"],"description":"The initialization strategy determines how missing coordination objects and coordination scope mappings are initially filled in."},"version":{"type":"string","enum":["1.0.1"],"description":"The schema version for the view config."}}}')},812:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://github.com/hubmapconsortium/vitessce/#dataset","title":"Vitessce data set","type":"object","definitions":{"components":{"description":"The layout array defines the views, or components, rendered in the grid.","type":"array","items":{"type":"object","additionalProperties":false,"required":["component","x","y"],"properties":{"component":{"type":"string","description":"Specify a component using a name defined in the component registry."},"props":{"type":"object","description":"Extra prop values for the component."},"x":{"type":"integer"},"y":{"type":"integer"},"w":{"type":"integer"},"h":{"type":"integer"},"coordinationScopes":{"type":"object","description":"Component-level coordination scope mappings define which coordination object values a particular component can read and write, for each coordination type.","additionalProperties":false,"required":[],"properties":{"dataset":{"type":"string"},"embeddingType":{"type":"string"},"embeddingZoom":{"type":"string"},"embeddingRotation":{"type":"string"},"embeddingTargetX":{"type":"string"},"embeddingTargetY":{"type":"string"},"embeddingTargetZ":{"type":"string"},"embeddingCellSetPolygonsVisible":{"type":"string"},"embeddingCellSetLabelsVisible":{"type":"string"},"embeddingCellSetLabelSize":{"type":"string"},"embeddingCellRadius":{"type":"string"},"spatialZoom":{"type":"string"},"spatialRotation":{"type":"string"},"spatialTargetX":{"type":"string"},"spatialTargetY":{"type":"string"},"spatialTargetZ":{"type":"string"},"spatialRotationX":{"type":"string"},"spatialRotationY":{"type":"string"},"spatialRotationZ":{"type":"string"},"spatialRotationOrbit":{"type":"string"},"spatialOrbitAxis":{"type":"string"},"spatialAxisFixed":{"type":"string"},"heatmapZoomX":{"type":"string"},"heatmapZoomY":{"type":"string"},"heatmapTargetX":{"type":"string"},"heatmapTargetY":{"type":"string"},"cellFilter":{"type":"string"},"cellHighlight":{"type":"string"},"cellSetSelection":{"type":"string"},"cellSetHighlight":{"type":"string"},"cellSetColor":{"type":"string"},"geneFilter":{"type":"string"},"geneHighlight":{"type":"string"},"geneSelection":{"type":"string"},"geneExpressionTransform":{"type":"string"},"geneExpressionColormap":{"type":"string"},"geneExpressionColormapRange":{"type":"string"},"cellColorEncoding":{"type":"string"},"spatialRasterLayers":{"type":"string"},"spatialCellsLayer":{"type":"string"},"spatialMoleculesLayer":{"type":"string"},"spatialNeighborhoodsLayer":{"type":"string"},"genomicZoomX":{"type":"string"},"genomicZoomY":{"type":"string"},"genomicTargetX":{"type":"string"},"genomicTargetY":{"type":"string"},"additionalCellSets":{"type":"string"},"moleculeHighlight":{"type":"string"}}}}}},"annDataCellSets":{"type":"array","description":"Array of cell set configuration, following closely the conventions of the tabular schema","items":{"type":"object","additionalProperties":false,"required":["groupName","setName"],"properties":{"groupName":{"type":"string","description":"The display name for the set, like \'Cell Type\' or \'Louvain.\'"},"setName":{"type":"string","description":"The location in the AnnData store for the set, like \'obs/louvain\' or \'obs/celltype.\'"}}}},"annDataCells":{"type":"object","description":"The properties of this object are the configuration for how to layout scatterplots and spatial information","minProperties":1,"additionalProperties":false,"required":[],"properties":{"xy":{"type":"string","description":"The location in the AnnData store of cell centroids, like \'obsm/X_centroids.\'"},"poly":{"type":"string","description":"The location in the AnnData store of cell polygon outlines, like \'obsm/X_polygons.\'"},"factors":{"type":"array","description":"List of locations in the AnnData store of cell sets, like \'obs/louvain\'","items":{"type":"string"}},"mappings":{"patternProperties":{".":{"type":"object","description":"An object containing key-values for mappings like { UMAP: { key: \'obsm/X_umap\', dims: [0, 1] } }.","additionalProperties":false,"required":["key"],"properties":{"key":{"type":"string","description":"Where to look in the AnnData store for this mapping, like \'obsm/X_umap.\'"},"dims":{"type":"array","description":"Which indices of the obsm object to take for a scatterplot, allowing for, for example, different PCs from obsm/X_pca","minItems":2,"maxItems":2,"items":{"type":"number"}}}}}}}},"annDataExpressionMatrix":{"type":"object","description":"The properties of this object are the configuration for how to fetch the cell x genes matrix","additionalProperties":false,"required":["matrix"],"properties":{"matrix":{"type":"string","description":"The location in the AnnData store of the cell x gene matrix, like \'obsm/hvg_subset.\' or \'X\'"},"geneFilter":{"type":"string","description":"The location in the AnnData store of a filter for the genes if using a subset of the data, like \'var.highly_variable.\' if the matrix comes from \'obsm/hvg_subset.\'"},"matrixGeneFilter":{"type":"string","description":"The location in the AnnData store of a filter for the matrix data (used in heatmap and histogram), like \'var.highly_variable.\'\'"}}},"requestInit":{"type":"object","description":"The properties of this object correspond to the parameters of the JavaScript fetch() function.","additionalProperties":false,"required":[],"properties":{"method":{"type":"string"},"headers":{"type":"object"},"body":{"type":"string"},"mode":{"type":"string"},"credentials":{"type":"string"},"cache":{"type":"string"},"redirect":{"type":"string"},"referrer":{"type":"string"},"integrity":{"type":"string"}}},"rasterLayer":{"description":"The properties of this object are the rendering settings for the raster layer.","additionalProperties":false,"required":["channels","colormap","index","opacity"],"properties":{"channels":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["selection"],"properties":{"color":{"type":"array","items":{"type":"number"},"description":"The color to use when rendering this channel under the null colormap."},"selection":{"type":"object","description":"Determines the channel selection, e.g. some Z and time slice."},"slider":{"type":"array","items":{"type":"number"},"description":"Determines the range for color mapping."},"visible":{"type":"boolean","description":"Determines whether this channel of the layer will be rendered in the spatial component."}}}},"colormap":{"oneOf":[{"type":"string","description":"The name of the colormap to use for this layer."},{"type":"null","description":"Use the solid color definitions."}]},"transparentColor":{"oneOf":[{"type":"array","minItems":3,"maxItems":3,"items":{"type":"number","description":"One of R G or B (0 - 255)."},"description":"Determines the color to be set to opacity 0"},{"type":"null","description":"No selection."}]},"index":{"type":"number","description":"The index of the layer among the array of layers available in the image file."},"opacity":{"type":"number"},"modelMatrix":{"oneOf":[{"type":"array","minItems":16,"maxItems":16,"description":"transformation matrix for this layer"},{"type":"null","description":"Use no transformation."}]},"domainType":{"type":"string","enum":["Full","Min/Max"],"description":"Determines the extent of the channel slider input element in the layer controller."},"resolution":{"type":"number","description":"Resolution of 3D volumetric rendering"},"xSlice":{"oneOf":[{"type":"array","minItems":2,"maxItems":2,"description":"Slice bounds"},{"type":"null","description":"No slicing"}]},"renderingMode":{"type":"string","description":"Rendering mode of 3D volumetric rendering"},"ySlice":{"oneOf":[{"type":"array","minItems":2,"maxItems":2,"description":"Slice bounds"},{"type":"null","description":"No slicing"}]},"zSlice":{"oneOf":[{"type":"array","minItems":2,"maxItems":2,"description":"Slice bounds"},{"type":"null","description":"No slicing"}]},"type":{"type":"string","enum":["raster","bitmask"]},"use3d":{"type":"boolean"},"visible":{"type":"boolean","description":"Determines whether this entire layer will be rendered in the spatial component."}}},"moleculesLayer":{"type":"object","description":"The properties of this object are the rendering settings for the molecules layer.","additionalProperties":false,"required":["visible","radius","opacity"],"properties":{"visible":{"type":"boolean"},"radius":{"type":"number"},"opacity":{"type":"number"}}},"cellsLayer":{"type":"object","description":"The properties of this object are the rendering settings for the cells layer.","additionalProperties":false,"required":["visible","stroked","radius","opacity"],"properties":{"visible":{"type":"boolean"},"stroked":{"type":"boolean"},"radius":{"type":"number"},"opacity":{"type":"number"}}},"neighborhoodsLayer":{"type":"object","description":"The properties of this object are the rendering settings for the neighborhoods layer.","additionalProperties":false,"required":["visible"],"properties":{"visible":{"type":"boolean"}}},"spatialRasterLayers":{"type":"array","description":"Array of Spatial Layers","items":{"$ref":"#/definitions/rasterLayer"}}},"additionalProperties":false,"required":["version","name","datasets","layout","initStrategy"],"properties":{"name":{"type":"string"},"public":{"type":"boolean"},"description":{"type":"string"},"datasets":{"type":"array","description":"The datasets array defines groups of files, where the files within each dataset reference the same entities (cells, genes, cell sets, etc).","items":{"type":"object","additionalProperties":false,"required":["uid","files"],"properties":{"uid":{"type":"string"},"name":{"type":"string"},"description":{"type":"string"},"files":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["type","fileType"],"properties":{"name":{"type":"string"},"type":{"type":"string"},"fileType":{"type":"string"},"url":{"type":"string"},"options":{"oneOf":[{"$ref":"#/definitions/annDataCellSets"},{"$ref":"https://github.com/hubmapconsortium/vitessce/#raster"},{"$ref":"#/definitions/annDataCells"},{"$ref":"#/definitions/annDataExpressionMatrix"}]},"requestInit":{"$ref":"#/definitions/requestInit"}}}}}}},"coordinationSpace":{"type":"object","description":"The coordination space stores the values for each scope of each coordination object.","additionalProperties":false,"required":[],"properties":{"dataset":{"type":"object","patternProperties":{".":{"type":"string"}}},"embeddingZoom":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"embeddingRotation":{"type":"object","patternProperties":{".":{"type":"number"}}},"embeddingTargetX":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"embeddingTargetY":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"embeddingTargetZ":{"type":"object","patternProperties":{".":{"type":"number"}}},"embeddingType":{"type":"object","patternProperties":{".":{"type":"string"}}},"embeddingCellSetPolygonsVisible":{"type":"object","patternProperties":{".":{"type":"boolean"}}},"embeddingCellSetLabelsVisible":{"type":"object","patternProperties":{".":{"type":"boolean"}}},"embeddingCellSetLabelSize":{"type":"object","patternProperties":{".":{"type":"number"}}},"embeddingCellRadius":{"type":"object","patternProperties":{".":{"type":"number"}}},"spatialZoom":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"spatialRotation":{"type":"object","patternProperties":{".":{"type":"number"}}},"spatialTargetX":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"spatialTargetY":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"spatialTargetZ":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set."},{"type":"number"}]}}},"spatialRotationX":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set. Only useful for 3D viewing."},{"type":"number"}]}}},"spatialRotationY":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set. Only useful for 3D viewing."},{"type":"number"}]}}},"spatialRotationZ":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set. Only useful for 3D viewing."},{"type":"number"}]}}},"spatialRotationOrbit":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set. Only useful for 3D viewing."},{"type":"number"}]}}},"spatialOrbitAxis":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, value will be automatically set. Only useful for 3D viewing."},{"type":"string"}]}}},"spatialAxisFixed":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"Whether or not to have a fixed axis for the camera. Only useful for 3D viewing."},{"type":"boolean"}]}}},"spatialRasterLayers":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided and auto layer initialization is enabled, layers will be automatically initialized."},{"$ref":"#/definitions/spatialRasterLayers"}]}}},"spatialCellsLayer":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided and auto layer initialization is enabled, layers will be automatically initialized."},{"$ref":"#/definitions/cellsLayer"}]}}},"spatialNeighborhoodsLayer":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided and auto layer initialization is enabled, layers will be automatically initialized."},{"$ref":"#/definitions/neighborhoodsLayer"}]}}},"spatialMoleculesLayer":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided and auto layer initialization is enabled, layers will be automatically initialized."},{"$ref":"#/definitions/moleculesLayer"}]}}},"heatmapZoomX":{"type":"object","patternProperties":{".":{"type":"number"}}},"heatmapZoomY":{"type":"object","patternProperties":{".":{"type":"number"}}},"heatmapTargetX":{"type":"object","patternProperties":{".":{"type":"number"}}},"heatmapTargetY":{"type":"object","patternProperties":{".":{"type":"number"}}},"cellFilter":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no cells will be filtered out initially."},{"type":"array","items":{"type":"string"}}]}}},"cellHighlight":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no cell will be highlighted initially."},{"type":"string"}]}}},"cellSetSelection":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided and auto cell set initialization is enabled, cell set selections will be automatically initialized."},{"type":"array"}]}}},"cellSetHighlight":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no cell sets will be highlighted initially."},{"type":"string"}]}}},"cellSetColor":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, cell set colors will be automatically initialized."},{"type":"array","items":{"type":"object","additionalProperties":false,"required":["path","color"],"properties":{"path":{"type":"array","items":{"type":"string"}},"color":{"type":"array","items":{"type":"number"}}}}}]}}},"cellColorEncoding":{"type":"object","patternProperties":{".":{"type":"string"}}},"geneFilter":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no genes will be filtered out initially."},{"type":"array","items":{"type":"string"}}]}}},"geneHighlight":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no genes will be highlighted initially."},{"type":"string"}]}}},"geneSelection":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null"},{"type":"array","items":{"type":"string"}}]}}},"geneExpressionTransform":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null"},{"type":"string","pattern":"log1p"}]}}},"geneExpressionColormap":{"type":"object","patternProperties":{".":{"type":"string"}}},"geneExpressionColormapRange":{"type":"object","patternProperties":{".":{"type":"array","items":{"type":"number"}}}},"genomicZoomX":{"type":"object","patternProperties":{".":{"type":"number"}}},"genomicZoomY":{"type":"object","patternProperties":{".":{"type":"number"}}},"genomicTargetX":{"type":"object","patternProperties":{".":{"type":"number"}}},"genomicTargetY":{"type":"object","patternProperties":{".":{"type":"number"}}},"additionalCellSets":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no cell will be highlighted initially."},{"$ref":"https://github.com/hubmapconsortium/vitessce/#cell-sets"}]}}},"moleculeHighlight":{"type":"object","patternProperties":{".":{"oneOf":[{"type":"null","description":"If null is provided, no molecule will be highlighted initially."},{"type":"string"}]}}}}},"layout":{"$ref":"#/definitions/components"},"initStrategy":{"type":"string","enum":["none","auto"],"description":"The initialization strategy determines how missing coordination objects and coordination scope mappings are initially filled in."},"version":{"type":"string","enum":["1.0.2"],"description":"The schema version for the view config."}}}')},833:function(e,t,n){e.exports=function(){return n(1282)('!function(t){var n={};function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="./",e(e.s=23)}([function(t,n){t.exports=function(t){var n=typeof t;return null!=t&&("object"==n||"function"==n)}},function(t,n,e){var r=e(6),o=e(3);t.exports=function(t,n,e){return void 0===e&&(e=n,n=void 0),void 0!==e&&(e=(e=o(e))===e?e:0),void 0!==n&&(n=(n=o(n))===n?n:0),r(o(t),n,e)}},function(t,n,e){var r=e(14)();t.exports=r},function(t,n,e){var r=e(0),o=e(7),i=/^\\s+|\\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,f=/^0o[0-7]+$/i,l=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(o(t))return NaN;if(r(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=r(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var e=c.test(t);return e||f.test(t)?l(t.slice(2),e?2:8):u.test(t)?NaN:+t}},function(t,n,e){var r=e(5),o=e(11),i=e(12),u=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":u&&u in Object(t)?o(t):i(t)}},function(t,n,e){var r=e(8).Symbol;t.exports=r},function(t,n){t.exports=function(t,n,e){return t===t&&(void 0!==e&&(t=t<=e?t:e),void 0!==n&&(t=t>=n?t:n)),t}},function(t,n,e){var r=e(4),o=e(13);t.exports=function(t){return"symbol"==typeof t||o(t)&&"[object Symbol]"==r(t)}},function(t,n,e){var r=e(9),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();t.exports=i},function(t,n,e){(function(n){var e="object"==typeof n&&n&&n.Object===Object&&n;t.exports=e}).call(this,e(10))},function(t,n){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch(r){"object"===typeof window&&(e=window)}t.exports=e},function(t,n,e){var r=e(5),o=Object.prototype,i=o.hasOwnProperty,u=o.toString,c=r?r.toStringTag:void 0;t.exports=function(t){var n=i.call(t,c),e=t[c];try{t[c]=void 0;var r=!0}catch(f){}var o=u.call(t);return r&&(n?t[c]=e:delete t[c]),o}},function(t,n){var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},function(t,n){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,n,e){var r=e(15),o=e(16),i=e(22);t.exports=function(t){return function(n,e,u){return u&&"number"!=typeof u&&o(n,e,u)&&(e=u=void 0),n=i(n),void 0===e?(e=n,n=0):e=i(e),u=void 0===u?n<e?1:-1:i(u),r(n,e,u,t)}}},function(t,n){var e=Math.ceil,r=Math.max;t.exports=function(t,n,o,i){for(var u=-1,c=r(e((n-t)/(o||1)),0),f=Array(c);c--;)f[i?c:++u]=t,t+=o;return f}},function(t,n,e){var r=e(17),o=e(18),i=e(21),u=e(0);t.exports=function(t,n,e){if(!u(e))return!1;var c=typeof n;return!!("number"==c?o(e)&&i(n,e.length):"string"==c&&n in e)&&r(e[n],t)}},function(t,n){t.exports=function(t,n){return t===n||t!==t&&n!==n}},function(t,n,e){var r=e(19),o=e(20);t.exports=function(t){return null!=t&&o(t.length)&&!r(t)}},function(t,n,e){var r=e(4),o=e(0);t.exports=function(t){if(!o(t))return!1;var n=r(t);return"[object Function]"==n||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n}},function(t,n){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},function(t,n){var e=/^(?:0|[1-9]\\d*)$/;t.exports=function(t,n){var r=typeof t;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&e.test(t))&&t>-1&&t%1==0&&t<n}},function(t,n,e){var r=e(3);t.exports=function(t){return t?(t=r(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t===t?t:0:0===t?t:0}},function(t,n,e){"use strict";e.r(n);e(1);var r=e(2),o=e.n(r);function i(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var u,c=9728,f=10240,l=10241,a=10242,s=10243,p=33071;i(u={},l,c),i(u,f,c),i(u,a,p),i(u,s,p);function v(t,n){var e,r,i,u=n.tileSize,c=n.tileI,f=n.tileJ,l=n.numCells,a=n.numGenes,s=n.cellOrdering,p=n.cells,v=new Uint8Array(u*u),d=o()(u);return d.forEach((function(n){(r=f*u+n)<l&&(i=p.indexOf(s[r]))>=-1&&d.forEach((function(r){e=t[i*a+(c*u+r)],v[(u-r-1)*u+n]=e}))})),v}function d(t,n){var e,r,i,u,c=n.tileSize,f=n.tileI,l=n.tileJ,a=n.numCells,s=n.numGenes,p=n.cellOrdering,v=n.cells,d=new Uint8Array(c*c),b=o()(c);return b.forEach((function(n){(r=f*c+n)<a&&(u=v.indexOf(p[r]))>=-1&&b.forEach((function(r){e=(i=l*c+r)<s?t[u*s+i]:0,d[(c-n-1)*c+r]=e}))})),d}if("undefined"!==typeof self){const t={getTile:function({curr:t,tileI:n,tileJ:e,tileSize:r,cellOrdering:o,rows:i,cols:u,data:c,transpose:f}){const l=new Uint8Array(c),a=u.length;return[{tile:(f?v:d)(l,{tileSize:r,tileI:n,tileJ:e,numCells:o.length,numGenes:a,cellOrdering:o,cells:i}),buffer:c,curr:t},[c]]}};self.addEventListener("message",n=>{try{const[e,r]=n.data,[o,i]=t[e](r);self.postMessage(o,i)}catch(e){console.warn(e)}})}}]);\n//# sourceMappingURL=6f6f723a7874f4178a42.worker.js.map',null)}},882:function(e,t,n){e.exports=n(1314)},987:function(e,t){},990:function(e,t){},992:function(e,t){}},[[882,1,2]]]);
//# sourceMappingURL=main.af2e9d5f.chunk.js.map